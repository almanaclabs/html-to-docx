{"version":3,"file":"html-to-docx.esm.js","sources":["../node_modules/virtual-dom/vnode/version.js","../node_modules/virtual-dom/vnode/is-vnode.js","../node_modules/virtual-dom/vnode/is-widget.js","../node_modules/virtual-dom/vnode/is-thunk.js","../node_modules/virtual-dom/vnode/is-vhook.js","../node_modules/virtual-dom/vnode/vnode.js","../node_modules/virtual-dom/vnode/vtext.js","../node_modules/virtual-dom/vnode/is-vtext.js","../node_modules/rollup-plugin-node-builtins/src/es6/empty.js","../node_modules/rollup-plugin-node-builtins/src/es6/path.js","../node_modules/inherits/inherits_browser.js","../node_modules/rollup-plugin-node-builtins/src/es6/events.js","../node_modules/queue/index.js","../node_modules/image-size/dist/types/bmp.js","../node_modules/image-size/dist/types/ico.js","../node_modules/image-size/dist/types/cur.js","../node_modules/image-size/dist/types/dds.js","../node_modules/image-size/dist/types/gif.js","../node_modules/image-size/dist/types/icns.js","../node_modules/image-size/dist/types/j2c.js","../node_modules/image-size/dist/types/jp2.js","../node_modules/image-size/dist/readUInt.js","../node_modules/image-size/dist/types/jpg.js","../node_modules/image-size/dist/types/ktx.js","../node_modules/image-size/dist/types/png.js","../node_modules/image-size/dist/types/pnm.js","../node_modules/image-size/dist/types/psd.js","../node_modules/image-size/dist/types/svg.js","../node_modules/image-size/dist/types/tiff.js","../node_modules/image-size/dist/types/webp.js","../node_modules/image-size/dist/types.js","../node_modules/image-size/dist/detector.js","../node_modules/image-size/dist/fs.promises.js","../node_modules/image-size/dist/index.js","../src/helpers/namespaces.js","../src/utils/color-conversion.js","../src/utils/unit-conversion.js","../src/helpers/xml-builder.js","../src/helpers/render-document-file.js","../src/schemas/core.js","../src/schemas/document-rels.js","../src/schemas/rels.js","../src/schemas/font-table.js","../src/schemas/settings.js","../src/schemas/web-settings.js","../node_modules/shortid/lib/random/random-from-seed.js","../node_modules/shortid/lib/alphabet.js","../node_modules/shortid/lib/random/random-byte-browser.js","../node_modules/nanoid/format.browser.js","../node_modules/shortid/lib/generate.js","../node_modules/shortid/lib/build.js","../node_modules/shortid/lib/is-valid.js","../node_modules/shortid/lib/index.js","../node_modules/shortid/index.js","../template/document.template.js","../src/docx-document.js","../src/schemas/content-types.js","../src/schemas/styles.js","../src/schemas/theme.js","../src/schemas/numbering.js","../src/schemas/generic-rels.js","../src/html-to-docx.js","../index.js"],"sourcesContent":["module.exports = \"2\"\n","var version = require(\"./version\")\n\nmodule.exports = isVirtualNode\n\nfunction isVirtualNode(x) {\n    return x && x.type === \"VirtualNode\" && x.version === version\n}\n","module.exports = isWidget\n\nfunction isWidget(w) {\n    return w && w.type === \"Widget\"\n}\n","module.exports = isThunk\r\n\r\nfunction isThunk(t) {\r\n    return t && t.type === \"Thunk\"\r\n}\r\n","module.exports = isHook\n\nfunction isHook(hook) {\n    return hook &&\n      (typeof hook.hook === \"function\" && !hook.hasOwnProperty(\"hook\") ||\n       typeof hook.unhook === \"function\" && !hook.hasOwnProperty(\"unhook\"))\n}\n","var version = require(\"./version\")\nvar isVNode = require(\"./is-vnode\")\nvar isWidget = require(\"./is-widget\")\nvar isThunk = require(\"./is-thunk\")\nvar isVHook = require(\"./is-vhook\")\n\nmodule.exports = VirtualNode\n\nvar noProperties = {}\nvar noChildren = []\n\nfunction VirtualNode(tagName, properties, children, key, namespace) {\n    this.tagName = tagName\n    this.properties = properties || noProperties\n    this.children = children || noChildren\n    this.key = key != null ? String(key) : undefined\n    this.namespace = (typeof namespace === \"string\") ? namespace : null\n\n    var count = (children && children.length) || 0\n    var descendants = 0\n    var hasWidgets = false\n    var hasThunks = false\n    var descendantHooks = false\n    var hooks\n\n    for (var propName in properties) {\n        if (properties.hasOwnProperty(propName)) {\n            var property = properties[propName]\n            if (isVHook(property) && property.unhook) {\n                if (!hooks) {\n                    hooks = {}\n                }\n\n                hooks[propName] = property\n            }\n        }\n    }\n\n    for (var i = 0; i < count; i++) {\n        var child = children[i]\n        if (isVNode(child)) {\n            descendants += child.count || 0\n\n            if (!hasWidgets && child.hasWidgets) {\n                hasWidgets = true\n            }\n\n            if (!hasThunks && child.hasThunks) {\n                hasThunks = true\n            }\n\n            if (!descendantHooks && (child.hooks || child.descendantHooks)) {\n                descendantHooks = true\n            }\n        } else if (!hasWidgets && isWidget(child)) {\n            if (typeof child.destroy === \"function\") {\n                hasWidgets = true\n            }\n        } else if (!hasThunks && isThunk(child)) {\n            hasThunks = true;\n        }\n    }\n\n    this.count = count + descendants\n    this.hasWidgets = hasWidgets\n    this.hasThunks = hasThunks\n    this.hooks = hooks\n    this.descendantHooks = descendantHooks\n}\n\nVirtualNode.prototype.version = version\nVirtualNode.prototype.type = \"VirtualNode\"\n","var version = require(\"./version\")\n\nmodule.exports = VirtualText\n\nfunction VirtualText(text) {\n    this.text = String(text)\n}\n\nVirtualText.prototype.version = version\nVirtualText.prototype.type = \"VirtualText\"\n","var version = require(\"./version\")\n\nmodule.exports = isVirtualText\n\nfunction isVirtualText(x) {\n    return x && x.type === \"VirtualText\" && x.version === version\n}\n","export default {};\n","// Copyright Joyent, Inc. and other Node contributors.\n//\n// Permission is hereby granted, free of charge, to any person obtaining a\n// copy of this software and associated documentation files (the\n// \"Software\"), to deal in the Software without restriction, including\n// without limitation the rights to use, copy, modify, merge, publish,\n// distribute, sublicense, and/or sell copies of the Software, and to permit\n// persons to whom the Software is furnished to do so, subject to the\n// following conditions:\n//\n// The above copyright notice and this permission notice shall be included\n// in all copies or substantial portions of the Software.\n//\n// THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS\n// OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF\n// MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN\n// NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM,\n// DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR\n// OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE\n// USE OR OTHER DEALINGS IN THE SOFTWARE.\n\n// resolves . and .. elements in a path array with directory names there\n// must be no slashes, empty elements, or device names (c:\\) in the array\n// (so also no leading and trailing slashes - it does not distinguish\n// relative and absolute paths)\nfunction normalizeArray(parts, allowAboveRoot) {\n  // if the path tries to go above the root, `up` ends up > 0\n  var up = 0;\n  for (var i = parts.length - 1; i >= 0; i--) {\n    var last = parts[i];\n    if (last === '.') {\n      parts.splice(i, 1);\n    } else if (last === '..') {\n      parts.splice(i, 1);\n      up++;\n    } else if (up) {\n      parts.splice(i, 1);\n      up--;\n    }\n  }\n\n  // if the path is allowed to go above the root, restore leading ..s\n  if (allowAboveRoot) {\n    for (; up--; up) {\n      parts.unshift('..');\n    }\n  }\n\n  return parts;\n}\n\n// Split a filename into [root, dir, basename, ext], unix version\n// 'root' is just a slash, or nothing.\nvar splitPathRe =\n    /^(\\/?|)([\\s\\S]*?)((?:\\.{1,2}|[^\\/]+?|)(\\.[^.\\/]*|))(?:[\\/]*)$/;\nvar splitPath = function(filename) {\n  return splitPathRe.exec(filename).slice(1);\n};\n\n// path.resolve([from ...], to)\n// posix version\nexport function resolve() {\n  var resolvedPath = '',\n      resolvedAbsolute = false;\n\n  for (var i = arguments.length - 1; i >= -1 && !resolvedAbsolute; i--) {\n    var path = (i >= 0) ? arguments[i] : '/';\n\n    // Skip empty and invalid entries\n    if (typeof path !== 'string') {\n      throw new TypeError('Arguments to path.resolve must be strings');\n    } else if (!path) {\n      continue;\n    }\n\n    resolvedPath = path + '/' + resolvedPath;\n    resolvedAbsolute = path.charAt(0) === '/';\n  }\n\n  // At this point the path should be resolved to a full absolute path, but\n  // handle relative paths to be safe (might happen when process.cwd() fails)\n\n  // Normalize the path\n  resolvedPath = normalizeArray(filter(resolvedPath.split('/'), function(p) {\n    return !!p;\n  }), !resolvedAbsolute).join('/');\n\n  return ((resolvedAbsolute ? '/' : '') + resolvedPath) || '.';\n};\n\n// path.normalize(path)\n// posix version\nexport function normalize(path) {\n  var isPathAbsolute = isAbsolute(path),\n      trailingSlash = substr(path, -1) === '/';\n\n  // Normalize the path\n  path = normalizeArray(filter(path.split('/'), function(p) {\n    return !!p;\n  }), !isPathAbsolute).join('/');\n\n  if (!path && !isPathAbsolute) {\n    path = '.';\n  }\n  if (path && trailingSlash) {\n    path += '/';\n  }\n\n  return (isPathAbsolute ? '/' : '') + path;\n};\n\n// posix version\nexport function isAbsolute(path) {\n  return path.charAt(0) === '/';\n}\n\n// posix version\nexport function join() {\n  var paths = Array.prototype.slice.call(arguments, 0);\n  return normalize(filter(paths, function(p, index) {\n    if (typeof p !== 'string') {\n      throw new TypeError('Arguments to path.join must be strings');\n    }\n    return p;\n  }).join('/'));\n}\n\n\n// path.relative(from, to)\n// posix version\nexport function relative(from, to) {\n  from = resolve(from).substr(1);\n  to = resolve(to).substr(1);\n\n  function trim(arr) {\n    var start = 0;\n    for (; start < arr.length; start++) {\n      if (arr[start] !== '') break;\n    }\n\n    var end = arr.length - 1;\n    for (; end >= 0; end--) {\n      if (arr[end] !== '') break;\n    }\n\n    if (start > end) return [];\n    return arr.slice(start, end - start + 1);\n  }\n\n  var fromParts = trim(from.split('/'));\n  var toParts = trim(to.split('/'));\n\n  var length = Math.min(fromParts.length, toParts.length);\n  var samePartsLength = length;\n  for (var i = 0; i < length; i++) {\n    if (fromParts[i] !== toParts[i]) {\n      samePartsLength = i;\n      break;\n    }\n  }\n\n  var outputParts = [];\n  for (var i = samePartsLength; i < fromParts.length; i++) {\n    outputParts.push('..');\n  }\n\n  outputParts = outputParts.concat(toParts.slice(samePartsLength));\n\n  return outputParts.join('/');\n}\n\nexport var sep = '/';\nexport var delimiter = ':';\n\nexport function dirname(path) {\n  var result = splitPath(path),\n      root = result[0],\n      dir = result[1];\n\n  if (!root && !dir) {\n    // No dirname whatsoever\n    return '.';\n  }\n\n  if (dir) {\n    // It has a dirname, strip trailing slash\n    dir = dir.substr(0, dir.length - 1);\n  }\n\n  return root + dir;\n}\n\nexport function basename(path, ext) {\n  var f = splitPath(path)[2];\n  // TODO: make this comparison case-insensitive on windows?\n  if (ext && f.substr(-1 * ext.length) === ext) {\n    f = f.substr(0, f.length - ext.length);\n  }\n  return f;\n}\n\n\nexport function extname(path) {\n  return splitPath(path)[3];\n}\nexport default {\n  extname: extname,\n  basename: basename,\n  dirname: dirname,\n  sep: sep,\n  delimiter: delimiter,\n  relative: relative,\n  join: join,\n  isAbsolute: isAbsolute,\n  normalize: normalize,\n  resolve: resolve\n};\nfunction filter (xs, f) {\n    if (xs.filter) return xs.filter(f);\n    var res = [];\n    for (var i = 0; i < xs.length; i++) {\n        if (f(xs[i], i, xs)) res.push(xs[i]);\n    }\n    return res;\n}\n\n// String.prototype.substr - negative index don't work in IE8\nvar substr = 'ab'.substr(-1) === 'b' ?\n    function (str, start, len) { return str.substr(start, len) } :\n    function (str, start, len) {\n        if (start < 0) start = str.length + start;\n        return str.substr(start, len);\n    }\n;\n","if (typeof Object.create === 'function') {\n  // implementation from standard node.js 'util' module\n  module.exports = function inherits(ctor, superCtor) {\n    if (superCtor) {\n      ctor.super_ = superCtor\n      ctor.prototype = Object.create(superCtor.prototype, {\n        constructor: {\n          value: ctor,\n          enumerable: false,\n          writable: true,\n          configurable: true\n        }\n      })\n    }\n  };\n} else {\n  // old school shim for old browsers\n  module.exports = function inherits(ctor, superCtor) {\n    if (superCtor) {\n      ctor.super_ = superCtor\n      var TempCtor = function () {}\n      TempCtor.prototype = superCtor.prototype\n      ctor.prototype = new TempCtor()\n      ctor.prototype.constructor = ctor\n    }\n  }\n}\n","'use strict';\n\nvar domain;\n\n// This constructor is used to store event handlers. Instantiating this is\n// faster than explicitly calling `Object.create(null)` to get a \"clean\" empty\n// object (tested with v8 v4.9).\nfunction EventHandlers() {}\nEventHandlers.prototype = Object.create(null);\n\nfunction EventEmitter() {\n  EventEmitter.init.call(this);\n}\nexport default EventEmitter;\nexport {EventEmitter};\n\n// nodejs oddity\n// require('events') === require('events').EventEmitter\nEventEmitter.EventEmitter = EventEmitter\n\nEventEmitter.usingDomains = false;\n\nEventEmitter.prototype.domain = undefined;\nEventEmitter.prototype._events = undefined;\nEventEmitter.prototype._maxListeners = undefined;\n\n// By default EventEmitters will print a warning if more than 10 listeners are\n// added to it. This is a useful default which helps finding memory leaks.\nEventEmitter.defaultMaxListeners = 10;\n\nEventEmitter.init = function() {\n  this.domain = null;\n  if (EventEmitter.usingDomains) {\n    // if there is an active domain, then attach to it.\n    if (domain.active && !(this instanceof domain.Domain)) {\n      this.domain = domain.active;\n    }\n  }\n\n  if (!this._events || this._events === Object.getPrototypeOf(this)._events) {\n    this._events = new EventHandlers();\n    this._eventsCount = 0;\n  }\n\n  this._maxListeners = this._maxListeners || undefined;\n};\n\n// Obviously not all Emitters should be limited to 10. This function allows\n// that to be increased. Set to zero for unlimited.\nEventEmitter.prototype.setMaxListeners = function setMaxListeners(n) {\n  if (typeof n !== 'number' || n < 0 || isNaN(n))\n    throw new TypeError('\"n\" argument must be a positive number');\n  this._maxListeners = n;\n  return this;\n};\n\nfunction $getMaxListeners(that) {\n  if (that._maxListeners === undefined)\n    return EventEmitter.defaultMaxListeners;\n  return that._maxListeners;\n}\n\nEventEmitter.prototype.getMaxListeners = function getMaxListeners() {\n  return $getMaxListeners(this);\n};\n\n// These standalone emit* functions are used to optimize calling of event\n// handlers for fast cases because emit() itself often has a variable number of\n// arguments and can be deoptimized because of that. These functions always have\n// the same number of arguments and thus do not get deoptimized, so the code\n// inside them can execute faster.\nfunction emitNone(handler, isFn, self) {\n  if (isFn)\n    handler.call(self);\n  else {\n    var len = handler.length;\n    var listeners = arrayClone(handler, len);\n    for (var i = 0; i < len; ++i)\n      listeners[i].call(self);\n  }\n}\nfunction emitOne(handler, isFn, self, arg1) {\n  if (isFn)\n    handler.call(self, arg1);\n  else {\n    var len = handler.length;\n    var listeners = arrayClone(handler, len);\n    for (var i = 0; i < len; ++i)\n      listeners[i].call(self, arg1);\n  }\n}\nfunction emitTwo(handler, isFn, self, arg1, arg2) {\n  if (isFn)\n    handler.call(self, arg1, arg2);\n  else {\n    var len = handler.length;\n    var listeners = arrayClone(handler, len);\n    for (var i = 0; i < len; ++i)\n      listeners[i].call(self, arg1, arg2);\n  }\n}\nfunction emitThree(handler, isFn, self, arg1, arg2, arg3) {\n  if (isFn)\n    handler.call(self, arg1, arg2, arg3);\n  else {\n    var len = handler.length;\n    var listeners = arrayClone(handler, len);\n    for (var i = 0; i < len; ++i)\n      listeners[i].call(self, arg1, arg2, arg3);\n  }\n}\n\nfunction emitMany(handler, isFn, self, args) {\n  if (isFn)\n    handler.apply(self, args);\n  else {\n    var len = handler.length;\n    var listeners = arrayClone(handler, len);\n    for (var i = 0; i < len; ++i)\n      listeners[i].apply(self, args);\n  }\n}\n\nEventEmitter.prototype.emit = function emit(type) {\n  var er, handler, len, args, i, events, domain;\n  var needDomainExit = false;\n  var doError = (type === 'error');\n\n  events = this._events;\n  if (events)\n    doError = (doError && events.error == null);\n  else if (!doError)\n    return false;\n\n  domain = this.domain;\n\n  // If there is no 'error' event listener then throw.\n  if (doError) {\n    er = arguments[1];\n    if (domain) {\n      if (!er)\n        er = new Error('Uncaught, unspecified \"error\" event');\n      er.domainEmitter = this;\n      er.domain = domain;\n      er.domainThrown = false;\n      domain.emit('error', er);\n    } else if (er instanceof Error) {\n      throw er; // Unhandled 'error' event\n    } else {\n      // At least give some kind of context to the user\n      var err = new Error('Uncaught, unspecified \"error\" event. (' + er + ')');\n      err.context = er;\n      throw err;\n    }\n    return false;\n  }\n\n  handler = events[type];\n\n  if (!handler)\n    return false;\n\n  var isFn = typeof handler === 'function';\n  len = arguments.length;\n  switch (len) {\n    // fast cases\n    case 1:\n      emitNone(handler, isFn, this);\n      break;\n    case 2:\n      emitOne(handler, isFn, this, arguments[1]);\n      break;\n    case 3:\n      emitTwo(handler, isFn, this, arguments[1], arguments[2]);\n      break;\n    case 4:\n      emitThree(handler, isFn, this, arguments[1], arguments[2], arguments[3]);\n      break;\n    // slower\n    default:\n      args = new Array(len - 1);\n      for (i = 1; i < len; i++)\n        args[i - 1] = arguments[i];\n      emitMany(handler, isFn, this, args);\n  }\n\n  if (needDomainExit)\n    domain.exit();\n\n  return true;\n};\n\nfunction _addListener(target, type, listener, prepend) {\n  var m;\n  var events;\n  var existing;\n\n  if (typeof listener !== 'function')\n    throw new TypeError('\"listener\" argument must be a function');\n\n  events = target._events;\n  if (!events) {\n    events = target._events = new EventHandlers();\n    target._eventsCount = 0;\n  } else {\n    // To avoid recursion in the case that type === \"newListener\"! Before\n    // adding it to the listeners, first emit \"newListener\".\n    if (events.newListener) {\n      target.emit('newListener', type,\n                  listener.listener ? listener.listener : listener);\n\n      // Re-assign `events` because a newListener handler could have caused the\n      // this._events to be assigned to a new object\n      events = target._events;\n    }\n    existing = events[type];\n  }\n\n  if (!existing) {\n    // Optimize the case of one listener. Don't need the extra array object.\n    existing = events[type] = listener;\n    ++target._eventsCount;\n  } else {\n    if (typeof existing === 'function') {\n      // Adding the second element, need to change to array.\n      existing = events[type] = prepend ? [listener, existing] :\n                                          [existing, listener];\n    } else {\n      // If we've already got an array, just append.\n      if (prepend) {\n        existing.unshift(listener);\n      } else {\n        existing.push(listener);\n      }\n    }\n\n    // Check for listener leak\n    if (!existing.warned) {\n      m = $getMaxListeners(target);\n      if (m && m > 0 && existing.length > m) {\n        existing.warned = true;\n        var w = new Error('Possible EventEmitter memory leak detected. ' +\n                            existing.length + ' ' + type + ' listeners added. ' +\n                            'Use emitter.setMaxListeners() to increase limit');\n        w.name = 'MaxListenersExceededWarning';\n        w.emitter = target;\n        w.type = type;\n        w.count = existing.length;\n        emitWarning(w);\n      }\n    }\n  }\n\n  return target;\n}\nfunction emitWarning(e) {\n  typeof console.warn === 'function' ? console.warn(e) : console.log(e);\n}\nEventEmitter.prototype.addListener = function addListener(type, listener) {\n  return _addListener(this, type, listener, false);\n};\n\nEventEmitter.prototype.on = EventEmitter.prototype.addListener;\n\nEventEmitter.prototype.prependListener =\n    function prependListener(type, listener) {\n      return _addListener(this, type, listener, true);\n    };\n\nfunction _onceWrap(target, type, listener) {\n  var fired = false;\n  function g() {\n    target.removeListener(type, g);\n    if (!fired) {\n      fired = true;\n      listener.apply(target, arguments);\n    }\n  }\n  g.listener = listener;\n  return g;\n}\n\nEventEmitter.prototype.once = function once(type, listener) {\n  if (typeof listener !== 'function')\n    throw new TypeError('\"listener\" argument must be a function');\n  this.on(type, _onceWrap(this, type, listener));\n  return this;\n};\n\nEventEmitter.prototype.prependOnceListener =\n    function prependOnceListener(type, listener) {\n      if (typeof listener !== 'function')\n        throw new TypeError('\"listener\" argument must be a function');\n      this.prependListener(type, _onceWrap(this, type, listener));\n      return this;\n    };\n\n// emits a 'removeListener' event iff the listener was removed\nEventEmitter.prototype.removeListener =\n    function removeListener(type, listener) {\n      var list, events, position, i, originalListener;\n\n      if (typeof listener !== 'function')\n        throw new TypeError('\"listener\" argument must be a function');\n\n      events = this._events;\n      if (!events)\n        return this;\n\n      list = events[type];\n      if (!list)\n        return this;\n\n      if (list === listener || (list.listener && list.listener === listener)) {\n        if (--this._eventsCount === 0)\n          this._events = new EventHandlers();\n        else {\n          delete events[type];\n          if (events.removeListener)\n            this.emit('removeListener', type, list.listener || listener);\n        }\n      } else if (typeof list !== 'function') {\n        position = -1;\n\n        for (i = list.length; i-- > 0;) {\n          if (list[i] === listener ||\n              (list[i].listener && list[i].listener === listener)) {\n            originalListener = list[i].listener;\n            position = i;\n            break;\n          }\n        }\n\n        if (position < 0)\n          return this;\n\n        if (list.length === 1) {\n          list[0] = undefined;\n          if (--this._eventsCount === 0) {\n            this._events = new EventHandlers();\n            return this;\n          } else {\n            delete events[type];\n          }\n        } else {\n          spliceOne(list, position);\n        }\n\n        if (events.removeListener)\n          this.emit('removeListener', type, originalListener || listener);\n      }\n\n      return this;\n    };\n\nEventEmitter.prototype.removeAllListeners =\n    function removeAllListeners(type) {\n      var listeners, events;\n\n      events = this._events;\n      if (!events)\n        return this;\n\n      // not listening for removeListener, no need to emit\n      if (!events.removeListener) {\n        if (arguments.length === 0) {\n          this._events = new EventHandlers();\n          this._eventsCount = 0;\n        } else if (events[type]) {\n          if (--this._eventsCount === 0)\n            this._events = new EventHandlers();\n          else\n            delete events[type];\n        }\n        return this;\n      }\n\n      // emit removeListener for all listeners on all events\n      if (arguments.length === 0) {\n        var keys = Object.keys(events);\n        for (var i = 0, key; i < keys.length; ++i) {\n          key = keys[i];\n          if (key === 'removeListener') continue;\n          this.removeAllListeners(key);\n        }\n        this.removeAllListeners('removeListener');\n        this._events = new EventHandlers();\n        this._eventsCount = 0;\n        return this;\n      }\n\n      listeners = events[type];\n\n      if (typeof listeners === 'function') {\n        this.removeListener(type, listeners);\n      } else if (listeners) {\n        // LIFO order\n        do {\n          this.removeListener(type, listeners[listeners.length - 1]);\n        } while (listeners[0]);\n      }\n\n      return this;\n    };\n\nEventEmitter.prototype.listeners = function listeners(type) {\n  var evlistener;\n  var ret;\n  var events = this._events;\n\n  if (!events)\n    ret = [];\n  else {\n    evlistener = events[type];\n    if (!evlistener)\n      ret = [];\n    else if (typeof evlistener === 'function')\n      ret = [evlistener.listener || evlistener];\n    else\n      ret = unwrapListeners(evlistener);\n  }\n\n  return ret;\n};\n\nEventEmitter.listenerCount = function(emitter, type) {\n  if (typeof emitter.listenerCount === 'function') {\n    return emitter.listenerCount(type);\n  } else {\n    return listenerCount.call(emitter, type);\n  }\n};\n\nEventEmitter.prototype.listenerCount = listenerCount;\nfunction listenerCount(type) {\n  var events = this._events;\n\n  if (events) {\n    var evlistener = events[type];\n\n    if (typeof evlistener === 'function') {\n      return 1;\n    } else if (evlistener) {\n      return evlistener.length;\n    }\n  }\n\n  return 0;\n}\n\nEventEmitter.prototype.eventNames = function eventNames() {\n  return this._eventsCount > 0 ? Reflect.ownKeys(this._events) : [];\n};\n\n// About 1.5x faster than the two-arg version of Array#splice().\nfunction spliceOne(list, index) {\n  for (var i = index, k = i + 1, n = list.length; k < n; i += 1, k += 1)\n    list[i] = list[k];\n  list.pop();\n}\n\nfunction arrayClone(arr, i) {\n  var copy = new Array(i);\n  while (i--)\n    copy[i] = arr[i];\n  return copy;\n}\n\nfunction unwrapListeners(arr) {\n  var ret = new Array(arr.length);\n  for (var i = 0; i < ret.length; ++i) {\n    ret[i] = arr[i].listener || arr[i];\n  }\n  return ret;\n}\n","var inherits = require('inherits')\nvar EventEmitter = require('events').EventEmitter\n\nmodule.exports = Queue\nmodule.exports.default = Queue\n\nfunction Queue (options) {\n  if (!(this instanceof Queue)) {\n    return new Queue(options)\n  }\n\n  EventEmitter.call(this)\n  options = options || {}\n  this.concurrency = options.concurrency || Infinity\n  this.timeout = options.timeout || 0\n  this.autostart = options.autostart || false\n  this.results = options.results || null\n  this.pending = 0\n  this.session = 0\n  this.running = false\n  this.jobs = []\n  this.timers = {}\n}\ninherits(Queue, EventEmitter)\n\nvar arrayMethods = [\n  'pop',\n  'shift',\n  'indexOf',\n  'lastIndexOf'\n]\n\narrayMethods.forEach(function (method) {\n  Queue.prototype[method] = function () {\n    return Array.prototype[method].apply(this.jobs, arguments)\n  }\n})\n\nQueue.prototype.slice = function (begin, end) {\n  this.jobs = this.jobs.slice(begin, end)\n  return this\n}\n\nQueue.prototype.reverse = function () {\n  this.jobs.reverse()\n  return this\n}\n\nvar arrayAddMethods = [\n  'push',\n  'unshift',\n  'splice'\n]\n\narrayAddMethods.forEach(function (method) {\n  Queue.prototype[method] = function () {\n    var methodResult = Array.prototype[method].apply(this.jobs, arguments)\n    if (this.autostart) {\n      this.start()\n    }\n    return methodResult\n  }\n})\n\nObject.defineProperty(Queue.prototype, 'length', {\n  get: function () {\n    return this.pending + this.jobs.length\n  }\n})\n\nQueue.prototype.start = function (cb) {\n  if (cb) {\n    callOnErrorOrEnd.call(this, cb)\n  }\n\n  this.running = true\n\n  if (this.pending >= this.concurrency) {\n    return\n  }\n\n  if (this.jobs.length === 0) {\n    if (this.pending === 0) {\n      done.call(this)\n    }\n    return\n  }\n\n  var self = this\n  var job = this.jobs.shift()\n  var once = true\n  var session = this.session\n  var timeoutId = null\n  var didTimeout = false\n  var resultIndex = null\n  var timeout = job.timeout || this.timeout\n\n  function next (err, result) {\n    if (once && self.session === session) {\n      once = false\n      self.pending--\n      if (timeoutId !== null) {\n        delete self.timers[timeoutId]\n        clearTimeout(timeoutId)\n      }\n\n      if (err) {\n        self.emit('error', err, job)\n      } else if (didTimeout === false) {\n        if (resultIndex !== null) {\n          self.results[resultIndex] = Array.prototype.slice.call(arguments, 1)\n        }\n        self.emit('success', result, job)\n      }\n\n      if (self.session === session) {\n        if (self.pending === 0 && self.jobs.length === 0) {\n          done.call(self)\n        } else if (self.running) {\n          self.start()\n        }\n      }\n    }\n  }\n\n  if (timeout) {\n    timeoutId = setTimeout(function () {\n      didTimeout = true\n      if (self.listeners('timeout').length > 0) {\n        self.emit('timeout', next, job)\n      } else {\n        next()\n      }\n    }, timeout)\n    this.timers[timeoutId] = timeoutId\n  }\n\n  if (this.results) {\n    resultIndex = this.results.length\n    this.results[resultIndex] = null\n  }\n\n  this.pending++\n  self.emit('start', job)\n  var promise = job(next)\n  if (promise && promise.then && typeof promise.then === 'function') {\n    promise.then(function (result) {\n      return next(null, result)\n    }).catch(function (err) {\n      return next(err || true)\n    })\n  }\n\n  if (this.running && this.jobs.length > 0) {\n    this.start()\n  }\n}\n\nQueue.prototype.stop = function () {\n  this.running = false\n}\n\nQueue.prototype.end = function (err) {\n  clearTimers.call(this)\n  this.jobs.length = 0\n  this.pending = 0\n  done.call(this, err)\n}\n\nfunction clearTimers () {\n  for (var key in this.timers) {\n    var timeoutId = this.timers[key]\n    delete this.timers[key]\n    clearTimeout(timeoutId)\n  }\n}\n\nfunction callOnErrorOrEnd (cb) {\n  var self = this\n  this.on('error', onerror)\n  this.on('end', onend)\n\n  function onerror (err) { self.end(err) }\n  function onend (err) {\n    self.removeListener('error', onerror)\n    self.removeListener('end', onend)\n    cb(err, this.results)\n  }\n}\n\nfunction done (err) {\n  this.session++\n  this.running = false\n  this.emit('end', err)\n}\n","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.BMP = {\n    validate(buffer) {\n        return ('BM' === buffer.toString('ascii', 0, 2));\n    },\n    calculate(buffer) {\n        return {\n            height: Math.abs(buffer.readInt32LE(22)),\n            width: buffer.readUInt32LE(18)\n        };\n    }\n};\n","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nconst TYPE_ICON = 1;\n/**\n * ICON Header\n *\n * | Offset | Size | Purpose |\n * | 0\t    | 2    | Reserved. Must always be 0.  |\n * | 2      | 2    | Image type: 1 for icon (.ICO) image, 2 for cursor (.CUR) image. Other values are invalid. |\n * | 4      | 2    | Number of images in the file. |\n *\n */\nconst SIZE_HEADER = 2 + 2 + 2; // 6\n/**\n * Image Entry\n *\n * | Offset | Size | Purpose |\n * | 0\t    | 1    | Image width in pixels. Can be any number between 0 and 255. Value 0 means width is 256 pixels. |\n * | 1      | 1    | Image height in pixels. Can be any number between 0 and 255. Value 0 means height is 256 pixels. |\n * | 2      | 1    | Number of colors in the color palette. Should be 0 if the image does not use a color palette. |\n * | 3      | 1    | Reserved. Should be 0. |\n * | 4      | 2    | ICO format: Color planes. Should be 0 or 1. |\n * |        |      | CUR format: The horizontal coordinates of the hotspot in number of pixels from the left. |\n * | 6      | 2    | ICO format: Bits per pixel. |\n * |        |      | CUR format: The vertical coordinates of the hotspot in number of pixels from the top. |\n * | 8      | 4    | The size of the image's data in bytes |\n * | 12     | 4    | The offset of BMP or PNG data from the beginning of the ICO/CUR file |\n *\n */\nconst SIZE_IMAGE_ENTRY = 1 + 1 + 1 + 1 + 2 + 2 + 4 + 4; // 16\nfunction getSizeFromOffset(buffer, offset) {\n    const value = buffer.readUInt8(offset);\n    return value === 0 ? 256 : value;\n}\nfunction getImageSize(buffer, imageIndex) {\n    const offset = SIZE_HEADER + (imageIndex * SIZE_IMAGE_ENTRY);\n    return {\n        height: getSizeFromOffset(buffer, offset + 1),\n        width: getSizeFromOffset(buffer, offset)\n    };\n}\nexports.ICO = {\n    validate(buffer) {\n        if (buffer.readUInt16LE(0) !== 0) {\n            return false;\n        }\n        return buffer.readUInt16LE(2) === TYPE_ICON;\n    },\n    calculate(buffer) {\n        const nbImages = buffer.readUInt16LE(4);\n        const imageSize = getImageSize(buffer, 0);\n        if (nbImages === 1) {\n            return imageSize;\n        }\n        const imgs = [imageSize];\n        for (let imageIndex = 1; imageIndex < nbImages; imageIndex += 1) {\n            imgs.push(getImageSize(buffer, imageIndex));\n        }\n        const result = {\n            height: imageSize.height,\n            images: imgs,\n            width: imageSize.width\n        };\n        return result;\n    }\n};\n","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nconst ico_1 = require(\"./ico\");\nconst TYPE_CURSOR = 2;\nexports.CUR = {\n    validate(buffer) {\n        if (buffer.readUInt16LE(0) !== 0) {\n            return false;\n        }\n        return buffer.readUInt16LE(2) === TYPE_CURSOR;\n    },\n    calculate(buffer) {\n        return ico_1.ICO.calculate(buffer);\n    }\n};\n","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.DDS = {\n    validate(buffer) {\n        return buffer.readUInt32LE(0) === 0x20534444;\n    },\n    calculate(buffer) {\n        return {\n            height: buffer.readUInt32LE(12),\n            width: buffer.readUInt32LE(16)\n        };\n    }\n};\n","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nconst gifRegexp = /^GIF8[79]a/;\nexports.GIF = {\n    validate(buffer) {\n        const signature = buffer.toString('ascii', 0, 6);\n        return (gifRegexp.test(signature));\n    },\n    calculate(buffer) {\n        return {\n            height: buffer.readUInt16LE(8),\n            width: buffer.readUInt16LE(6)\n        };\n    }\n};\n","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\n/**\n * ICNS Header\n *\n * | Offset | Size | Purpose                                                |\n * | 0\t    | 4    | Magic literal, must be \"icns\" (0x69, 0x63, 0x6e, 0x73) |\n * | 4      | 4    | Length of file, in bytes, msb first.                   |\n *\n */\nconst SIZE_HEADER = 4 + 4; // 8\nconst FILE_LENGTH_OFFSET = 4; // MSB => BIG ENDIAN\n/**\n * Image Entry\n *\n * | Offset | Size | Purpose                                                          |\n * | 0\t    | 4    | Icon type, see OSType below.                                     |\n * | 4      | 4    | Length of data, in bytes (including type and length), msb first. |\n * | 8      | n    | Icon data                                                        |\n */\nconst ENTRY_LENGTH_OFFSET = 4; // MSB => BIG ENDIAN\n/* tslint:disable:object-literal-sort-keys */\nconst ICON_TYPE_SIZE = {\n    ICON: 32,\n    'ICN#': 32,\n    // m => 16 x 16\n    'icm#': 16,\n    icm4: 16,\n    icm8: 16,\n    // s => 16 x 16\n    'ics#': 16,\n    ics4: 16,\n    ics8: 16,\n    is32: 16,\n    s8mk: 16,\n    icp4: 16,\n    // l => 32 x 32\n    icl4: 32,\n    icl8: 32,\n    il32: 32,\n    l8mk: 32,\n    icp5: 32,\n    ic11: 32,\n    // h => 48 x 48\n    ich4: 48,\n    ich8: 48,\n    ih32: 48,\n    h8mk: 48,\n    // . => 64 x 64\n    icp6: 64,\n    ic12: 32,\n    // t => 128 x 128\n    it32: 128,\n    t8mk: 128,\n    ic07: 128,\n    // . => 256 x 256\n    ic08: 256,\n    ic13: 256,\n    // . => 512 x 512\n    ic09: 512,\n    ic14: 512,\n    // . => 1024 x 1024\n    ic10: 1024,\n};\n/* tslint:enable:object-literal-sort-keys */\nfunction readImageHeader(buffer, imageOffset) {\n    const imageLengthOffset = imageOffset + ENTRY_LENGTH_OFFSET;\n    return [\n        buffer.toString('ascii', imageOffset, imageLengthOffset),\n        buffer.readUInt32BE(imageLengthOffset)\n    ];\n}\nfunction getImageSize(type) {\n    const size = ICON_TYPE_SIZE[type];\n    return { width: size, height: size, type };\n}\nexports.ICNS = {\n    validate(buffer) {\n        return ('icns' === buffer.toString('ascii', 0, 4));\n    },\n    calculate(buffer) {\n        const bufferLength = buffer.length;\n        const fileLength = buffer.readUInt32BE(FILE_LENGTH_OFFSET);\n        let imageOffset = SIZE_HEADER;\n        let imageHeader = readImageHeader(buffer, imageOffset);\n        let imageSize = getImageSize(imageHeader[0]);\n        imageOffset += imageHeader[1];\n        if (imageOffset === fileLength) {\n            return imageSize;\n        }\n        const result = {\n            height: imageSize.height,\n            images: [imageSize],\n            width: imageSize.width\n        };\n        while (imageOffset < fileLength && imageOffset < bufferLength) {\n            imageHeader = readImageHeader(buffer, imageOffset);\n            imageSize = getImageSize(imageHeader[0]);\n            imageOffset += imageHeader[1];\n            result.images.push(imageSize);\n        }\n        return result;\n    }\n};\n","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.J2C = {\n    validate(buffer) {\n        // TODO: this doesn't seem right. SIZ marker doesnt have to be right after the SOC\n        return buffer.toString('hex', 0, 4) === 'ff4fff51';\n    },\n    calculate(buffer) {\n        return {\n            height: buffer.readUInt32BE(12),\n            width: buffer.readUInt32BE(8),\n        };\n    }\n};\n","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nconst BoxTypes = {\n    ftyp: '66747970',\n    ihdr: '69686472',\n    jp2h: '6a703268',\n    jp__: '6a502020',\n    rreq: '72726571',\n    xml_: '786d6c20'\n};\nconst calculateRREQLength = (box) => {\n    const unit = box.readUInt8(0);\n    let offset = 1 + (2 * unit);\n    const numStdFlags = box.readUInt16BE(offset);\n    const flagsLength = numStdFlags * (2 + unit);\n    offset = offset + 2 + flagsLength;\n    const numVendorFeatures = box.readUInt16BE(offset);\n    const featuresLength = numVendorFeatures * (16 + unit);\n    return offset + 2 + featuresLength;\n};\nconst parseIHDR = (box) => {\n    return {\n        height: box.readUInt32BE(4),\n        width: box.readUInt32BE(8),\n    };\n};\nexports.JP2 = {\n    validate(buffer) {\n        const signature = buffer.toString('hex', 4, 8);\n        const signatureLength = buffer.readUInt32BE(0);\n        if (signature !== BoxTypes.jp__ || signatureLength < 1) {\n            return false;\n        }\n        const ftypeBoxStart = signatureLength + 4;\n        const ftypBoxLength = buffer.readUInt32BE(signatureLength);\n        const ftypBox = buffer.slice(ftypeBoxStart, ftypeBoxStart + ftypBoxLength);\n        return ftypBox.toString('hex', 0, 4) === BoxTypes.ftyp;\n    },\n    calculate(buffer) {\n        const signatureLength = buffer.readUInt32BE(0);\n        const ftypBoxLength = buffer.readUInt16BE(signatureLength + 2);\n        let offset = signatureLength + 4 + ftypBoxLength;\n        const nextBoxType = buffer.toString('hex', offset, offset + 4);\n        switch (nextBoxType) {\n            case BoxTypes.rreq:\n                // WHAT ARE THESE 4 BYTES?????\n                const MAGIC = 4;\n                offset = offset + 4 + MAGIC + calculateRREQLength(buffer.slice(offset + 4));\n                return parseIHDR(buffer.slice(offset + 8, offset + 24));\n            case BoxTypes.jp2h:\n                return parseIHDR(buffer.slice(offset + 8, offset + 24));\n            default:\n                throw new TypeError('Unsupported header found: ' + buffer.toString('ascii', offset, offset + 4));\n        }\n    }\n};\n","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\n// Abstract reading multi-byte unsigned integers\nfunction readUInt(buffer, bits, offset, isBigEndian) {\n    offset = offset || 0;\n    const endian = isBigEndian ? 'BE' : 'LE';\n    const methodName = ('readUInt' + bits + endian);\n    const method = buffer[methodName];\n    return method.call(buffer, offset);\n}\nexports.readUInt = readUInt;\n","\"use strict\";\n// NOTE: we only support baseline and progressive JPGs here\n// due to the structure of the loader class, we only get a buffer\n// with a maximum size of 4096 bytes. so if the SOF marker is outside\n// if this range we can't detect the file size correctly.\nObject.defineProperty(exports, \"__esModule\", { value: true });\nconst readUInt_1 = require(\"../readUInt\");\nconst EXIF_MARKER = '45786966';\nconst APP1_DATA_SIZE_BYTES = 2;\nconst EXIF_HEADER_BYTES = 6;\nconst TIFF_BYTE_ALIGN_BYTES = 2;\nconst BIG_ENDIAN_BYTE_ALIGN = '4d4d';\nconst LITTLE_ENDIAN_BYTE_ALIGN = '4949';\n// Each entry is exactly 12 bytes\nconst IDF_ENTRY_BYTES = 12;\nconst NUM_DIRECTORY_ENTRIES_BYTES = 2;\nfunction isEXIF(buffer) {\n    return (buffer.toString('hex', 2, 6) === EXIF_MARKER);\n}\nfunction extractSize(buffer, index) {\n    return {\n        height: buffer.readUInt16BE(index),\n        width: buffer.readUInt16BE(index + 2)\n    };\n}\nfunction validateExifBlock(buffer, index) {\n    // Skip APP1 Data Size\n    const exifBlock = buffer.slice(APP1_DATA_SIZE_BYTES, index);\n    // Consider byte alignment\n    const byteAlign = exifBlock.toString('hex', EXIF_HEADER_BYTES, EXIF_HEADER_BYTES + TIFF_BYTE_ALIGN_BYTES);\n    // Ignore Empty EXIF. Validate byte alignment\n    const isBigEndian = byteAlign === BIG_ENDIAN_BYTE_ALIGN;\n    const isLittleEndian = byteAlign === LITTLE_ENDIAN_BYTE_ALIGN;\n    if (isBigEndian || isLittleEndian) {\n        return extractOrientation(exifBlock, isBigEndian);\n    }\n}\nfunction extractOrientation(exifBlock, isBigEndian) {\n    // TODO: assert that this contains 0x002A\n    // let STATIC_MOTOROLA_TIFF_HEADER_BYTES = 2\n    // let TIFF_IMAGE_FILE_DIRECTORY_BYTES = 4\n    // TODO: derive from TIFF_IMAGE_FILE_DIRECTORY_BYTES\n    const idfOffset = 8;\n    // IDF osset works from right after the header bytes\n    // (so the offset includes the tiff byte align)\n    const offset = EXIF_HEADER_BYTES + idfOffset;\n    const idfDirectoryEntries = readUInt_1.readUInt(exifBlock, 16, offset, isBigEndian);\n    for (let directoryEntryNumber = 0; directoryEntryNumber < idfDirectoryEntries; directoryEntryNumber++) {\n        const start = offset + NUM_DIRECTORY_ENTRIES_BYTES + (directoryEntryNumber * IDF_ENTRY_BYTES);\n        const end = start + IDF_ENTRY_BYTES;\n        // Skip on corrupt EXIF blocks\n        if (start > exifBlock.length) {\n            return;\n        }\n        const block = exifBlock.slice(start, end);\n        const tagNumber = readUInt_1.readUInt(block, 16, 0, isBigEndian);\n        // 0x0112 (decimal: 274) is the `orientation` tag ID\n        if (tagNumber === 274) {\n            const dataFormat = readUInt_1.readUInt(block, 16, 2, isBigEndian);\n            if (dataFormat !== 3) {\n                return;\n            }\n            // unsinged int has 2 bytes per component\n            // if there would more than 4 bytes in total it's a pointer\n            const numberOfComponents = readUInt_1.readUInt(block, 32, 4, isBigEndian);\n            if (numberOfComponents !== 1) {\n                return;\n            }\n            return readUInt_1.readUInt(block, 16, 8, isBigEndian);\n        }\n    }\n}\nfunction validateBuffer(buffer, index) {\n    // index should be within buffer limits\n    if (index > buffer.length) {\n        throw new TypeError('Corrupt JPG, exceeded buffer limits');\n    }\n    // Every JPEG block must begin with a 0xFF\n    if (buffer[index] !== 0xFF) {\n        throw new TypeError('Invalid JPG, marker table corrupted');\n    }\n}\nexports.JPG = {\n    validate(buffer) {\n        const SOIMarker = buffer.toString('hex', 0, 2);\n        return ('ffd8' === SOIMarker);\n    },\n    calculate(buffer) {\n        // Skip 4 chars, they are for signature\n        buffer = buffer.slice(4);\n        let orientation;\n        let next;\n        while (buffer.length) {\n            // read length of the next block\n            const i = buffer.readUInt16BE(0);\n            if (isEXIF(buffer)) {\n                orientation = validateExifBlock(buffer, i);\n            }\n            // ensure correct format\n            validateBuffer(buffer, i);\n            // 0xFFC0 is baseline standard(SOF)\n            // 0xFFC1 is baseline optimized(SOF)\n            // 0xFFC2 is progressive(SOF2)\n            next = buffer[i + 1];\n            if (next === 0xC0 || next === 0xC1 || next === 0xC2) {\n                const size = extractSize(buffer, i + 5);\n                // TODO: is orientation=0 a valid answer here?\n                if (!orientation) {\n                    return size;\n                }\n                return {\n                    height: size.height,\n                    orientation,\n                    width: size.width\n                };\n            }\n            // move to the next block\n            buffer = buffer.slice(i + 2);\n        }\n        throw new TypeError('Invalid JPG, no size found');\n    }\n};\n","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nconst SIGNATURE = 'KTX 11';\nexports.KTX = {\n    validate(buffer) {\n        return SIGNATURE === buffer.toString('ascii', 1, 7);\n    },\n    calculate(buffer) {\n        return {\n            height: buffer.readUInt32LE(40),\n            width: buffer.readUInt32LE(36),\n        };\n    }\n};\n","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nconst pngSignature = 'PNG\\r\\n\\x1a\\n';\nconst pngImageHeaderChunkName = 'IHDR';\n// Used to detect \"fried\" png's: http://www.jongware.com/pngdefry.html\nconst pngFriedChunkName = 'CgBI';\nexports.PNG = {\n    validate(buffer) {\n        if (pngSignature === buffer.toString('ascii', 1, 8)) {\n            let chunkName = buffer.toString('ascii', 12, 16);\n            if (chunkName === pngFriedChunkName) {\n                chunkName = buffer.toString('ascii', 28, 32);\n            }\n            if (chunkName !== pngImageHeaderChunkName) {\n                throw new TypeError('Invalid PNG');\n            }\n            return true;\n        }\n        return false;\n    },\n    calculate(buffer) {\n        if (buffer.toString('ascii', 12, 16) === pngFriedChunkName) {\n            return {\n                height: buffer.readUInt32BE(36),\n                width: buffer.readUInt32BE(32)\n            };\n        }\n        return {\n            height: buffer.readUInt32BE(20),\n            width: buffer.readUInt32BE(16)\n        };\n    }\n};\n","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nconst PNMTypes = {\n    P1: 'pbm/ascii',\n    P2: 'pgm/ascii',\n    P3: 'ppm/ascii',\n    P4: 'pbm',\n    P5: 'pgm',\n    P6: 'ppm',\n    P7: 'pam',\n    PF: 'pfm'\n};\nconst Signatures = Object.keys(PNMTypes);\nconst handlers = {\n    default: (lines) => {\n        let dimensions = [];\n        while (lines.length > 0) {\n            const line = lines.shift();\n            if (line[0] === '#') {\n                continue;\n            }\n            dimensions = line.split(' ');\n            break;\n        }\n        if (dimensions.length === 2) {\n            return {\n                height: parseInt(dimensions[1], 10),\n                width: parseInt(dimensions[0], 10),\n            };\n        }\n        else {\n            throw new TypeError('Invalid PNM');\n        }\n    },\n    pam: (lines) => {\n        const size = {};\n        while (lines.length > 0) {\n            const line = lines.shift();\n            if (line.length > 16 || line.charCodeAt(0) > 128) {\n                continue;\n            }\n            const [key, value] = line.split(' ');\n            if (key && value) {\n                size[key.toLowerCase()] = parseInt(value, 10);\n            }\n            if (size.height && size.width) {\n                break;\n            }\n        }\n        if (size.height && size.width) {\n            return {\n                height: size.height,\n                width: size.width\n            };\n        }\n        else {\n            throw new TypeError('Invalid PAM');\n        }\n    }\n};\nexports.PNM = {\n    validate(buffer) {\n        const signature = buffer.toString('ascii', 0, 2);\n        return Signatures.includes(signature);\n    },\n    calculate(buffer) {\n        const signature = buffer.toString('ascii', 0, 2);\n        const type = PNMTypes[signature];\n        // TODO: this probably generates garbage. move to a stream based parser\n        const lines = buffer.toString('ascii', 3).split(/[\\r\\n]+/);\n        const handler = handlers[type] || handlers.default;\n        return handler(lines);\n    }\n};\n","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.PSD = {\n    validate(buffer) {\n        return ('8BPS' === buffer.toString('ascii', 0, 4));\n    },\n    calculate(buffer) {\n        return {\n            height: buffer.readUInt32BE(14),\n            width: buffer.readUInt32BE(18)\n        };\n    }\n};\n","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nconst svgReg = /<svg\\s([^>\"']|\"[^\"]*\"|'[^']*')*>/;\nconst extractorRegExps = {\n    height: /\\sheight=(['\"])([^%]+?)\\1/,\n    root: svgReg,\n    viewbox: /\\sviewBox=(['\"])(.+?)\\1/,\n    width: /\\swidth=(['\"])([^%]+?)\\1/,\n};\nconst INCH_CM = 2.54;\nconst units = {\n    cm: 96 / INCH_CM,\n    em: 16,\n    ex: 8,\n    m: 96 / INCH_CM * 100,\n    mm: 96 / INCH_CM / 10,\n    pc: 96 / 72 / 12,\n    pt: 96 / 72,\n};\nfunction parseLength(len) {\n    const m = /([0-9.]+)([a-z]*)/.exec(len);\n    if (!m) {\n        return undefined;\n    }\n    return Math.round(parseFloat(m[1]) * (units[m[2]] || 1));\n}\nfunction parseViewbox(viewbox) {\n    const bounds = viewbox.split(' ');\n    return {\n        height: parseLength(bounds[3]),\n        width: parseLength(bounds[2])\n    };\n}\nfunction parseAttributes(root) {\n    const width = root.match(extractorRegExps.width);\n    const height = root.match(extractorRegExps.height);\n    const viewbox = root.match(extractorRegExps.viewbox);\n    return {\n        height: height && parseLength(height[2]),\n        viewbox: viewbox && parseViewbox(viewbox[2]),\n        width: width && parseLength(width[2]),\n    };\n}\nfunction calculateByDimensions(attrs) {\n    return {\n        height: attrs.height,\n        width: attrs.width,\n    };\n}\nfunction calculateByViewbox(attrs, viewbox) {\n    const ratio = viewbox.width / viewbox.height;\n    if (attrs.width) {\n        return {\n            height: Math.floor(attrs.width / ratio),\n            width: attrs.width,\n        };\n    }\n    if (attrs.height) {\n        return {\n            height: attrs.height,\n            width: Math.floor(attrs.height * ratio),\n        };\n    }\n    return {\n        height: viewbox.height,\n        width: viewbox.width,\n    };\n}\nexports.SVG = {\n    validate(buffer) {\n        const str = String(buffer);\n        return svgReg.test(str);\n    },\n    calculate(buffer) {\n        const root = buffer.toString('utf8').match(extractorRegExps.root);\n        if (root) {\n            const attrs = parseAttributes(root[0]);\n            if (attrs.width && attrs.height) {\n                return calculateByDimensions(attrs);\n            }\n            if (attrs.viewbox) {\n                return calculateByViewbox(attrs, attrs.viewbox);\n            }\n        }\n        throw new TypeError('Invalid SVG');\n    }\n};\n","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\n// based on http://www.compix.com/fileformattif.htm\n// TO-DO: support big-endian as well\nconst fs = require(\"fs\");\nconst readUInt_1 = require(\"../readUInt\");\n// Read IFD (image-file-directory) into a buffer\nfunction readIFD(buffer, filepath, isBigEndian) {\n    const ifdOffset = readUInt_1.readUInt(buffer, 32, 4, isBigEndian);\n    // read only till the end of the file\n    let bufferSize = 1024;\n    const fileSize = fs.statSync(filepath).size;\n    if (ifdOffset + bufferSize > fileSize) {\n        bufferSize = fileSize - ifdOffset - 10;\n    }\n    // populate the buffer\n    const endBuffer = Buffer.alloc(bufferSize);\n    const descriptor = fs.openSync(filepath, 'r');\n    fs.readSync(descriptor, endBuffer, 0, bufferSize, ifdOffset);\n    return endBuffer.slice(2);\n}\n// TIFF values seem to be messed up on Big-Endian, this helps\nfunction readValue(buffer, isBigEndian) {\n    const low = readUInt_1.readUInt(buffer, 16, 8, isBigEndian);\n    const high = readUInt_1.readUInt(buffer, 16, 10, isBigEndian);\n    return (high << 16) + low;\n}\n// move to the next tag\nfunction nextTag(buffer) {\n    if (buffer.length > 24) {\n        return buffer.slice(12);\n    }\n}\n// Extract IFD tags from TIFF metadata\nfunction extractTags(buffer, isBigEndian) {\n    const tags = {};\n    let temp = buffer;\n    while (temp && temp.length) {\n        const code = readUInt_1.readUInt(temp, 16, 0, isBigEndian);\n        const type = readUInt_1.readUInt(temp, 16, 2, isBigEndian);\n        const length = readUInt_1.readUInt(temp, 32, 4, isBigEndian);\n        // 0 means end of IFD\n        if (code === 0) {\n            break;\n        }\n        else {\n            // 256 is width, 257 is height\n            // if (code === 256 || code === 257) {\n            if (length === 1 && (type === 3 || type === 4)) {\n                tags[code] = readValue(temp, isBigEndian);\n            }\n            // move to the next tag\n            temp = nextTag(temp);\n        }\n    }\n    return tags;\n}\n// Test if the TIFF is Big Endian or Little Endian\nfunction determineEndianness(buffer) {\n    const signature = buffer.toString('ascii', 0, 2);\n    if ('II' === signature) {\n        return 'LE';\n    }\n    else if ('MM' === signature) {\n        return 'BE';\n    }\n}\nconst signatures = [\n    // '492049', // currently not supported\n    '49492a00',\n    '4d4d002a',\n];\nexports.TIFF = {\n    validate(buffer) {\n        return signatures.includes(buffer.toString('hex', 0, 4));\n    },\n    calculate(buffer, filepath) {\n        if (!filepath) {\n            throw new TypeError('Tiff doesn\\'t support buffer');\n        }\n        // Determine BE/LE\n        const isBigEndian = determineEndianness(buffer) === 'BE';\n        // read the IFD\n        const ifdBuffer = readIFD(buffer, filepath, isBigEndian);\n        // extract the tags from the IFD\n        const tags = extractTags(ifdBuffer, isBigEndian);\n        const width = tags[256];\n        const height = tags[257];\n        if (!width || !height) {\n            throw new TypeError('Invalid Tiff. Missing tags');\n        }\n        return { height, width };\n    }\n};\n","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nfunction calculateExtended(buffer) {\n    return {\n        height: 1 + buffer.readUIntLE(7, 3),\n        width: 1 + buffer.readUIntLE(4, 3)\n    };\n}\nfunction calculateLossless(buffer) {\n    return {\n        height: 1 + (((buffer[4] & 0xF) << 10) | (buffer[3] << 2) | ((buffer[2] & 0xC0) >> 6)),\n        width: 1 + (((buffer[2] & 0x3F) << 8) | buffer[1])\n    };\n}\nfunction calculateLossy(buffer) {\n    // `& 0x3fff` returns the last 14 bits\n    // TO-DO: include webp scaling in the calculations\n    return {\n        height: buffer.readInt16LE(8) & 0x3fff,\n        width: buffer.readInt16LE(6) & 0x3fff\n    };\n}\nexports.WEBP = {\n    validate(buffer) {\n        const riffHeader = 'RIFF' === buffer.toString('ascii', 0, 4);\n        const webpHeader = 'WEBP' === buffer.toString('ascii', 8, 12);\n        const vp8Header = 'VP8' === buffer.toString('ascii', 12, 15);\n        return (riffHeader && webpHeader && vp8Header);\n    },\n    calculate(buffer) {\n        const chunkHeader = buffer.toString('ascii', 12, 16);\n        buffer = buffer.slice(20, 30);\n        // Extended webp stream signature\n        if (chunkHeader === 'VP8X') {\n            const extendedHeader = buffer[0];\n            const validStart = (extendedHeader & 0xc0) === 0;\n            const validEnd = (extendedHeader & 0x01) === 0;\n            if (validStart && validEnd) {\n                return calculateExtended(buffer);\n            }\n            else {\n                // TODO: breaking change\n                throw new TypeError('Invalid WebP');\n            }\n        }\n        // Lossless webp stream signature\n        if (chunkHeader === 'VP8 ' && buffer[0] !== 0x2f) {\n            return calculateLossy(buffer);\n        }\n        // Lossy webp stream signature\n        const signature = buffer.toString('hex', 3, 6);\n        if (chunkHeader === 'VP8L' && signature !== '9d012a') {\n            return calculateLossless(buffer);\n        }\n        throw new TypeError('Invalid WebP');\n    }\n};\n","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nconst bmp_1 = require(\"./types/bmp\");\nconst cur_1 = require(\"./types/cur\");\nconst dds_1 = require(\"./types/dds\");\nconst gif_1 = require(\"./types/gif\");\nconst icns_1 = require(\"./types/icns\");\nconst ico_1 = require(\"./types/ico\");\nconst j2c_1 = require(\"./types/j2c\");\nconst jp2_1 = require(\"./types/jp2\");\nconst jpg_1 = require(\"./types/jpg\");\nconst ktx_1 = require(\"./types/ktx\");\nconst png_1 = require(\"./types/png\");\nconst pnm_1 = require(\"./types/pnm\");\nconst psd_1 = require(\"./types/psd\");\nconst svg_1 = require(\"./types/svg\");\nconst tiff_1 = require(\"./types/tiff\");\nconst webp_1 = require(\"./types/webp\");\nexports.typeHandlers = {\n    bmp: bmp_1.BMP,\n    cur: cur_1.CUR,\n    dds: dds_1.DDS,\n    gif: gif_1.GIF,\n    icns: icns_1.ICNS,\n    ico: ico_1.ICO,\n    j2c: j2c_1.J2C,\n    jp2: jp2_1.JP2,\n    jpg: jpg_1.JPG,\n    ktx: ktx_1.KTX,\n    png: png_1.PNG,\n    pnm: pnm_1.PNM,\n    psd: psd_1.PSD,\n    svg: svg_1.SVG,\n    tiff: tiff_1.TIFF,\n    webp: webp_1.WEBP,\n};\n","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nconst types_1 = require(\"./types\");\nconst keys = Object.keys(types_1.typeHandlers);\n// This map helps avoid validating for every single image type\nconst firstBytes = {\n    0x38: 'psd',\n    0x42: 'bmp',\n    0x44: 'dds',\n    0x47: 'gif',\n    0x49: 'tiff',\n    0x4d: 'tiff',\n    0x52: 'webp',\n    0x69: 'icns',\n    0x89: 'png',\n    0xff: 'jpg'\n};\nfunction detector(buffer) {\n    const byte = buffer[0];\n    if (byte in firstBytes) {\n        const type = firstBytes[byte];\n        if (types_1.typeHandlers[type].validate(buffer)) {\n            return type;\n        }\n    }\n    const finder = (key) => types_1.typeHandlers[key].validate(buffer);\n    return keys.find(finder);\n}\nexports.detector = detector;\n","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nconst fs = require(\"fs\");\n// fs.promises polyfill for node 8.x\nif (!('promises' in fs)) {\n    class FileHandle {\n        constructor(fd) {\n            this.fd = fd;\n        }\n        stat() {\n            return new Promise((resolve, reject) => {\n                fs.fstat(this.fd, (err, stats) => {\n                    if (err) {\n                        reject(err);\n                    }\n                    else {\n                        resolve(stats);\n                    }\n                });\n            });\n        }\n        read(buffer, offset, length, position) {\n            return new Promise((resolve, reject) => {\n                fs.read(this.fd, buffer, offset, length, position, (err) => {\n                    if (err) {\n                        reject(err);\n                    }\n                    else {\n                        resolve();\n                    }\n                });\n            });\n        }\n        close() {\n            return new Promise((resolve, reject) => {\n                fs.close(this.fd, (err) => {\n                    if (err) {\n                        reject(err);\n                    }\n                    else {\n                        resolve();\n                    }\n                });\n            });\n        }\n    }\n    Object.defineProperty(fs, 'promises', {\n        value: {\n            open: (filepath, flags) => (new Promise((resolve, reject) => {\n                fs.open(filepath, flags, (err, fd) => {\n                    if (err) {\n                        reject(err);\n                    }\n                    else {\n                        resolve(new FileHandle(fd));\n                    }\n                });\n            })),\n        },\n        writable: false\n    });\n}\n","\"use strict\";\nvar __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\n    return new (P || (P = Promise))(function (resolve, reject) {\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\n    });\n};\nObject.defineProperty(exports, \"__esModule\", { value: true });\nconst fs = require(\"fs\");\nconst path = require(\"path\");\nconst queue_1 = require(\"queue\");\nconst types_1 = require(\"./types\");\nconst detector_1 = require(\"./detector\");\nrequire(\"./fs.promises\");\n// Maximum buffer size, with a default of 512 kilobytes.\n// TO-DO: make this adaptive based on the initial signature of the image\nconst MaxBufferSize = 512 * 1024;\n// This queue is for async `fs` operations, to avoid reaching file-descriptor limits\nconst queue = new queue_1.default({ concurrency: 100, autostart: true });\n/**\n * Return size information based on a buffer\n *\n * @param {Buffer} buffer\n * @param {String} filepath\n * @returns {Object}\n */\nfunction lookup(buffer, filepath) {\n    // detect the file type.. don't rely on the extension\n    const type = detector_1.detector(buffer);\n    // find an appropriate handler for this file type\n    if (type && type in types_1.typeHandlers) {\n        const size = types_1.typeHandlers[type].calculate(buffer, filepath);\n        if (size !== undefined) {\n            size.type = type;\n            return size;\n        }\n    }\n    // throw up, if we don't understand the file\n    throw new TypeError('unsupported file type: ' + type + ' (file: ' + filepath + ')');\n}\n/**\n * Reads a file into a buffer.\n * @param {String} filepath\n * @returns {Promise<Buffer>}\n */\nfunction asyncFileToBuffer(filepath) {\n    return __awaiter(this, void 0, void 0, function* () {\n        const handle = yield fs.promises.open(filepath, 'r');\n        const { size } = yield handle.stat();\n        if (size <= 0) {\n            throw new Error('Empty file');\n        }\n        const bufferSize = Math.min(size, MaxBufferSize);\n        const buffer = Buffer.alloc(bufferSize);\n        yield handle.read(buffer, 0, bufferSize, 0);\n        yield handle.close();\n        return buffer;\n    });\n}\n/**\n * Synchronously reads a file into a buffer, blocking the nodejs process.\n *\n * @param {String} filepath\n * @returns {Buffer}\n */\nfunction syncFileToBuffer(filepath) {\n    // read from the file, synchronously\n    const descriptor = fs.openSync(filepath, 'r');\n    const size = fs.fstatSync(descriptor).size;\n    const bufferSize = Math.min(size, MaxBufferSize);\n    const buffer = Buffer.alloc(bufferSize);\n    fs.readSync(descriptor, buffer, 0, bufferSize, 0);\n    fs.closeSync(descriptor);\n    return buffer;\n}\nmodule.exports = exports = imageSize; // backwards compatibility\n/**\n * @param {Buffer|string} input - buffer or relative/absolute path of the image file\n * @param {Function=} [callback] - optional function for async detection\n */\nfunction imageSize(input, callback) {\n    // Handle buffer input\n    if (Buffer.isBuffer(input)) {\n        return lookup(input);\n    }\n    // input should be a string at this point\n    if (typeof input !== 'string') {\n        throw new TypeError('invalid invocation');\n    }\n    // resolve the file path\n    const filepath = path.resolve(input);\n    if (typeof callback === 'function') {\n        queue.push(() => asyncFileToBuffer(filepath)\n            .then((buffer) => process.nextTick(callback, null, lookup(buffer, filepath)))\n            .catch(callback));\n    }\n    else {\n        const buffer = syncFileToBuffer(filepath);\n        return lookup(buffer, filepath);\n    }\n}\nexports.imageSize = imageSize;\nexports.setConcurrency = (c) => { queue.concurrency = c; };\nexports.types = Object.keys(types_1.typeHandlers);\n","const namespaces = {\n  a: 'http://schemas.openxmlformats.org/drawingml/2006/main',\n  b: 'http://schemas.openxmlformats.org/officeDocument/2006/bibliography',\n  cdr: 'http://schemas.openxmlformats.org/drawingml/2006/chartDrawing',\n  dc: 'http://purl.org/dc/elements/1.1/',\n  dcmitype: 'http://purl.org/dc/dcmitype/',\n  dcterms: 'http://purl.org/dc/terms/',\n  o: 'urn:schemas-microsoft-com:office:office',\n  pic: 'http://schemas.openxmlformats.org/drawingml/2006/picture',\n  r: 'http://schemas.openxmlformats.org/officeDocument/2006/relationships',\n  v: 'urn:schemas-microsoft-com:vml',\n  ve: 'http://schemas.openxmlformats.org/markup-compatibility/2006',\n  vt: 'http://schemas.openxmlformats.org/officeDocument/2006/docPropsVTypes',\n  w: 'http://schemas.openxmlformats.org/wordprocessingml/2006/main',\n  w10: 'urn:schemas-microsoft-com:office:word',\n  wp: 'http://schemas.openxmlformats.org/drawingml/2006/wordprocessingDrawing',\n  wne: 'http://schemas.microsoft.com/office/word/2006/wordml',\n  xsd: 'http://www.w3.org/2001/XMLSchema',\n  xsi: 'http://www.w3.org/2001/XMLSchema-instance',\n  numbering: 'http://schemas.openxmlformats.org/officeDocument/2006/relationships/numbering',\n  hyperlinks: 'http://schemas.openxmlformats.org/officeDocument/2006/relationships/hyperlink',\n  images: 'http://schemas.openxmlformats.org/officeDocument/2006/relationships/image',\n  styles: 'http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles',\n  headers: 'http://schemas.openxmlformats.org/officeDocument/2006/relationships/header',\n  footers: 'http://schemas.openxmlformats.org/officeDocument/2006/relationships/footer',\n  themes: 'http://schemas.openxmlformats.org/officeDocument/2006/relationships/theme',\n  coreProperties: 'http://schemas.openxmlformats.org/package/2006/metadata/core-properties',\n  officeDocumentRelation:\n    'http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument',\n  corePropertiesRelation:\n    'http://schemas.openxmlformats.org/package/2006/relationships/metadata/core-properties',\n  settingsRelation: 'http://schemas.openxmlformats.org/officeDocument/2006/relationships/settings',\n  webSettingsRelation:\n    'http://schemas.openxmlformats.org/officeDocument/2006/relationships/webSettings',\n  sl: 'http://schemas.openxmlformats.org/schemaLibrary/2006/main',\n};\n\nexport default namespaces;\n","/* eslint-disable no-param-reassign */\n\nexport const rgbRegex = /rgb\\((\\d+),\\s*([\\d.]+),\\s*([\\d.]+)\\)/i;\nexport const hslRegex = /hsl\\((\\d+),\\s*([\\d.]+)%,\\s*([\\d.]+)%\\)/i;\nexport const hexRegex = /#([0-9A-F]{6})/i;\nexport const hex3Regex = /#([0-9A-F])([0-9A-F])([0-9A-F])/i;\n\n// eslint-disable-next-line import/prefer-default-export\nexport const rgbToHex = (red, green, blue) => {\n  const hexColorCode = [red, green, blue]\n    .map((x) => {\n      // eslint-disable-next-line radix, no-param-reassign\n      x = parseInt(x).toString(16);\n      return x.length === 1 ? `0${x}` : x;\n    })\n    .join('');\n\n  return hexColorCode;\n};\n\nexport const hslToHex = (hue, saturation, luminosity) => {\n  hue /= 360;\n  saturation /= 100;\n  luminosity /= 100;\n  // eslint-disable-next-line one-var\n  let red, green, blue;\n  if (saturation === 0) {\n    // eslint-disable-next-line no-multi-assign\n    red = green = blue = luminosity; // achromatic\n  } else {\n    const hue2rgb = (p, q, t) => {\n      if (t < 0) t += 1;\n      if (t > 1) t -= 1;\n      if (t < 1 / 6) return p + (q - p) * 6 * t;\n      if (t < 1 / 2) return q;\n      if (t < 2 / 3) return p + (q - p) * (2 / 3 - t) * 6;\n      return p;\n    };\n    const q =\n      luminosity < 0.5\n        ? luminosity * (1 + saturation)\n        : luminosity + saturation - luminosity * saturation;\n    const p = 2 * luminosity - q;\n    red = hue2rgb(p, q, hue + 1 / 3);\n    green = hue2rgb(p, q, hue);\n    blue = hue2rgb(p, q, hue - 1 / 3);\n  }\n  return [red, green, blue]\n    .map((x) => {\n      const hex = Math.round(x * 255).toString(16);\n      return hex.length === 1 ? `0${hex}` : hex;\n    })\n    .join('');\n};\n\nexport const hex3ToHex = (red, green, blue) => {\n  const hexColorCode = [red, green, blue].map((x) => `${x}${x}`).join('');\n\n  return hexColorCode;\n};\n","export const pixelRegex = /([\\d.]+)px/i;\nexport const percentageRegex = /([\\d.]+)%/i;\nexport const pointRegex = /(\\d+)pt/i;\nexport const cmRegex = /([\\d.]+)cm/i;\nexport const inchRegex = /([\\d.]+)in/i;\n\nexport const pixelToEMU = (pixelValue) => {\n  return Math.round(pixelValue * 9525);\n};\n\nexport const EMUToPixel = (EMUValue) => {\n  return Math.round(EMUValue / 9525);\n};\n\nexport const TWIPToEMU = (TWIPValue) => {\n  return Math.round(TWIPValue * 635);\n};\n\nexport const EMUToTWIP = (EMUValue) => {\n  return Math.round(EMUValue / 635);\n};\n\nexport const pointToTWIP = (pointValue) => {\n  return Math.round(pointValue * 20);\n};\n\nexport const TWIPToPoint = (TWIPValue) => {\n  return Math.round(TWIPValue / 20);\n};\n\nexport const pointToHIP = (pointValue) => {\n  return Math.round(pointValue * 2);\n};\n\nexport const HIPToPoint = (HIPValue) => {\n  return Math.round(HIPValue / 2);\n};\n\nexport const HIPToTWIP = (HIPValue) => {\n  return Math.round(HIPValue * 10);\n};\n\nexport const TWIPToHIP = (TWIPValue) => {\n  return Math.round(TWIPValue / 10);\n};\n\nexport const pixelToTWIP = (pixelValue) => {\n  return EMUToTWIP(pixelToEMU(pixelValue));\n};\n\nexport const TWIPToPixel = (TWIPValue) => {\n  return EMUToPixel(TWIPToEMU(TWIPValue));\n};\n\nexport const pixelToHIP = (pixelValue) => {\n  return TWIPToHIP(EMUToTWIP(pixelToEMU(pixelValue)));\n};\n\nexport const HIPToPixel = (HIPValue) => {\n  return EMUToPixel(TWIPToEMU(HIPToTWIP(HIPValue)));\n};\n\nexport const inchToPoint = (inchValue) => {\n  return Math.round(inchValue * 72);\n};\n\nexport const inchToTWIP = (inchValue) => {\n  return pointToTWIP(inchToPoint(inchValue));\n};\n\nexport const cmToInch = (cmValue) => {\n  return cmValue * 0.3937008;\n};\n\nexport const cmToTWIP = (cmValue) => {\n  return inchToTWIP(cmToInch(cmValue));\n};\n\nexport const pixelToPoint = (pixelValue) => {\n  return HIPToPoint(pixelToHIP(pixelValue));\n};\n\nexport const pointToPixel = (pointValue) => {\n  return HIPToPixel(pointToHIP(pointValue));\n};\n\nexport const EIPToPoint = (EIPValue) => {\n  return Math.round(EIPValue / 8);\n};\n\nexport const pointToEIP = (PointValue) => {\n  return Math.round(PointValue * 8);\n};\n\nexport const pixelToEIP = (pixelValue) => {\n  return pointToEIP(pixelToPoint(pixelValue));\n};\n\nexport const EIPToPixel = (EIPValue) => {\n  return pointToPixel(EIPToPoint(EIPValue));\n};\n","/* eslint-disable radix */\n/* eslint-disable no-param-reassign */\n/* eslint-disable no-case-declarations */\n/* eslint-disable no-plusplus */\n/* eslint-disable no-else-return */\nimport { fragment } from 'xmlbuilder2';\nimport isVNode from 'virtual-dom/vnode/is-vnode';\nimport isVText from 'virtual-dom/vnode/is-vtext';\nimport colorNames from 'color-name';\n\n// eslint-disable-next-line import/no-named-default\nimport namespaces from './namespaces';\nimport {\n  rgbToHex,\n  hslToHex,\n  hslRegex,\n  rgbRegex,\n  hexRegex,\n  hex3Regex,\n  hex3ToHex,\n} from '../utils/color-conversion';\nimport {\n  pixelToEMU,\n  pixelRegex,\n  TWIPToEMU,\n  percentageRegex,\n  pointRegex,\n  pointToHIP,\n  HIPToTWIP,\n  pointToTWIP,\n  pixelToHIP,\n  pixelToTWIP,\n  pixelToEIP,\n  pointToEIP,\n} from '../utils/unit-conversion';\nimport sizeOf from 'image-size';\n\n// eslint-disable-next-line consistent-return\nconst fixupColorCode = (colorCodeString) => {\n  if (Object.prototype.hasOwnProperty.call(colorNames, colorCodeString.toLowerCase())) {\n    const [red, green, blue] = colorNames[colorCodeString.toLowerCase()];\n\n    return rgbToHex(red, green, blue);\n  } else if (rgbRegex.test(colorCodeString)) {\n    const matchedParts = colorCodeString.match(rgbRegex);\n    const red = matchedParts[1];\n    const green = matchedParts[2];\n    const blue = matchedParts[3];\n\n    return rgbToHex(red, green, blue);\n  } else if (hslRegex.test(colorCodeString)) {\n    const matchedParts = colorCodeString.match(hslRegex);\n    const hue = matchedParts[1];\n    const saturation = matchedParts[2];\n    const luminosity = matchedParts[3];\n\n    return hslToHex(hue, saturation, luminosity);\n  } else if (hexRegex.test(colorCodeString)) {\n    const matchedParts = colorCodeString.match(hexRegex);\n\n    return matchedParts[1];\n  } else if (hex3Regex.test(colorCodeString)) {\n    const matchedParts = colorCodeString.match(hex3Regex);\n    const red = matchedParts[1];\n    const green = matchedParts[2];\n    const blue = matchedParts[3];\n\n    return hex3ToHex(red, green, blue);\n  } else {\n    return '000000';\n  }\n};\n\nconst buildRunStyleFragment = (type = 'Hyperlink') => {\n  const runStyleFragment = fragment({\n    namespaceAlias: { w: namespaces.w },\n  })\n    .ele('@w', 'rStyle')\n    .att('@w', 'val', type)\n    .up();\n\n  return runStyleFragment;\n};\n\nconst buildTableRowHeight = (tableRowHeight) => {\n  const tableRowHeightFragment = fragment({\n    namespaceAlias: { w: namespaces.w },\n  })\n    .ele('@w', 'trHeight')\n    .att('@w', 'val', tableRowHeight)\n    .att('@w', 'hRule', 'atLeast')\n    .up();\n\n  return tableRowHeightFragment;\n};\n\nconst buildVerticalAlignment = (verticalAlignment) => {\n  if (verticalAlignment.toLowerCase() === 'middle') {\n    verticalAlignment = 'center';\n  }\n\n  const verticalAlignmentFragment = fragment({\n    namespaceAlias: { w: namespaces.w },\n  })\n    .ele('@w', 'vAlign')\n    .att('@w', 'val', verticalAlignment)\n    .up();\n\n  return verticalAlignmentFragment;\n};\n\nconst buildVerticalMerge = (verticalMerge = 'continue') => {\n  const verticalMergeFragment = fragment({\n    namespaceAlias: { w: namespaces.w },\n  })\n    .ele('@w', 'vMerge')\n    .att('@w', 'val', verticalMerge)\n    .up();\n\n  return verticalMergeFragment;\n};\n\nconst buildColor = (colorCode) => {\n  const colorFragment = fragment({\n    namespaceAlias: { w: namespaces.w },\n  })\n    .ele('@w', 'color')\n    .att('@w', 'val', colorCode)\n    .up();\n\n  return colorFragment;\n};\n\nconst buildFontSize = (fontSize) => {\n  const fontSizeFragment = fragment({\n    namespaceAlias: { w: namespaces.w },\n  })\n    .ele('@w', 'sz')\n    .att('@w', 'val', fontSize)\n    .up();\n\n  return fontSizeFragment;\n};\n\nconst buildShading = (colorCode) => {\n  const shadingFragment = fragment({\n    namespaceAlias: { w: namespaces.w },\n  })\n    .ele('@w', 'shd')\n    .att('@w', 'val', 'clear')\n    .att('@w', 'fill', colorCode)\n    .up();\n\n  return shadingFragment;\n};\n\nconst buildHighlight = (color = 'yellow') => {\n  const highlightFragment = fragment({\n    namespaceAlias: { w: namespaces.w },\n  })\n    .ele('@w', 'highlight')\n    .att('@w', 'val', color)\n    .up();\n\n  return highlightFragment;\n};\n\nconst buildVertAlign = (type = 'baseline') => {\n  const vertAlignFragment = fragment({\n    namespaceAlias: { w: namespaces.w },\n  })\n    .ele('@w', 'vertAlign')\n    .att('@w', 'val', type)\n    .up();\n\n  return vertAlignFragment;\n};\n\nconst buildStrike = () => {\n  const strikeFragment = fragment({\n    namespaceAlias: { w: namespaces.w },\n  })\n    .ele('@w', 'strike')\n    .att('@w', 'val', true)\n    .up();\n\n  return strikeFragment;\n};\n\nconst buildBold = () => {\n  const boldFragment = fragment({\n    namespaceAlias: { w: namespaces.w },\n  })\n    .ele('@w', 'b')\n    .up();\n\n  return boldFragment;\n};\n\nconst buildItalics = () => {\n  const italicsFragment = fragment({\n    namespaceAlias: { w: namespaces.w },\n  })\n    .ele('@w', 'i')\n    .up();\n\n  return italicsFragment;\n};\n\nconst buildUnderline = (type = 'single') => {\n  const underlineFragment = fragment({\n    namespaceAlias: { w: namespaces.w },\n  })\n    .ele('@w', 'u')\n    .att('@w', 'val', type)\n    .up();\n\n  return underlineFragment;\n};\n\nconst buildLineBreak = (type = 'textWrapping') => {\n  const lineBreakFragment = fragment({\n    namespaceAlias: { w: namespaces.w },\n  })\n    .ele('@w', 'br')\n    .att('@w', 'type', type)\n    .up();\n\n  return lineBreakFragment;\n};\n\nconst buildBorder = (\n  borderSide = 'top',\n  borderSize = 0,\n  borderSpacing = 0,\n  borderColor = fixupColorCode('black'),\n  borderStroke = 'single'\n) => {\n  const borderFragment = fragment({\n    namespaceAlias: { w: namespaces.w },\n  })\n    .ele('@w', borderSide)\n    .att('@w', 'val', borderStroke)\n    .att('@w', 'sz', borderSize)\n    .att('@w', 'space', borderSpacing)\n    .att('@w', 'color', borderColor)\n    .up();\n\n  return borderFragment;\n};\n\nconst buildTextElement = (text) => {\n  const textFragment = fragment({\n    namespaceAlias: { w: namespaces.w },\n  })\n    .ele('@w', 't')\n    .att('@xml', 'space', 'preserve')\n    .txt(text)\n    .up();\n\n  return textFragment;\n};\n\nconst buildRunProperties = (attributes) => {\n  const runPropertiesFragment = fragment({\n    namespaceAlias: { w: namespaces.w },\n  }).ele('@w', 'rPr');\n  if (attributes && attributes.constructor === Object) {\n    Object.keys(attributes).forEach((key) => {\n      // eslint-disable-next-line default-case\n      switch (key) {\n        case 'strong':\n          const boldFragment = buildBold();\n          runPropertiesFragment.import(boldFragment);\n          break;\n        case 'i':\n          const italicsFragment = buildItalics();\n          runPropertiesFragment.import(italicsFragment);\n          break;\n        case 'u':\n          const underlineFragment = buildUnderline();\n          runPropertiesFragment.import(underlineFragment);\n          break;\n        case 'color':\n          const colorFragment = buildColor(attributes[key]);\n          runPropertiesFragment.import(colorFragment);\n          break;\n        case 'backgroundColor':\n          const shadingFragment = buildShading(attributes[key]);\n          runPropertiesFragment.import(shadingFragment);\n          break;\n        case 'fontSize':\n          const fontSizeFragment = buildFontSize(attributes[key]);\n          runPropertiesFragment.import(fontSizeFragment);\n          break;\n        case 'hyperlink':\n          const hyperlinkStyleFragment = buildRunStyleFragment('Hyperlink');\n          runPropertiesFragment.import(hyperlinkStyleFragment);\n          break;\n      }\n    });\n  }\n  runPropertiesFragment.up();\n\n  return runPropertiesFragment;\n};\n\n// eslint-disable-next-line consistent-return\nconst buildTextFormatting = (vNode) => {\n  // eslint-disable-next-line default-case\n  switch (vNode.tagName) {\n    case 'strong':\n    case 'b':\n      const boldFragment = buildBold();\n      return boldFragment;\n    case 'em':\n    case 'i':\n      const italicsFragment = buildItalics();\n      return italicsFragment;\n    case 'ins':\n    case 'u':\n      const underlineFragment = buildUnderline();\n      return underlineFragment;\n    case 'strike':\n    case 'del':\n    case 's':\n      const strikeFragment = buildStrike();\n      return strikeFragment;\n    case 'sub':\n      const subscriptFragment = buildVertAlign('subscript');\n      return subscriptFragment;\n    case 'sup':\n      const superscriptFragment = buildVertAlign('superscript');\n      return superscriptFragment;\n    case 'mark':\n      const highlightFragment = buildHighlight();\n      return highlightFragment;\n  }\n};\n\n\n\n// eslint-disable-next-line consistent-return\nconst fixupLineHeight = (lineHeight, fontSize) => {\n  // FIXME: If line height is anything other than a number\n  // eslint-disable-next-line no-restricted-globals\n  if (!isNaN(lineHeight)) {\n    if (fontSize) {\n      const actualLineHeight = +lineHeight * fontSize;\n\n      return HIPToTWIP(actualLineHeight);\n    } else {\n      // 240 TWIP or 12 point is default line height\n      return +lineHeight * 240;\n    }\n  } else {\n    // 240 TWIP or 12 point is default line height\n    return 240;\n  }\n};\n\n// eslint-disable-next-line consistent-return\nconst fixupFontSize = (fontSizeString) => {\n  if (pointRegex.test(fontSizeString)) {\n    const matchedParts = fontSizeString.match(pointRegex);\n    // convert point to half point\n    return pointToHIP(matchedParts[1]);\n  } else if (pixelRegex.test(fontSizeString)) {\n    const matchedParts = fontSizeString.match(pixelRegex);\n    // convert pixels to half point\n    return pixelToHIP(matchedParts[1]);\n  }\n};\n\n// eslint-disable-next-line consistent-return\nconst fixupRowHeight = (rowHeightString) => {\n  if (pointRegex.test(rowHeightString)) {\n    const matchedParts = rowHeightString.match(pointRegex);\n    // convert point to half point\n    return pointToTWIP(matchedParts[1]);\n  } else if (pixelRegex.test(rowHeightString)) {\n    const matchedParts = rowHeightString.match(pixelRegex);\n    // convert pixels to half point\n    return pixelToTWIP(matchedParts[1]);\n  }\n};\n\n\n\n\n\nconst buildNumberingProperties = (levelId, numberingId) => {\n  const numberingPropertiesFragment = fragment({\n    namespaceAlias: { w: namespaces.w },\n  })\n    .ele('@w', 'numPr')\n    .ele('@w', 'ilvl')\n    .att('@w', 'val', String(levelId))\n    .up()\n    .ele('@w', 'numId')\n    .att('@w', 'val', String(numberingId))\n    .up()\n    .up();\n\n  return numberingPropertiesFragment;\n};\n\nconst buildNumberingInstances = () => {\n  const numberingInstancesFragment = fragment({\n    namespaceAlias: { w: namespaces.w },\n  })\n    .ele('@w', 'num')\n    .ele('@w', 'abstractNumId')\n    .up()\n    .up();\n\n  return numberingInstancesFragment;\n};\n\nconst buildSpacing = (lineSpacing, beforeSpacing, afterSpacing) => {\n  const spacingFragment = fragment({\n    namespaceAlias: { w: namespaces.w },\n  }).ele('@w', 'spacing');\n\n  if (lineSpacing) {\n    spacingFragment.att('@w', 'line', lineSpacing);\n  }\n  if (beforeSpacing) {\n    spacingFragment.att('@w', 'before', beforeSpacing);\n  }\n  if (afterSpacing) {\n    spacingFragment.att('@w', 'after', afterSpacing);\n  }\n\n  spacingFragment.att('@w', 'lineRule', 'exact').up();\n\n  return spacingFragment;\n};\n\nconst buildIndentation = (left = 720) => {\n  const indentationFragment = fragment({\n    namespaceAlias: { w: namespaces.w },\n  })\n    .ele('@w', 'ind')\n    .att('@w', 'left', left)\n    .up();\n\n  return indentationFragment;\n};\n\nconst buildPStyle = (style = 'Normal') => {\n  const pStyleFragment = fragment({\n    namespaceAlias: { w: namespaces.w },\n  })\n    .ele('@w', 'pStyle')\n    .att('@w', 'val', style)\n    .up();\n\n  return pStyleFragment;\n};\n\nconst buildHorizontalAlignment = (horizontalAlignment) => {\n  if (horizontalAlignment === 'justify') {\n    horizontalAlignment = 'both';\n  }\n  const horizontalAlignmentFragment = fragment({\n    namespaceAlias: { w: namespaces.w },\n  })\n    .ele('@w', 'jc')\n    .att('@w', 'val', horizontalAlignment)\n    .up();\n\n  return horizontalAlignmentFragment;\n};\n\nconst buildParagraphBorder = () => {\n  const paragraphBorderFragment = fragment({\n    namespaceAlias: { w: namespaces.w },\n  }).ele('@w', 'pBdr');\n  const bordersObject = {\n    top: {\n      size: 0,\n      spacing: 3,\n      color: 'FFFFFF',\n    },\n    left: {\n      size: 0,\n      spacing: 3,\n      color: 'FFFFFF',\n    },\n    bottom: {\n      size: 0,\n      spacing: 3,\n      color: 'FFFFFF',\n    },\n    right: {\n      size: 0,\n      spacing: 3,\n      color: 'FFFFFF',\n    },\n  };\n\n  Object.keys(bordersObject).forEach((borderName) => {\n    if (bordersObject[borderName]) {\n      const { size, spacing, color } = bordersObject[borderName];\n\n      const borderFragment = buildBorder(borderName, size, spacing, color);\n      paragraphBorderFragment.import(borderFragment);\n    }\n  });\n\n  paragraphBorderFragment.up();\n\n  return paragraphBorderFragment;\n};\n\nconst buildParagraphProperties = (attributes) => {\n  const paragraphPropertiesFragment = fragment({\n    namespaceAlias: { w: namespaces.w },\n  }).ele('@w', 'pPr');\n  if (attributes && attributes.constructor === Object) {\n    Object.keys(attributes).forEach((key) => {\n      // eslint-disable-next-line default-case\n      switch (key) {\n        case 'numbering':\n          const { levelId, numberingId } = attributes[key];\n          const numberingPropertiesFragment = buildNumberingProperties(levelId, numberingId);\n          paragraphPropertiesFragment.import(numberingPropertiesFragment);\n          // Delete used property\n          // eslint-disable-next-line no-param-reassign\n          delete attributes.numbering;\n          break;\n        case 'textAlign':\n          const horizontalAlignmentFragment = buildHorizontalAlignment(attributes[key]);\n          paragraphPropertiesFragment.import(horizontalAlignmentFragment);\n          // Delete used property\n          // eslint-disable-next-line no-param-reassign\n          delete attributes.textAlign;\n          break;\n        case 'backgroundColor':\n          // Add shading to Paragraph Properties only if display is block\n          // Essentially if background color needs to be across the row\n          if (attributes.display === 'block') {\n            const shadingFragment = buildShading(attributes[key]);\n            paragraphPropertiesFragment.import(shadingFragment);\n            // FIXME: Inner padding in case of shaded paragraphs.\n            const paragraphBorderFragment = buildParagraphBorder();\n            paragraphPropertiesFragment.import(paragraphBorderFragment);\n            // Delete used property\n            // eslint-disable-next-line no-param-reassign\n            delete attributes.backgroundColor;\n          }\n          break;\n        case 'paragraphStyle':\n          const pStyleFragment = buildPStyle(attributes.paragraphStyle);\n          paragraphPropertiesFragment.import(pStyleFragment);\n          delete attributes.paragraphStyle;\n          break;\n        case 'indentation':\n          const indentationFragment = buildIndentation(attributes[key].left);\n          paragraphPropertiesFragment.import(indentationFragment);\n          // Delete used property\n          // eslint-disable-next-line no-param-reassign\n          delete attributes.indentation;\n          break;\n      }\n    });\n\n    const spacingFragment = buildSpacing(\n      attributes.lineHeight,\n      attributes.beforeSpacing,\n      attributes.afterSpacing\n    );\n    // Delete used properties\n    // eslint-disable-next-line no-param-reassign\n    delete attributes.lineHeight;\n    // eslint-disable-next-line no-param-reassign\n    delete attributes.beforeSpacing;\n    // eslint-disable-next-line no-param-reassign\n    delete attributes.afterSpacing;\n\n    paragraphPropertiesFragment.import(spacingFragment);\n  }\n  paragraphPropertiesFragment.up();\n\n  return paragraphPropertiesFragment;\n};\n\nconst computeImageDimensions = (vNode, attributes) => {\n  const { maximumWidth, originalWidth, originalHeight } = attributes;\n  const aspectRatio = originalWidth / originalHeight;\n  const maximumWidthInEMU = TWIPToEMU(maximumWidth);\n  let originalWidthInEMU = pixelToEMU(originalWidth);\n  let originalHeightInEMU = pixelToEMU(originalHeight);\n  if (originalWidthInEMU > maximumWidthInEMU) {\n    originalWidthInEMU = maximumWidthInEMU;\n    originalHeightInEMU = Math.round(originalWidthInEMU / aspectRatio);\n  }\n  let modifiedHeight;\n  let modifiedWidth;\n\n  if (vNode.properties && vNode.properties.style) {\n    if (vNode.properties.style.width) {\n      if (vNode.properties.style.width !== 'auto') {\n        if (pixelRegex.test(vNode.properties.style.width)) {\n          modifiedWidth = pixelToEMU(vNode.properties.style.width.match(pixelRegex)[1]);\n        } else if (percentageRegex.test(vNode.properties.style.width)) {\n          const percentageValue = vNode.properties.style.width.match(percentageRegex)[1];\n\n          modifiedWidth = Math.round((percentageValue / 100) * originalWidthInEMU);\n        }\n      } else {\n        // eslint-disable-next-line no-lonely-if\n        if (vNode.properties.style.height && vNode.properties.style.height === 'auto') {\n          modifiedWidth = originalWidthInEMU;\n          modifiedHeight = originalHeightInEMU;\n        }\n      }\n    }\n    if (vNode.properties.style.height) {\n      if (vNode.properties.style.height !== 'auto') {\n        if (pixelRegex.test(vNode.properties.style.height)) {\n          modifiedHeight = pixelToEMU(vNode.properties.style.height.match(pixelRegex)[1]);\n        } else if (percentageRegex.test(vNode.properties.style.height)) {\n          const percentageValue = vNode.properties.style.width.match(percentageRegex)[1];\n\n          modifiedHeight = Math.round((percentageValue / 100) * originalHeightInEMU);\n          if (!modifiedWidth) {\n            modifiedWidth = Math.round(modifiedHeight * aspectRatio);\n          }\n        }\n      } else {\n        // eslint-disable-next-line no-lonely-if\n        if (modifiedWidth) {\n          if (!modifiedHeight) {\n            modifiedHeight = Math.round(modifiedWidth / aspectRatio);\n          }\n        } else {\n          modifiedHeight = originalHeightInEMU;\n          modifiedWidth = originalWidthInEMU;\n        }\n      }\n    }\n    if (modifiedWidth && !modifiedHeight) {\n      modifiedHeight = Math.round(modifiedWidth / aspectRatio);\n    } else if (modifiedHeight && !modifiedWidth) {\n      modifiedWidth = Math.round(modifiedHeight * aspectRatio);\n    }\n  } else {\n    modifiedWidth = originalWidthInEMU;\n    modifiedHeight = originalHeightInEMU;\n  }\n\n  // eslint-disable-next-line no-param-reassign\n  attributes.width = modifiedWidth;\n  // eslint-disable-next-line no-param-reassign\n  attributes.height = modifiedHeight;\n};\n\n// -----\nexport const buildImage = (docxDocumentInstance, vNode, maximumWidth = null) => {\n  let response = null;\n  try {\n    // libtidy encodes the image src\n    response = docxDocumentInstance.createMediaFile(decodeURIComponent(vNode.properties.src));\n  } catch (error) {\n    return null;\n  }\n  if (response) {\n    docxDocumentInstance.zip\n      .folder('word')\n      .folder('media')\n      .file(response.fileNameWithExtension, Buffer.from(response.fileContent, 'base64'), {\n        createFolders: false,\n      });\n\n    const documentRelsId = docxDocumentInstance.createDocumentRelationships(\n      docxDocumentInstance.relationshipFilename,\n      'image',\n      `media/${response.fileNameWithExtension}`,\n      'Internal'\n    );\n    const imageBuffer = Buffer.from(response.fileContent, 'base64');\n    const imageProperties = sizeOf(imageBuffer);\n    return {\n      type: 'picture',\n      inlineOrAnchored: true,\n      relationshipId: documentRelsId,\n      ...response,\n      maximumWidth: maximumWidth || docxDocumentInstance.availableDocumentSpace,\n      originalWidth: imageProperties.width,\n      originalHeight: imageProperties.height,\n    }\n  }\n  return null;\n};\n\nconst addTo = (fragments, parentFragment) => {\n  if (Array.isArray(fragments)) {\n    for(let item of fragments) {\n      addTo(item, parentFragment);\n    }\n  } else {\n    parentFragment.import(fragments);\n  }\n} \n\n/**\n * Read and add attributes to existing attributes from a node\n * @param {VNode} vNode - Virtual node\n * @param {any} attributes - attritbutes carried over from parent\n */\nconst getModifiedAttributes = (vNode, attributes) => {\n  const modifiedAttributes = { ...attributes };\n  if (isVNode(vNode) && vNode.properties && vNode.properties.style) {\n    if (\n      vNode.properties.style.color &&\n      !['transparent', 'auto'].includes(vNode.properties.style.color)\n    ) {\n      modifiedAttributes.color = fixupColorCode(vNode.properties.style.color);\n    }\n    if (\n      vNode.properties.style['background-color'] &&\n      !['transparent', 'auto'].includes(vNode.properties.style['background-color'])\n    ) {\n      modifiedAttributes.backgroundColor = fixupColorCode(\n        vNode.properties.style['background-color']\n      );\n    }\n    if (\n      vNode.properties.style['vertical-align'] &&\n      ['top', 'middle', 'bottom'].includes(vNode.properties.style['vertical-align'])\n    ) {\n      modifiedAttributes.verticalAlign = vNode.properties.style['vertical-align'];\n    }\n    if (\n      vNode.properties.style['text-align'] &&\n      ['left', 'right', 'center', 'justify'].includes(vNode.properties.style['text-align'])\n    ) {\n      modifiedAttributes.textAlign = vNode.properties.style['text-align'];\n    }\n    // FIXME: remove bold check when other font weights are handled.\n    if (vNode.properties.style['font-weight'] && vNode.properties.style['font-weight'] === 'bold') {\n      modifiedAttributes.strong = vNode.properties.style['font-weight'];\n    }\n    if (vNode.properties.style['font-size']) {\n      modifiedAttributes.fontSize = fixupFontSize(vNode.properties.style['font-size']);\n    }\n    if (vNode.properties.style['line-height']) {\n      modifiedAttributes.lineHeight = fixupLineHeight(\n        vNode.properties.style['line-height'],\n        vNode.properties.style['font-size']\n          ? fixupFontSize(vNode.properties.style['font-size'])\n          : null\n      );\n    }\n    if (vNode.properties.style.display) {\n      modifiedAttributes.display = vNode.properties.style.display;\n    }\n  }\n  if (isVNode(vNode) && vNode.tagName === 'blockquote') {\n    modifiedAttributes.indentation = { left: 284 };\n    modifiedAttributes.textAlign = 'justify';\n  }\n  return modifiedAttributes;\n}\n\nconst getRunFragment = (vNode, attributes, withProp) => {\n  const runFragment = fragment({\n    namespaceAlias: { w: namespaces.w },\n  }).ele('@w', 'r');\n  if(withProp) {\n    const runPropertiesFragment = buildRunProperties(getModifiedAttributes(vNode, attributes));\n    runFragment.import(runPropertiesFragment);\n  }\n  return runFragment;\n}\n\n\n\nconst buildNestedTextChildrens = (runFragment, vNode, attributes, textEls) => {\n  if(vNode.children && vNode.children.length) {\n    for(const childVNode of vNode.children) {\n      if(isVText(childVNode)) {\n        runFragment.import(buildTextElement(childVNode.text));\n      }else {\n        runFragment.import(buildNestedText(childVNode, attributes, textEls))\n      }\n    }\n  }\n}\n\n/**\n * Build a nested text fragment\n * @param {VNode} vNode - Virtual node\n * @param {any} attributes - attritbutes carried over from parent\n * @param {[string]} textEls - Supported text elements\n */\nconst buildNestedText = (vNode, attributes, textEls) => {\n  let modifiedAttributes = getModifiedAttributes(vNode, attributes);\n  let runFragment = getRunFragment(vNode, modifiedAttributes, false);\n  if(vNode.children.length === 1) {\n    let tempNode = vNode;\n    const formats = [];\n    while(isVNode(tempNode) && tempNode.children.length === 1) {\n      if(textEls.includes(tempNode.tagName)) formats.push(buildTextFormatting(tempNode));\n      tempNode = tempNode.children[0];\n      modifiedAttributes = getModifiedAttributes(tempNode, modifiedAttributes);\n    }\n    const runPropertiesFragment = buildRunProperties(modifiedAttributes);\n    if(isVText(tempNode)) {\n      formats.forEach(format=>runPropertiesFragment.import(format));\n      runFragment.import(runPropertiesFragment);\n      runFragment.import(buildTextElement(tempNode.text));\n    } else {\n      if(textEls.includes(tempNode.tagName)) formats.push(buildTextFormatting(tempNode));\n      formats.forEach(format=>runPropertiesFragment.import(format));\n      runFragment.import(runPropertiesFragment);\n      buildNestedTextChildrens(runFragment, tempNode, modifiedAttributes, textEls);\n    }\n  } else {\n    if(textEls.includes(vNode.tagName)) {\n      const format = buildTextFormatting(vNode);\n      const runPropertiesFragment = buildRunProperties(modifiedAttributes);\n      runPropertiesFragment.import(format);\n      runFragment.import(runPropertiesFragment);\n    }\n    buildNestedTextChildrens(runFragment, vNode, modifiedAttributes, textEls);\n  }\n  runFragment.up()\n  return runFragment;\n}\n\nconst hyperLinkFragment = (vNode, docxDocumentInstance) => {\n  const relationshipId = docxDocumentInstance.createDocumentRelationships(\n    docxDocumentInstance.relationshipFilename,\n    'hyperlink',\n    vNode.properties && vNode.properties.href ? vNode.properties.href : ''\n  );\n  \n  return fragment({\n    namespaceAlias: { w: namespaces.w, r: namespaces.r },\n  })\n    .ele('@w', 'hyperlink')\n    .att('@r', 'id', `rId${relationshipId}`);\n}\n\n/**\n * Build a fragment/fragments from a nested node\n * @param {VNode} vNode - Virtual node\n * @param {any} attributes - attritbutes carried over from parent\n * @param {DocxDocument} docxDocumentInstance - document instance\n */\nconst buildNested = (vNode, attributes, docxDocumentInstance) => {\n  const textEls = ['strong', 'b', 'em', 'i', 'u', 'ins', 'strike', 'del', 's', 'sub', 'sup', 'mark'];\n  let modifiedAttributes = getModifiedAttributes(vNode, attributes);\n  let runFragment = null;\n  \n  if(isVText(vNode)) {\n    runFragment = getRunFragment(vNode, modifiedAttributes, true);\n    runFragment.import(buildTextElement(vNode.text));\n  } else if(isVNode(vNode)) {\n    if(vNode.tagName === 'a') {\n      runFragment = hyperLinkFragment(vNode, docxDocumentInstance);\n      modifiedAttributes.hyperlink = true;\n    } else if (vNode.tagName === 'br') {\n      return buildLineBreak();\n    } else if(textEls.includes(vNode.tagName)) {\n\n      return buildNestedText(vNode, modifiedAttributes, textEls);\n    } \n    else if (vNode.tagName === 'img') {\n      const result = buildImage(docxDocumentInstance, vNode);\n      if(result) {\n        modifiedAttributes = {...modifiedAttributes, ...result};\n        computeImageDimensions(vNode, modifiedAttributes);\n        const { type, inlineOrAnchored, ...otherAttributes } = modifiedAttributes;\n        runFragment = getRunFragment(vNode, modifiedAttributes, true);\n        runFragment.import(buildDrawing(inlineOrAnchored, type, otherAttributes));\n      }\n    }\n\n    if(runFragment) {\n      for(const childVNode of vNode.children) {\n        addTo(buildNested(childVNode, modifiedAttributes, docxDocumentInstance), runFragment);\n      }\n    } else {\n      const runFragments = [];\n      for(const childVNode of vNode.children) {\n        runFragments.push(buildNested(childVNode, modifiedAttributes, docxDocumentInstance));\n      }\n      return runFragments;\n    }\n  } else {\n    return [];\n  }\n\n  runFragment.up();\n  return runFragment;\n}\n\nconst buildParagraph = (vNode, attributes, docxDocumentInstance) => {\n  const paragraphFragment = fragment({\n    namespaceAlias: { w: namespaces.w },\n  }).ele('@w', 'p');\n  const modifiedAttributes = getModifiedAttributes(vNode, attributes);\n  const paragraphPropertiesFragment = buildParagraphProperties(modifiedAttributes);\n  paragraphFragment.import(paragraphPropertiesFragment);\n  addTo(buildNested(vNode, attributes, docxDocumentInstance), paragraphFragment);\n  paragraphFragment.up();\n  return paragraphFragment;\n\n}\n\n// --\n\n\n\nconst buildGridSpanFragment = (spanValue) => {\n  const gridSpanFragment = fragment({\n    namespaceAlias: { w: namespaces.w },\n  })\n    .ele('@w', 'gridSpan')\n    .att('@w', 'val', spanValue)\n    .up();\n\n  return gridSpanFragment;\n};\n\nconst buildTableCellSpacing = (cellSpacing = 0) => {\n  const tableCellSpacingFragment = fragment({\n    namespaceAlias: { w: namespaces.w },\n  })\n    .ele('@w', 'tblCellSpacing')\n    .att('@w', 'w', cellSpacing)\n    .att('@w', 'type', 'dxa')\n    .up();\n\n  return tableCellSpacingFragment;\n};\n\nconst buildTableCellBorders = (tableCellBorder) => {\n  const tableCellBordersFragment = fragment({\n    namespaceAlias: { w: namespaces.w },\n  }).ele('@w', 'tcBorders');\n\n  const { color, stroke, ...borders } = tableCellBorder;\n  Object.keys(borders).forEach((border) => {\n    if (tableCellBorder[border]) {\n      const borderFragment = buildBorder(border, tableCellBorder[border], 0, color, stroke);\n      tableCellBordersFragment.import(borderFragment);\n    }\n  });\n\n  tableCellBordersFragment.up();\n\n  return tableCellBordersFragment;\n};\n\nconst buildTableCellProperties = (attributes) => {\n  const tableCellPropertiesFragment = fragment({\n    namespaceAlias: { w: namespaces.w },\n  }).ele('@w', 'tcPr');\n  if (attributes && attributes.constructor === Object) {\n    Object.keys(attributes).forEach((key) => {\n      // eslint-disable-next-line default-case\n      switch (key) {\n        case 'backgroundColor':\n          const shadingFragment = buildShading(attributes[key]);\n          tableCellPropertiesFragment.import(shadingFragment);\n          // Delete used property\n          // eslint-disable-next-line no-param-reassign\n          delete attributes.backgroundColor;\n          break;\n        case 'verticalAlign':\n          const verticalAlignmentFragment = buildVerticalAlignment(attributes[key]);\n          tableCellPropertiesFragment.import(verticalAlignmentFragment);\n          // Delete used property\n          // eslint-disable-next-line no-param-reassign\n          delete attributes.verticalAlign;\n          break;\n        case 'colSpan':\n          const gridSpanFragment = buildGridSpanFragment(attributes[key]);\n          tableCellPropertiesFragment.import(gridSpanFragment);\n          // Delete used property\n          // eslint-disable-next-line no-param-reassign\n          delete attributes.colSpan;\n          break;\n        case 'tableCellBorder':\n          const tableCellBorderFragment = buildTableCellBorders(attributes[key]);\n          tableCellPropertiesFragment.import(tableCellBorderFragment);\n\n          // Delete used property\n          // eslint-disable-next-line no-param-reassign\n          delete attributes.tableCellBorder;\n          break;\n        case 'rowSpan':\n          const verticalMergeFragment = buildVerticalMerge(attributes[key]);\n          tableCellPropertiesFragment.import(verticalMergeFragment);\n\n          delete attributes.rowSpan;\n          break;\n      }\n    });\n  }\n  tableCellPropertiesFragment.up();\n\n  return tableCellPropertiesFragment;\n};\n\nconst fixupTableCellBorder = (vNode, attributes) => {\n  if (Object.prototype.hasOwnProperty.call(vNode.properties.style, 'border')) {\n    if (vNode.properties.style.border === 'none' || vNode.properties.style.border === 0) {\n      attributes.tableCellBorder = {};\n    } else {\n      // eslint-disable-next-line no-use-before-define\n      const [borderSize, borderStroke, borderColor] = cssBorderParser(\n        vNode.properties.style.border\n      );\n\n      attributes.tableCellBorder = {\n        top: borderSize,\n        left: borderSize,\n        bottom: borderSize,\n        right: borderSize,\n        color: borderColor,\n        stroke: borderStroke,\n      };\n    }\n  }\n  if (vNode.properties.style['border-top'] && vNode.properties.style['border-top'] === '0') {\n    attributes.tableCellBorder = {\n      ...attributes.tableCellBorder,\n      top: 0,\n    };\n  } else if (vNode.properties.style['border-top'] && vNode.properties.style['border-top'] !== '0') {\n    // eslint-disable-next-line no-use-before-define\n    const [borderSize, borderStroke, borderColor] = cssBorderParser(\n      vNode.properties.style['border-top']\n    );\n    attributes.tableCellBorder = {\n      ...attributes.tableCellBorder,\n      top: borderSize,\n      color: borderColor,\n      stroke: borderStroke,\n    };\n  }\n  if (vNode.properties.style['border-left'] && vNode.properties.style['border-left'] === '0') {\n    attributes.tableCellBorder = {\n      ...attributes.tableCellBorder,\n      left: 0,\n    };\n  } else if (\n    vNode.properties.style['border-left'] &&\n    vNode.properties.style['border-left'] !== '0'\n  ) {\n    // eslint-disable-next-line no-use-before-define\n    const [borderSize, borderStroke, borderColor] = cssBorderParser(\n      vNode.properties.style['border-left']\n    );\n    attributes.tableCellBorder = {\n      ...attributes.tableCellBorder,\n      left: borderSize,\n      color: borderColor,\n      stroke: borderStroke,\n    };\n  }\n  if (vNode.properties.style['border-bottom'] && vNode.properties.style['border-bottom'] === '0') {\n    attributes.tableCellBorder = {\n      ...attributes.tableCellBorder,\n      bottom: 0,\n    };\n  } else if (\n    vNode.properties.style['border-bottom'] &&\n    vNode.properties.style['border-bottom'] !== '0'\n  ) {\n    // eslint-disable-next-line no-use-before-define\n    const [borderSize, borderStroke, borderColor] = cssBorderParser(\n      vNode.properties.style['border-bottom']\n    );\n    attributes.tableCellBorder = {\n      ...attributes.tableCellBorder,\n      bottom: borderSize,\n      color: borderColor,\n      stroke: borderStroke,\n    };\n  }\n  if (vNode.properties.style['border-right'] && vNode.properties.style['border-right'] === '0') {\n    attributes.tableCellBorder = {\n      ...attributes.tableCellBorder,\n      right: 0,\n    };\n  } else if (\n    vNode.properties.style['border-right'] &&\n    vNode.properties.style['border-right'] !== '0'\n  ) {\n    // eslint-disable-next-line no-use-before-define\n    const [borderSize, borderStroke, borderColor] = cssBorderParser(\n      vNode.properties.style['border-right']\n    );\n    attributes.tableCellBorder = {\n      ...attributes.tableCellBorder,\n      right: borderSize,\n      color: borderColor,\n      stroke: borderStroke,\n    };\n  }\n};\n\nconst buildTableCell = (vNode, attributes, rowSpanMap, columnIndex, docxDocumentInstance) => {\n  const tableCellFragment = fragment({\n    namespaceAlias: { w: namespaces.w },\n  }).ele('@w', 'tc');\n\n  const modifiedAttributes = { ...attributes };\n  if (isVNode(vNode) && vNode.properties) {\n    if (vNode.properties.rowSpan) {\n      rowSpanMap.set(columnIndex.index, { rowSpan: vNode.properties.rowSpan - 1, colSpan: 0 });\n      modifiedAttributes.rowSpan = 'restart';\n    } else {\n      const previousSpanObject = rowSpanMap.get(columnIndex.index);\n      rowSpanMap.set(\n        columnIndex.index,\n        // eslint-disable-next-line prefer-object-spread\n        Object.assign({}, previousSpanObject, {\n          rowSpan: 0,\n          colSpan: (previousSpanObject && previousSpanObject.colSpan) || 0,\n        })\n      );\n    }\n    if (\n      vNode.properties.colSpan ||\n      (vNode.properties.style && vNode.properties.style['column-span'])\n    ) {\n      modifiedAttributes.colSpan =\n        vNode.properties.colSpan ||\n        (vNode.properties.style && vNode.properties.style['column-span']);\n      const previousSpanObject = rowSpanMap.get(columnIndex.index);\n      rowSpanMap.set(\n        columnIndex.index,\n        // eslint-disable-next-line prefer-object-spread\n        Object.assign({}, previousSpanObject, {\n          colSpan: parseInt(modifiedAttributes.colSpan) || 0,\n        })\n      );\n      columnIndex.index += parseInt(modifiedAttributes.colSpan) - 1;\n    }\n    if (vNode.properties.style) {\n      if (\n        vNode.properties.style.color &&\n        !['transparent', 'auto'].includes(vNode.properties.style.color)\n      ) {\n        modifiedAttributes.color = fixupColorCode(vNode.properties.style.color);\n      }\n      if (\n        vNode.properties.style['background-color'] &&\n        !['transparent', 'auto'].includes(vNode.properties.style['background-color'])\n      ) {\n        modifiedAttributes.backgroundColor = fixupColorCode(\n          vNode.properties.style['background-color']\n        );\n      }\n      if (\n        vNode.properties.style['vertical-align'] &&\n        ['top', 'middle', 'bottom'].includes(vNode.properties.style['vertical-align'])\n      ) {\n        modifiedAttributes.verticalAlign = vNode.properties.style['vertical-align'];\n      }\n      fixupTableCellBorder(vNode, modifiedAttributes);\n    }\n  }\n  const tableCellPropertiesFragment = buildTableCellProperties(modifiedAttributes);\n  tableCellFragment.import(tableCellPropertiesFragment);\n  if (vNode.children && Array.isArray(vNode.children) && vNode.children.length) {\n    for (let index = 0; index < vNode.children.length; index++) {\n      const childVNode = vNode.children[index];\n      if (isVNode(childVNode) && childVNode.tagName === 'img') {\n        const result = buildImage(docxDocumentInstance, childVNode, modifiedAttributes.maximumWidth);\n        if(result) {\n          modifiedAttributes = {...modifiedAttributes, ...result};\n          computeImageDimensions(childVNode, modifiedAttributes);\n          const { type, inlineOrAnchored, ...otherAttributes } = modifiedAttributes;\n          tableCellFragment.import(buildDrawing(inlineOrAnchored, type, otherAttributes));\n        }\n      } else if (isVNode(childVNode) && childVNode.tagName === 'figure') {\n        if (\n          childVNode.children &&\n          Array.isArray(childVNode.children) &&\n          childVNode.children.length\n        ) {\n          // eslint-disable-next-line no-plusplus\n          for (let iteratorIndex = 0; iteratorIndex < childVNode.children.length; iteratorIndex++) {\n            const grandChildVNode = childVNode.children[iteratorIndex];\n            if (grandChildVNode.tagName === 'img') {\n              const result = buildImage(docxDocumentInstance, grandChildVNode, modifiedAttributes.maximumWidth);\n              if(result) {\n                modifiedAttributes = {...modifiedAttributes, ...result};\n                computeImageDimensions(grandChildVNode, modifiedAttributes);\n                const { type, inlineOrAnchored, ...otherAttributes } = modifiedAttributes;\n                tableCellFragment.import(buildDrawing(inlineOrAnchored, type, otherAttributes));\n              }\n\n            }\n          }\n        }\n      } else {\n        const paragraphFragment = buildParagraph(\n          childVNode,\n          modifiedAttributes,\n          docxDocumentInstance\n        );\n        tableCellFragment.import(paragraphFragment);\n      }\n    }\n  } else {\n    // TODO: Figure out why building with buildParagraph() isn't working\n    const paragraphFragment = fragment({\n      namespaceAlias: { w: namespaces.w },\n    })\n      .ele('@w', 'p')\n      .up();\n    tableCellFragment.import(paragraphFragment);\n  }\n  tableCellFragment.up();\n\n  return tableCellFragment;\n};\n\nconst buildRowSpanCell = (rowSpanMap, columnIndex, attributes) => {\n  const rowSpanCellFragments = [];\n  let spanObject = rowSpanMap.get(columnIndex.index);\n  while (spanObject && spanObject.rowSpan) {\n    const rowSpanCellFragment = fragment({\n      namespaceAlias: { w: namespaces.w },\n    }).ele('@w', 'tc');\n\n    const tableCellPropertiesFragment = buildTableCellProperties({\n      ...attributes,\n      rowSpan: 'continue',\n      colSpan: spanObject.colSpan ? spanObject.colSpan : 0,\n    });\n    rowSpanCellFragment.import(tableCellPropertiesFragment);\n\n    const paragraphFragment = fragment({\n      namespaceAlias: { w: namespaces.w },\n    })\n      .ele('@w', 'p')\n      .up();\n    rowSpanCellFragment.import(paragraphFragment);\n    rowSpanCellFragment.up();\n\n    rowSpanCellFragments.push(rowSpanCellFragment);\n\n    if (spanObject.rowSpan - 1 === 0) {\n      rowSpanMap.delete(columnIndex.index);\n    } else {\n      rowSpanMap.set(columnIndex.index, {\n        rowSpan: spanObject.rowSpan - 1,\n        colSpan: spanObject.colSpan || 0,\n      });\n    }\n    columnIndex.index += spanObject.colSpan || 1;\n    spanObject = rowSpanMap.get(columnIndex.index);\n  }\n\n  return rowSpanCellFragments;\n};\n\nconst buildTableRowProperties = (attributes) => {\n  const tableRowPropertiesFragment = fragment({\n    namespaceAlias: { w: namespaces.w },\n  }).ele('@w', 'trPr');\n  if (attributes && attributes.constructor === Object) {\n    Object.keys(attributes).forEach((key) => {\n      // eslint-disable-next-line default-case\n      switch (key) {\n        case 'tableRowHeight':\n          const tableRowHeightFragment = buildTableRowHeight(attributes[key]);\n          tableRowPropertiesFragment.import(tableRowHeightFragment);\n          // Delete used property\n          // eslint-disable-next-line no-param-reassign\n          delete attributes.tableRowHeight;\n          break;\n        case 'rowCantSplit':\n          if (attributes.rowCantSplit) {\n            const cantSplitFragment = fragment({\n              namespaceAlias: { w: namespaces.w },\n            })\n              .ele('@w', 'cantSplit')\n              .up();\n            tableRowPropertiesFragment.import(cantSplitFragment);\n            // Delete used property\n            // eslint-disable-next-line no-param-reassign\n            delete attributes.rowCantSplit;\n          }\n          break;\n      }\n    });\n  }\n  tableRowPropertiesFragment.up();\n  return tableRowPropertiesFragment;\n};\n\nconst buildTableRow = (vNode, attributes, rowSpanMap, docxDocumentInstance) => {\n  const tableRowFragment = fragment({\n    namespaceAlias: { w: namespaces.w },\n  }).ele('@w', 'tr');\n  const modifiedAttributes = { ...attributes };\n  if (isVNode(vNode) && vNode.properties) {\n    // FIXME: find a better way to get row height from cell style\n    if (\n      (vNode.properties.style && vNode.properties.style.height) ||\n      (vNode.children[0] &&\n        isVNode(vNode.children[0]) &&\n        vNode.children[0].properties.style &&\n        vNode.children[0].properties.style.height)\n    ) {\n      modifiedAttributes.tableRowHeight = fixupRowHeight(\n        (vNode.properties.style && vNode.properties.style.height) ||\n          (vNode.children[0] &&\n          isVNode(vNode.children[0]) &&\n          vNode.children[0].properties.style &&\n          vNode.children[0].properties.style.height\n            ? vNode.children[0].properties.style.height\n            : undefined)\n      );\n    }\n    if (vNode.properties.style) {\n      fixupTableCellBorder(vNode, modifiedAttributes);\n    }\n  }\n  const tableRowPropertiesFragment = buildTableRowProperties(modifiedAttributes);\n  tableRowFragment.import(tableRowPropertiesFragment);\n\n  const columnIndex = { index: 0 };\n\n  if (vNode.children && Array.isArray(vNode.children) && vNode.children.length) {\n    const tableColumns = vNode.children.filter((childVNode) =>\n      ['td', 'th'].includes(childVNode.tagName)\n    );\n    const columnWidth = docxDocumentInstance.availableDocumentSpace / tableColumns.length;\n\n    for (let index = 0; index < vNode.children.length; index++) {\n      const childVNode = vNode.children[index];\n      if (['td', 'th'].includes(childVNode.tagName)) {\n        const rowSpanCellFragments = buildRowSpanCell(rowSpanMap, columnIndex, modifiedAttributes);\n        if (Array.isArray(rowSpanCellFragments)) {\n          for (\n            let iteratorIndex = 0;\n            iteratorIndex < rowSpanCellFragments.length;\n            iteratorIndex++\n          ) {\n            const rowSpanCellFragment = rowSpanCellFragments[iteratorIndex];\n\n            tableRowFragment.import(rowSpanCellFragment);\n          }\n        }\n        const tableCellFragment = buildTableCell(\n          childVNode,\n          { ...modifiedAttributes, maximumWidth: columnWidth },\n          rowSpanMap,\n          columnIndex,\n          docxDocumentInstance\n        );\n        columnIndex.index++;\n\n        tableRowFragment.import(tableCellFragment);\n      }\n    }\n  }\n  if (columnIndex.index < rowSpanMap.size) {\n    const rowSpanCellFragments = buildRowSpanCell(rowSpanMap, columnIndex, modifiedAttributes);\n    if (Array.isArray(rowSpanCellFragments)) {\n      for (let iteratorIndex = 0; iteratorIndex < rowSpanCellFragments.length; iteratorIndex++) {\n        const rowSpanCellFragment = rowSpanCellFragments[iteratorIndex];\n\n        tableRowFragment.import(rowSpanCellFragment);\n      }\n    }\n  }\n  tableRowFragment.up();\n\n  return tableRowFragment;\n};\n\nconst buildTableGridCol = (gridWidth) => {\n  const tableGridColFragment = fragment({\n    namespaceAlias: { w: namespaces.w },\n  })\n    .ele('@w', 'gridCol')\n    .att('@w', 'w', String(gridWidth));\n\n  return tableGridColFragment;\n};\n\nconst buildTableGrid = (vNode, attributes) => {\n  const tableGridFragment = fragment({\n    namespaceAlias: { w: namespaces.w },\n  }).ele('@w', 'tblGrid');\n  if (vNode.children && Array.isArray(vNode.children) && vNode.children.length) {\n    const gridColumns = vNode.children.filter((childVNode) => childVNode.tagName === 'col');\n    const gridWidth = attributes.maximumWidth / gridColumns.length;\n\n    for (let index = 0; index < gridColumns.length; index++) {\n      const tableGridColFragment = buildTableGridCol(gridWidth);\n      tableGridFragment.import(tableGridColFragment);\n    }\n  }\n  tableGridFragment.up();\n\n  return tableGridFragment;\n};\n\nconst buildTableGridFromTableRow = (vNode, attributes) => {\n  const tableGridFragment = fragment({\n    namespaceAlias: { w: namespaces.w },\n  }).ele('@w', 'tblGrid');\n  if (vNode.children && Array.isArray(vNode.children) && vNode.children.length) {\n    const numberOfGridColumns = vNode.children.reduce((accumulator, childVNode) => {\n      const colSpan =\n        childVNode.properties.colSpan ||\n        (childVNode.properties.style && childVNode.properties.style['column-span']);\n\n      return accumulator + (colSpan ? parseInt(colSpan) : 1);\n    }, 0);\n    const gridWidth = attributes.maximumWidth / numberOfGridColumns;\n\n    for (let index = 0; index < numberOfGridColumns; index++) {\n      const tableGridColFragment = buildTableGridCol(gridWidth);\n      tableGridFragment.import(tableGridColFragment);\n    }\n  }\n  tableGridFragment.up();\n\n  return tableGridFragment;\n};\n\nconst buildTableBorders = (tableBorder) => {\n  const tableBordersFragment = fragment({\n    namespaceAlias: { w: namespaces.w },\n  }).ele('@w', 'tblBorders');\n\n  const { color, stroke, ...borders } = tableBorder;\n\n  Object.keys(borders).forEach((border) => {\n    if (borders[border]) {\n      const borderFragment = buildBorder(border, borders[border], 0, color, stroke);\n      tableBordersFragment.import(borderFragment);\n    }\n  });\n\n  tableBordersFragment.up();\n\n  return tableBordersFragment;\n};\n\nconst buildTableWidth = (tableWidth) => {\n  const tableWidthFragment = fragment({\n    namespaceAlias: { w: namespaces.w },\n  })\n    .ele('@w', 'tblW')\n    .att('@w', 'type', 'dxa')\n    .att('@w', 'w', String(tableWidth))\n    .up();\n\n  return tableWidthFragment;\n};\n\nconst buildCellMargin = (side, margin) => {\n  const marginFragment = fragment({\n    namespaceAlias: { w: namespaces.w },\n  })\n    .ele('@w', side)\n    .att('@w', 'type', 'dxa')\n    .att('@w', 'w', String(margin))\n    .up();\n\n  return marginFragment;\n};\n\nconst buildTableCellMargins = (margin) => {\n  const tableCellMarFragment = fragment({\n    namespaceAlias: { w: namespaces.w },\n  }).ele('@w', 'tblCellMar');\n\n  ['top', 'bottom'].forEach((side) => {\n    const marginFragment = buildCellMargin(side, margin / 2);\n    tableCellMarFragment.import(marginFragment);\n  });\n  ['left', 'right'].forEach((side) => {\n    const marginFragment = buildCellMargin(side, margin);\n    tableCellMarFragment.import(marginFragment);\n  });\n\n  return tableCellMarFragment;\n};\n\nconst buildTableProperties = (attributes) => {\n  const tablePropertiesFragment = fragment({\n    namespaceAlias: { w: namespaces.w },\n  }).ele('@w', 'tblPr');\n\n  if (attributes && attributes.constructor === Object) {\n    Object.keys(attributes).forEach((key) => {\n      // eslint-disable-next-line default-case\n      switch (key) {\n        case 'tableBorder':\n          const tableBordersFragment = buildTableBorders(attributes[key]);\n          tablePropertiesFragment.import(tableBordersFragment);\n          // Delete used property\n          // eslint-disable-next-line no-param-reassign\n          delete attributes.tableBorder;\n          break;\n        case 'tableCellSpacing':\n          const tableCellSpacingFragment = buildTableCellSpacing(attributes[key]);\n          tablePropertiesFragment.import(tableCellSpacingFragment);\n          // Delete used property\n          // eslint-disable-next-line no-param-reassign\n          delete attributes.tableCellSpacing;\n          break;\n        case 'width':\n          if (attributes[key]) {\n            const tableWidthFragment = buildTableWidth(attributes[key]);\n            tablePropertiesFragment.import(tableWidthFragment);\n          }\n          // Delete used property\n          // eslint-disable-next-line no-param-reassign\n          delete attributes.width;\n          break;\n      }\n    });\n  }\n  const tableCellMarginFragment = buildTableCellMargins(160);\n  tablePropertiesFragment.import(tableCellMarginFragment);\n\n  // by default, all tables are center aligned.\n  const alignmentFragment = buildHorizontalAlignment('center');\n  tablePropertiesFragment.import(alignmentFragment);\n\n  tablePropertiesFragment.up();\n\n  return tablePropertiesFragment;\n};\n\nconst cssBorderParser = (borderString) => {\n  let [size, stroke, color] = borderString.split(' ');\n\n  if (pointRegex.test(size)) {\n    const matchedParts = size.match(pointRegex);\n    // convert point to eighth of a point\n    size = pointToEIP(matchedParts[1]);\n  } else if (pixelRegex.test(size)) {\n    const matchedParts = size.match(pixelRegex);\n    // convert pixels to eighth of a point\n    size = pixelToEIP(matchedParts[1]);\n  }\n  stroke = stroke && ['dashed', 'dotted', 'double'].includes(stroke) ? stroke : 'single';\n\n  color = color && fixupColorCode(color).toUpperCase();\n\n  return [size, stroke, color];\n};\n\nconst buildTable = (vNode, attributes, docxDocumentInstance) => {\n  const tableFragment = fragment({\n    namespaceAlias: { w: namespaces.w },\n  }).ele('@w', 'tbl');\n  const modifiedAttributes = { ...attributes };\n  if (isVNode(vNode) && vNode.properties) {\n    const tableAttributes = vNode.properties.attributes || {};\n    const tableStyles = vNode.properties.style || {};\n    const tableBorders = {};\n    const tableCellBorders = {};\n    let [borderSize, borderStrike, borderColor] = [2, 'single', '000000'];\n\n    // eslint-disable-next-line no-restricted-globals\n    if (!isNaN(tableAttributes.border)) {\n      borderSize = parseInt(tableAttributes.border, 10);\n    }\n\n    // css style overrides table border properties\n    if (tableStyles.border) {\n      const [cssSize, cssStroke, cssColor] = cssBorderParser(tableStyles.border);\n      borderSize = cssSize || borderSize;\n      borderColor = cssColor || borderColor;\n      borderStrike = cssStroke || borderStrike;\n    }\n\n    tableBorders.top = borderSize;\n    tableBorders.bottom = borderSize;\n    tableBorders.left = borderSize;\n    tableBorders.right = borderSize;\n    tableBorders.stroke = borderStrike;\n    tableBorders.color = borderColor;\n\n    if (tableStyles['border-collapse'] === 'collapse') {\n      tableBorders.insideV = borderSize;\n      tableBorders.insideH = borderSize;\n    } else {\n      tableBorders.insideV = 0;\n      tableBorders.insideH = 0;\n      tableCellBorders.top = 1;\n      tableCellBorders.bottom = 1;\n      tableCellBorders.left = 1;\n      tableCellBorders.right = 1;\n    }\n\n    modifiedAttributes.tableBorder = tableBorders;\n    modifiedAttributes.tableCellSpacing = 0;\n\n    if (Object.keys(tableCellBorders).length) {\n      modifiedAttributes.tableCellBorder = tableCellBorders;\n    }\n\n    let minimumWidth;\n    let maximumWidth;\n    let width;\n    // Calculate minimum width of table\n    if (pixelRegex.test(tableStyles['min-width'])) {\n      minimumWidth = pixelToTWIP(tableStyles['min-width'].match(pixelRegex)[1]);\n    } else if (percentageRegex.test(tableStyles['min-width'])) {\n      const percentageValue = tableStyles['min-width'].match(percentageRegex)[1];\n      minimumWidth = Math.round((percentageValue / 100) * attributes.maximumWidth);\n    }\n\n    // Calculate maximum width of table\n    if (pixelRegex.test(tableStyles['max-width'])) {\n      pixelRegex.lastIndex = 0;\n      maximumWidth = pixelToTWIP(tableStyles['max-width'].match(pixelRegex)[1]);\n    } else if (percentageRegex.test(tableStyles['max-width'])) {\n      percentageRegex.lastIndex = 0;\n      const percentageValue = tableStyles['max-width'].match(percentageRegex)[1];\n      maximumWidth = Math.round((percentageValue / 100) * attributes.maximumWidth);\n    }\n\n    // Calculate specified width of table\n    if (pixelRegex.test(tableStyles.width)) {\n      pixelRegex.lastIndex = 0;\n      width = pixelToTWIP(tableStyles.width.match(pixelRegex)[1]);\n    } else if (percentageRegex.test(tableStyles.width)) {\n      percentageRegex.lastIndex = 0;\n      const percentageValue = tableStyles.width.match(percentageRegex)[1];\n      width = Math.round((percentageValue / 100) * attributes.maximumWidth);\n    }\n\n    // If width isn't supplied, we should have min-width as the width.\n    if (width) {\n      modifiedAttributes.width = width;\n      if (maximumWidth) {\n        modifiedAttributes.width = Math.min(modifiedAttributes.width, maximumWidth);\n      }\n      if (minimumWidth) {\n        modifiedAttributes.width = Math.max(modifiedAttributes.width, minimumWidth);\n      }\n    } else if (minimumWidth) {\n      modifiedAttributes.width = minimumWidth;\n    }\n    if (modifiedAttributes.width) {\n      modifiedAttributes.width = Math.min(modifiedAttributes.width, attributes.maximumWidth);\n    }\n  }\n  const tablePropertiesFragment = buildTableProperties(modifiedAttributes);\n  tableFragment.import(tablePropertiesFragment);\n\n  const rowSpanMap = new Map();\n\n  if (vNode.children && Array.isArray(vNode.children) && vNode.children.length) {\n    for (let index = 0; index < vNode.children.length; index++) {\n      const childVNode = vNode.children[index];\n      if (childVNode.tagName === 'colgroup') {\n        const tableGridFragment = buildTableGrid(childVNode, modifiedAttributes);\n        tableFragment.import(tableGridFragment);\n      } else if (childVNode.tagName === 'thead') {\n        for (let iteratorIndex = 0; iteratorIndex < childVNode.children.length; iteratorIndex++) {\n          const grandChildVNode = childVNode.children[iteratorIndex];\n          if (grandChildVNode.tagName === 'tr') {\n            if (iteratorIndex === 0) {\n              const tableGridFragment = buildTableGridFromTableRow(\n                grandChildVNode,\n                modifiedAttributes\n              );\n              tableFragment.import(tableGridFragment);\n            }\n            const tableRowFragment = buildTableRow(\n              grandChildVNode,\n              modifiedAttributes,\n              rowSpanMap,\n              docxDocumentInstance\n            );\n            tableFragment.import(tableRowFragment);\n          }\n        }\n      } else if (childVNode.tagName === 'tbody') {\n        for (let iteratorIndex = 0; iteratorIndex < childVNode.children.length; iteratorIndex++) {\n          const grandChildVNode = childVNode.children[iteratorIndex];\n          if (grandChildVNode.tagName === 'tr') {\n            if (iteratorIndex === 0) {\n              const tableGridFragment = buildTableGridFromTableRow(\n                grandChildVNode,\n                modifiedAttributes\n              );\n              tableFragment.import(tableGridFragment);\n            }\n            const tableRowFragment = buildTableRow(\n              grandChildVNode,\n              modifiedAttributes,\n              rowSpanMap,\n              docxDocumentInstance\n            );\n            tableFragment.import(tableRowFragment);\n          }\n        }\n      } else if (childVNode.tagName === 'tr') {\n        if (index === 0) {\n          const tableGridFragment = buildTableGridFromTableRow(childVNode, modifiedAttributes);\n          tableFragment.import(tableGridFragment);\n        }\n        const tableRowFragment = buildTableRow(\n          childVNode,\n          modifiedAttributes,\n          rowSpanMap,\n          docxDocumentInstance\n        );\n        tableFragment.import(tableRowFragment);\n      }\n    }\n  }\n  tableFragment.up();\n\n  return tableFragment;\n};\n\nconst buildPresetGeometry = () => {\n  const presetGeometryFragment = fragment({\n    namespaceAlias: { a: namespaces.a },\n  })\n    .ele('@a', 'prstGeom')\n    .att('prst', 'rect')\n    .up();\n\n  return presetGeometryFragment;\n};\n\nconst buildExtents = ({ width, height }) => {\n  const extentsFragment = fragment({\n    namespaceAlias: { a: namespaces.a },\n  })\n    .ele('@a', 'ext')\n    .att('cx', width)\n    .att('cy', height)\n    .up();\n\n  return extentsFragment;\n};\n\nconst buildOffset = () => {\n  const offsetFragment = fragment({\n    namespaceAlias: { a: namespaces.a },\n  })\n    .ele('@a', 'off')\n    .att('x', '0')\n    .att('y', '0')\n    .up();\n\n  return offsetFragment;\n};\n\nconst buildGraphicFrameTransform = (attributes) => {\n  const graphicFrameTransformFragment = fragment({\n    namespaceAlias: { a: namespaces.a },\n  }).ele('@a', 'xfrm');\n\n  const offsetFragment = buildOffset();\n  graphicFrameTransformFragment.import(offsetFragment);\n  const extentsFragment = buildExtents(attributes);\n  graphicFrameTransformFragment.import(extentsFragment);\n\n  graphicFrameTransformFragment.up();\n\n  return graphicFrameTransformFragment;\n};\n\nconst buildShapeProperties = (attributes) => {\n  const shapeProperties = fragment({\n    namespaceAlias: { pic: namespaces.pic },\n  }).ele('@pic', 'spPr');\n\n  const graphicFrameTransformFragment = buildGraphicFrameTransform(attributes);\n  shapeProperties.import(graphicFrameTransformFragment);\n  const presetGeometryFragment = buildPresetGeometry();\n  shapeProperties.import(presetGeometryFragment);\n\n  shapeProperties.up();\n\n  return shapeProperties;\n};\n\nconst buildFillRect = () => {\n  const fillRectFragment = fragment({\n    namespaceAlias: { a: namespaces.a },\n  })\n    .ele('@a', 'fillRect')\n    .up();\n\n  return fillRectFragment;\n};\n\nconst buildStretch = () => {\n  const stretchFragment = fragment({\n    namespaceAlias: { a: namespaces.a },\n  }).ele('@a', 'stretch');\n\n  const fillRectFragment = buildFillRect();\n  stretchFragment.import(fillRectFragment);\n\n  stretchFragment.up();\n\n  return stretchFragment;\n};\n\nconst buildSrcRectFragment = () => {\n  const srcRectFragment = fragment({\n    namespaceAlias: { a: namespaces.a },\n  })\n    .ele('@a', 'srcRect')\n    .att('b', '0')\n    .att('l', '0')\n    .att('r', '0')\n    .att('t', '0')\n    .up();\n\n  return srcRectFragment;\n};\n\nconst buildBinaryLargeImageOrPicture = (relationshipId) => {\n  const binaryLargeImageOrPictureFragment = fragment({\n    namespaceAlias: { a: namespaces.a, r: namespaces.r },\n  })\n    .ele('@a', 'blip')\n    .att('@r', 'embed', `rId${relationshipId}`)\n    // FIXME: possible values 'email', 'none', 'print', 'hqprint', 'screen'\n    .att('cstate', 'print');\n\n  binaryLargeImageOrPictureFragment.up();\n\n  return binaryLargeImageOrPictureFragment;\n};\n\nconst buildBinaryLargeImageOrPictureFill = (relationshipId) => {\n  const binaryLargeImageOrPictureFillFragment = fragment({\n    namespaceAlias: { pic: namespaces.pic },\n  }).ele('@pic', 'blipFill');\n  const binaryLargeImageOrPictureFragment = buildBinaryLargeImageOrPicture(relationshipId);\n  binaryLargeImageOrPictureFillFragment.import(binaryLargeImageOrPictureFragment);\n  const srcRectFragment = buildSrcRectFragment();\n  binaryLargeImageOrPictureFillFragment.import(srcRectFragment);\n  const stretchFragment = buildStretch();\n  binaryLargeImageOrPictureFillFragment.import(stretchFragment);\n\n  binaryLargeImageOrPictureFillFragment.up();\n\n  return binaryLargeImageOrPictureFillFragment;\n};\n\nconst buildNonVisualPictureDrawingProperties = () => {\n  const nonVisualPictureDrawingPropertiesFragment = fragment({\n    namespaceAlias: { pic: namespaces.pic },\n  }).ele('@pic', 'cNvPicPr');\n\n  nonVisualPictureDrawingPropertiesFragment.up();\n\n  return nonVisualPictureDrawingPropertiesFragment;\n};\n\nconst buildNonVisualDrawingProperties = (\n  pictureId,\n  pictureNameWithExtension,\n  pictureDescription = ''\n) => {\n  const nonVisualDrawingPropertiesFragment = fragment({\n    namespaceAlias: { pic: namespaces.pic },\n  })\n    .ele('@pic', 'cNvPr')\n    .att('id', pictureId)\n    .att('name', pictureNameWithExtension)\n    .att('descr', pictureDescription);\n\n  nonVisualDrawingPropertiesFragment.up();\n\n  return nonVisualDrawingPropertiesFragment;\n};\n\nconst buildNonVisualPictureProperties = (\n  pictureId,\n  pictureNameWithExtension,\n  pictureDescription\n) => {\n  const nonVisualPicturePropertiesFragment = fragment({\n    namespaceAlias: { pic: namespaces.pic },\n  }).ele('@pic', 'nvPicPr');\n  // TODO: Handle picture attributes\n  const nonVisualDrawingPropertiesFragment = buildNonVisualDrawingProperties(\n    pictureId,\n    pictureNameWithExtension,\n    pictureDescription\n  );\n  nonVisualPicturePropertiesFragment.import(nonVisualDrawingPropertiesFragment);\n  const nonVisualPictureDrawingPropertiesFragment = buildNonVisualPictureDrawingProperties();\n  nonVisualPicturePropertiesFragment.import(nonVisualPictureDrawingPropertiesFragment);\n  nonVisualPicturePropertiesFragment.up();\n\n  return nonVisualPicturePropertiesFragment;\n};\n\nconst buildPicture = ({\n  id,\n  fileNameWithExtension,\n  description,\n  relationshipId,\n  width,\n  height,\n}) => {\n  const pictureFragment = fragment({\n    namespaceAlias: { pic: namespaces.pic },\n  }).ele('@pic', 'pic');\n  const nonVisualPicturePropertiesFragment = buildNonVisualPictureProperties(\n    id,\n    fileNameWithExtension,\n    description\n  );\n  pictureFragment.import(nonVisualPicturePropertiesFragment);\n  const binaryLargeImageOrPictureFill = buildBinaryLargeImageOrPictureFill(relationshipId);\n  pictureFragment.import(binaryLargeImageOrPictureFill);\n  const shapeProperties = buildShapeProperties({ width, height });\n  pictureFragment.import(shapeProperties);\n  pictureFragment.up();\n\n  return pictureFragment;\n};\n\nconst buildGraphicData = (graphicType, attributes) => {\n  const graphicDataFragment = fragment({\n    namespaceAlias: { a: namespaces.a },\n  })\n    .ele('@a', 'graphicData')\n    .att('uri', 'http://schemas.openxmlformats.org/drawingml/2006/picture');\n  if (graphicType === 'picture') {\n    const pictureFragment = buildPicture(attributes);\n    graphicDataFragment.import(pictureFragment);\n  }\n  graphicDataFragment.up();\n\n  return graphicDataFragment;\n};\n\nconst buildGraphic = (graphicType, attributes) => {\n  const graphicFragment = fragment({\n    namespaceAlias: { a: namespaces.a },\n  }).ele('@a', 'graphic');\n  // TODO: Handle drawing type\n  const graphicDataFragment = buildGraphicData(graphicType, attributes);\n  graphicFragment.import(graphicDataFragment);\n  graphicFragment.up();\n\n  return graphicFragment;\n};\n\nconst buildDrawingObjectNonVisualProperties = (pictureId, pictureName) => {\n  const drawingObjectNonVisualPropertiesFragment = fragment({\n    namespaceAlias: { wp: namespaces.wp },\n  })\n    .ele('@wp', 'docPr')\n    .att('id', pictureId)\n    .att('name', pictureName)\n    .up();\n\n  return drawingObjectNonVisualPropertiesFragment;\n};\n\nconst buildWrapSquare = () => {\n  const wrapSquareFragment = fragment({\n    namespaceAlias: { wp: namespaces.wp },\n  })\n    .ele('@wp', 'wrapSquare')\n    .att('wrapText', 'bothSides')\n    .att('distB', '228600')\n    .att('distT', '228600')\n    .att('distL', '228600')\n    .att('distR', '228600')\n    .up();\n\n  return wrapSquareFragment;\n};\n\n// eslint-disable-next-line no-unused-vars\nconst buildWrapNone = () => {\n  const wrapNoneFragment = fragment({\n    namespaceAlias: { wp: namespaces.wp },\n  })\n    .ele('@wp', 'wrapNone')\n    .up();\n\n  return wrapNoneFragment;\n};\n\nconst buildEffectExtentFragment = () => {\n  const effectExtentFragment = fragment({\n    namespaceAlias: { wp: namespaces.wp },\n  })\n    .ele('@wp', 'effectExtent')\n    .att('b', '0')\n    .att('l', '0')\n    .att('r', '0')\n    .att('t', '0')\n    .up();\n\n  return effectExtentFragment;\n};\n\nconst buildExtent = ({ width, height }) => {\n  const extentFragment = fragment({\n    namespaceAlias: { wp: namespaces.wp },\n  })\n    .ele('@wp', 'extent')\n    .att('cx', width)\n    .att('cy', height)\n    .up();\n\n  return extentFragment;\n};\n\nconst buildPositionV = () => {\n  const positionVFragment = fragment({\n    namespaceAlias: { wp: namespaces.wp },\n  })\n    .ele('@wp', 'positionV')\n    .att('relativeFrom', 'paragraph')\n    .ele('@wp', 'posOffset')\n    .txt('19050')\n    .up()\n    .up();\n\n  return positionVFragment;\n};\n\nconst buildPositionH = () => {\n  const positionHFragment = fragment({\n    namespaceAlias: { wp: namespaces.wp },\n  })\n    .ele('@wp', 'positionH')\n    .att('relativeFrom', 'column')\n    .ele('@wp', 'posOffset')\n    .txt('19050')\n    .up()\n    .up();\n\n  return positionHFragment;\n};\n\nconst buildSimplePos = () => {\n  const simplePosFragment = fragment({\n    namespaceAlias: { wp: namespaces.wp },\n  })\n    .ele('@wp', 'simplePos')\n    .att('x', '0')\n    .att('y', '0')\n    .up();\n\n  return simplePosFragment;\n};\n\nconst buildAnchoredDrawing = (graphicType, attributes) => {\n  const anchoredDrawingFragment = fragment({\n    namespaceAlias: { wp: namespaces.wp },\n  })\n    .ele('@wp', 'anchor')\n    .att('distB', '0')\n    .att('distL', '0')\n    .att('distR', '0')\n    .att('distT', '0')\n    .att('relativeHeight', '0')\n    .att('behindDoc', 'false')\n    .att('locked', 'true')\n    .att('layoutInCell', 'true')\n    .att('allowOverlap', 'false')\n    .att('simplePos', 'false');\n  // Even though simplePos isnt supported by Word 2007 simplePos is required.\n  const simplePosFragment = buildSimplePos();\n  anchoredDrawingFragment.import(simplePosFragment);\n  const positionHFragment = buildPositionH();\n  anchoredDrawingFragment.import(positionHFragment);\n  const positionVFragment = buildPositionV();\n  anchoredDrawingFragment.import(positionVFragment);\n  const extentFragment = buildExtent({ width: attributes.width, height: attributes.height });\n  anchoredDrawingFragment.import(extentFragment);\n  const effectExtentFragment = buildEffectExtentFragment();\n  anchoredDrawingFragment.import(effectExtentFragment);\n  const wrapSquareFragment = buildWrapSquare();\n  anchoredDrawingFragment.import(wrapSquareFragment);\n  const drawingObjectNonVisualPropertiesFragment = buildDrawingObjectNonVisualProperties(\n    attributes.id,\n    attributes.fileNameWithExtension\n  );\n  anchoredDrawingFragment.import(drawingObjectNonVisualPropertiesFragment);\n  const graphicFragment = buildGraphic(graphicType, attributes);\n  anchoredDrawingFragment.import(graphicFragment);\n\n  anchoredDrawingFragment.up();\n\n  return anchoredDrawingFragment;\n};\n\nconst buildInlineDrawing = (graphicType, attributes) => {\n  const inlineDrawingFragment = fragment({\n    namespaceAlias: { wp: namespaces.wp },\n  })\n    .ele('@wp', 'inline')\n    .att('distB', '0')\n    .att('distL', '0')\n    .att('distR', '0')\n    .att('distT', '0');\n\n  const extentFragment = buildExtent({ width: attributes.width, height: attributes.height });\n  inlineDrawingFragment.import(extentFragment);\n  const effectExtentFragment = buildEffectExtentFragment();\n  inlineDrawingFragment.import(effectExtentFragment);\n  const drawingObjectNonVisualPropertiesFragment = buildDrawingObjectNonVisualProperties(\n    attributes.id,\n    attributes.fileNameWithExtension\n  );\n  inlineDrawingFragment.import(drawingObjectNonVisualPropertiesFragment);\n  const graphicFragment = buildGraphic(graphicType, attributes);\n  inlineDrawingFragment.import(graphicFragment);\n\n  inlineDrawingFragment.up();\n\n  return inlineDrawingFragment;\n};\n\nconst buildDrawing = (inlineOrAnchored = false, graphicType, attributes) => {\n  const drawingFragment = fragment({\n    namespaceAlias: { w: namespaces.w },\n  }).ele('@w', 'drawing');\n  const inlineOrAnchoredDrawingFragment = inlineOrAnchored\n    ? buildInlineDrawing(graphicType, attributes)\n    : buildAnchoredDrawing(graphicType, attributes);\n  drawingFragment.import(inlineOrAnchoredDrawingFragment);\n  drawingFragment.up();\n\n  return drawingFragment;\n};\n\nexport {\n  buildParagraph,\n  buildTable,\n  buildNumberingInstances,\n  buildLineBreak,\n  buildIndentation,\n  buildTextElement,\n  buildBold,\n  buildItalics,\n  buildUnderline,\n  buildDrawing,\n  fixupLineHeight,\n};\n","/* eslint-disable no-case-declarations */\nimport { fragment } from 'xmlbuilder2';\nimport VNode from 'virtual-dom/vnode/vnode';\nimport VText from 'virtual-dom/vnode/vtext';\nimport isVNode from 'virtual-dom/vnode/is-vnode';\nimport isVText from 'virtual-dom/vnode/is-vtext';\nimport HTMLToVDOM from 'html-to-vdom';\nimport escape from 'escape-html';\nimport sizeOf from 'image-size';\n\n// FIXME: remove the cyclic dependency\n// eslint-disable-next-line import/no-cycle\nimport * as xmlBuilder from './xml-builder';\nimport namespaces from './namespaces';\n\nconst convertHTML = HTMLToVDOM({\n  VNode,\n  VText,\n});\n\n// eslint-disable-next-line consistent-return, no-shadow\nexport const buildImage = (docxDocumentInstance, vNode, maximumWidth = null) => {\n  let response = null;\n  try {\n    // libtidy encodes the image src\n    response = docxDocumentInstance.createMediaFile(decodeURIComponent(vNode.properties.src));\n  } catch (error) {\n    // NOOP\n  }\n  if (response) {\n    docxDocumentInstance.zip\n      .folder('word')\n      .folder('media')\n      .file(response.fileNameWithExtension, Buffer.from(response.fileContent, 'base64'), {\n        createFolders: false,\n      });\n\n    const documentRelsId = docxDocumentInstance.createDocumentRelationships(\n      docxDocumentInstance.relationshipFilename,\n      'image',\n      `media/${response.fileNameWithExtension}`,\n      'Internal'\n    );\n\n    const imageBuffer = Buffer.from(response.fileContent, 'base64');\n    const imageProperties = sizeOf(imageBuffer);\n\n    const imageFragment = xmlBuilder.buildParagraph(\n      vNode,\n      {\n        type: 'picture',\n        inlineOrAnchored: true,\n        relationshipId: documentRelsId,\n        ...response,\n        maximumWidth: maximumWidth || docxDocumentInstance.availableDocumentSpace,\n        originalWidth: imageProperties.width,\n        originalHeight: imageProperties.height,\n      },\n      docxDocumentInstance\n    );\n\n    return imageFragment;\n  }\n};\n\nexport const buildList = (vNode) => {\n  const listElements = [];\n\n  let vNodeObjects = [{ node: vNode, level: 0, type: vNode.tagName }];\n  while (vNodeObjects.length) {\n    const tempVNodeObject = vNodeObjects.shift();\n    if (\n      isVText(tempVNodeObject.node) ||\n      (isVNode(tempVNodeObject.node) && !['ul', 'ol', 'li'].includes(tempVNodeObject.node.tagName))\n    ) {\n      listElements.push({\n        node: tempVNodeObject.node,\n        level: tempVNodeObject.level,\n        type: tempVNodeObject.type,\n      });\n    }\n\n    if (\n      tempVNodeObject.node.children &&\n      tempVNodeObject.node.children.length &&\n      ['ul', 'ol', 'li'].includes(tempVNodeObject.node.tagName)\n    ) {\n      const tempVNodeObjects = tempVNodeObject.node.children.reduce((accumulator, childVNode) => {\n        if (['ul', 'ol'].includes(childVNode.tagName)) {\n          accumulator.push({\n            node: childVNode,\n            level: tempVNodeObject.level + 1,\n            type: childVNode.tagName,\n          });\n        } else {\n          // eslint-disable-next-line no-lonely-if\n          if (\n            accumulator.length > 0 &&\n            isVNode(accumulator[accumulator.length - 1].node) &&\n            accumulator[accumulator.length - 1].node.tagName.toLowerCase() === 'p'\n          ) {\n            accumulator[accumulator.length - 1].node.children.push(childVNode);\n          } else {\n            const paragraphVNode = new VNode(\n              'p',\n              null,\n              // eslint-disable-next-line no-nested-ternary\n              isVText(childVNode)\n                ? [childVNode]\n                : // eslint-disable-next-line no-nested-ternary\n                isVNode(childVNode)\n                ? childVNode.tagName.toLowerCase() === 'li'\n                  ? [...childVNode.children]\n                  : [childVNode]\n                : []\n            );\n            accumulator.push({\n              // eslint-disable-next-line prettier/prettier, no-nested-ternary\n              node: isVNode(childVNode)\n                ? // eslint-disable-next-line prettier/prettier, no-nested-ternary\n                  childVNode.tagName.toLowerCase() === 'li'\n                  ? childVNode\n                  : childVNode.tagName.toLowerCase() !== 'p'\n                  ? paragraphVNode\n                  : childVNode\n                : // eslint-disable-next-line prettier/prettier\n                  paragraphVNode,\n              level: tempVNodeObject.level,\n              type: tempVNodeObject.type,\n            });\n          }\n        }\n\n        return accumulator;\n      }, []);\n      vNodeObjects = tempVNodeObjects.concat(vNodeObjects);\n    }\n  }\n\n  return listElements;\n};\n\nfunction findXMLEquivalent(docxDocumentInstance, vNode, xmlFragment) {\n  if (\n    vNode.tagName === 'div' &&\n    (vNode.properties.attributes.class === 'page-break' ||\n      (vNode.properties.style && vNode.properties.style['page-break-after']))\n  ) {\n    const paragraphFragment = fragment({\n      namespaceAlias: { w: namespaces.w },\n    })\n      .ele('@w', 'p')\n      .ele('@w', 'r')\n      .ele('@w', 'br')\n      .att('@w', 'type', 'page')\n      .up()\n      .up()\n      .up();\n\n    xmlFragment.import(paragraphFragment);\n    return;\n  }\n\n  switch (vNode.tagName) {\n    case 'h1':\n    case 'h2':\n    case 'h3':\n    case 'h4':\n    case 'h5':\n    case 'h6':\n      const headingFragment = xmlBuilder.buildParagraph(\n        vNode,\n        {\n          paragraphStyle: `Heading${vNode.tagName[1]}`,\n        },\n        docxDocumentInstance\n      );\n      xmlFragment.import(headingFragment);\n      return;\n    case 'span':\n    case 'strong':\n    case 'b':\n    case 'em':\n    case 'i':\n    case 'u':\n    case 'ins':\n    case 'strike':\n    case 'del':\n    case 's':\n    case 'sub':\n    case 'sup':\n    case 'mark':\n    case 'p':\n    case 'a':\n    case 'blockquote':\n    case 'img':\n      const paragraphFragment = xmlBuilder.buildParagraph(vNode, {}, docxDocumentInstance);\n      xmlFragment.import(paragraphFragment);\n      return;\n    case 'figure':\n      if (vNode.children && Array.isArray(vNode.children) && vNode.children.length) {\n        // eslint-disable-next-line no-plusplus\n        for (let index = 0; index < vNode.children.length; index++) {\n          const childVNode = vNode.children[index];\n          if (childVNode.tagName === 'table') {\n            const tableFragment = xmlBuilder.buildTable(\n              childVNode,\n              {\n                maximumWidth: docxDocumentInstance.availableDocumentSpace,\n                rowCantSplit: docxDocumentInstance.tableRowCantSplit,\n              },\n              docxDocumentInstance\n            );\n            xmlFragment.import(tableFragment);\n            // Adding empty paragraph for space after table\n            const emptyParagraphFragment = xmlBuilder.buildParagraph(null, {});\n            xmlFragment.import(emptyParagraphFragment);\n          } else if (childVNode.tagName === 'img') {\n            const imageFragment = buildImage(docxDocumentInstance, childVNode);\n            if (imageFragment) {\n              xmlFragment.import(imageFragment);\n            }\n          }\n        }\n      }\n      return;\n    case 'table':\n      const tableFragment = xmlBuilder.buildTable(\n        vNode,\n        {\n          maximumWidth: docxDocumentInstance.availableDocumentSpace,\n          rowCantSplit: docxDocumentInstance.tableRowCantSplit,\n        },\n        docxDocumentInstance\n      );\n      xmlFragment.import(tableFragment);\n      // Adding empty paragraph for space after table\n      const emptyParagraphFragment = xmlBuilder.buildParagraph(null, {});\n      xmlFragment.import(emptyParagraphFragment);\n      return;\n    case 'ol':\n    case 'ul':\n      const listElements = buildList(vNode);\n      const numberingId = docxDocumentInstance.createNumbering(listElements);\n      // eslint-disable-next-line no-plusplus\n      for (let index = 0; index < listElements.length; index++) {\n        const listElement = listElements[index];\n        // eslint-disable-next-line no-shadow\n        const paragraphFragment = xmlBuilder.buildParagraph(\n          listElement.node,\n          {\n            numbering: { levelId: listElement.level, numberingId },\n          },\n          docxDocumentInstance\n        );\n        xmlFragment.import(paragraphFragment);\n      }\n      return;\n    case 'br':\n      const linebreakFragment = xmlBuilder.buildParagraph(null, {});\n      xmlFragment.import(linebreakFragment);\n      return;\n    default:\n      break;\n  }\n  if (vNode.children && Array.isArray(vNode.children) && vNode.children.length) {\n    // eslint-disable-next-line no-plusplus\n    for (let index = 0; index < vNode.children.length; index++) {\n      const childVNode = vNode.children[index];\n      // eslint-disable-next-line no-use-before-define\n      convertVTreeToXML(docxDocumentInstance, childVNode, xmlFragment);\n    }\n  }\n}\n\n// eslint-disable-next-line consistent-return\nexport function convertVTreeToXML(docxDocumentInstance, vTree, xmlFragment) {\n  if (!vTree) {\n    // eslint-disable-next-line no-useless-return\n    return '';\n  }\n  if (Array.isArray(vTree) && vTree.length) {\n    // eslint-disable-next-line no-plusplus\n    for (let index = 0; index < vTree.length; index++) {\n      const vNode = vTree[index];\n      convertVTreeToXML(docxDocumentInstance, vNode, xmlFragment);\n    }\n  } else if (isVNode(vTree)) {\n    findXMLEquivalent(docxDocumentInstance, vTree, xmlFragment);\n  } else if (isVText(vTree)) {\n    xmlBuilder.buildTextElement(xmlFragment, escape(String(vTree.text)));\n  }\n  return xmlFragment;\n}\n\nfunction renderDocumentFile(docxDocumentInstance) {\n  const vTree = convertHTML(docxDocumentInstance.htmlString);\n\n  const xmlFragment = fragment({\n    namespaceAlias: { w: namespaces.w },\n  });\n\n  const populatedXmlFragment = convertVTreeToXML(docxDocumentInstance, vTree, xmlFragment);\n\n  return populatedXmlFragment;\n}\n\nexport default renderDocumentFile;\n","import { namespaces } from '../helpers';\n\nconst generateCoreXML = (\n  title = '',\n  subject = '',\n  creator = 'html-to-docx',\n  keywords = ['html-to-docx'],\n  description = '',\n  lastModifiedBy = 'html-to-docx',\n  revision = 1,\n  createdAt = new Date(),\n  modifiedAt = new Date()\n) => {\n  return `\n        <?xml version=\"1.0\" encoding=\"UTF-8\" standalone=\"yes\"?>\n\n        <cp:coreProperties\n          xmlns:cp=\"${namespaces.coreProperties}\"\n          xmlns:dc=\"${namespaces.dc}\"\n          xmlns:dcterms=\"${namespaces.dcterms}\"\n          xmlns:dcmitype=\"${namespaces.dcmitype}\"\n          xmlns:xsi=\"${namespaces.xsi}\"\n          >\n            <dc:title>${title}</dc:title>\n            <dc:subject>${subject}</dc:subject>\n            <dc:creator>${creator}</dc:creator>\n            ${\n              keywords && Array.isArray(keywords)\n                ? `<cp:keywords>${keywords.join(', ')}</cp:keywords>`\n                : ''\n            }\n            <dc:description>${description}</dc:description>\n            <cp:lastModifiedBy>${lastModifiedBy}</cp:lastModifiedBy>\n            <cp:revision>${revision}</cp:revision>\n            <dcterms:created xsi:type=\"dcterms:W3CDTF\">${\n              createdAt instanceof Date ? createdAt.toISOString() : new Date().toISOString()\n            }</dcterms:created>\n            <dcterms:modified xsi:type=\"dcterms:W3CDTF\">${\n              modifiedAt instanceof Date ? modifiedAt.toISOString() : new Date().toISOString()\n            }</dcterms:modified>\n        </cp:coreProperties>\n    `;\n};\n\nexport default generateCoreXML;\n","import { namespaces } from '../helpers';\n\nconst documentRelsXML = `\n  <?xml version=\"1.0\" encoding=\"UTF-8\" standalone=\"yes\"?>\n\n  <Relationships xmlns=\"http://schemas.openxmlformats.org/package/2006/relationships\">\n    <Relationship Id=\"rId1\" Type=\"${namespaces.numbering}\" Target=\"numbering.xml\"/>\n    <Relationship Id=\"rId2\" Type=\"${namespaces.styles}\" Target=\"styles.xml\"/>\n    <Relationship Id=\"rId3\" Type=\"${namespaces.settingsRelation}\" Target=\"settings.xml\"/>\n    <Relationship Id=\"rId4\" Type=\"${namespaces.webSettingsRelation}\" Target=\"webSettings.xml\"/>\n  </Relationships>\n`;\n\nexport default documentRelsXML;\n","import { namespaces } from '../helpers';\n\nconst relsXML = `\n    <?xml version=\"1.0\" encoding=\"UTF-8\" standalone=\"yes\"?>\n\n    <Relationships xmlns=\"http://schemas.openxmlformats.org/package/2006/relationships\">\n        <Relationship Id=\"rId1\" Type=\"${namespaces.officeDocumentRelation}\" Target=\"word/document.xml\"/>\n        <Relationship Id=\"rId2\" Type=\"${namespaces.corePropertiesRelation}\" Target=\"docProps/core.xml\"/>\n    </Relationships>\n`;\n\nexport default relsXML;\n","import { namespaces } from '../helpers';\n\nconst fontTableXML = `\n    <?xml version=\"1.0\" encoding=\"UTF-8\" standalone=\"yes\"?>\n\n    <w:fonts\n      xmlns:r=\"${namespaces.r}\"\n      xmlns:w=\"${namespaces.w}\"\n      >\n        <w:font w:name=\"Calibri\">\n            <w:panose1 w:val=\"020F0502020204030204\"/>\n            <w:charset w:val=\"00\"/>\n            <w:family w:val=\"swiss\"/>\n            <w:pitch w:val=\"variable\"/>\n            <w:sig w:usb0=\"E4002EFF\" w:usb1=\"C000247B\" w:usb2=\"00000009\" w:usb3=\"00000000\" w:csb0=\"000001FF\" w:csb1=\"00000000\"/>\n        </w:font>\n        <w:font w:name=\"Times New Roman\">\n            <w:panose1 w:val=\"02020603050405020304\"/>\n            <w:charset w:val=\"00\"/>\n            <w:family w:val=\"roman\"/>\n            <w:pitch w:val=\"variable\"/>\n            <w:sig w:usb0=\"E0002EFF\" w:usb1=\"C000785B\" w:usb2=\"00000009\" w:usb3=\"00000000\" w:csb0=\"000001FF\" w:csb1=\"00000000\"/>\n        </w:font>\n        <w:font w:name=\"Calibri Light\">\n            <w:panose1 w:val=\"020F0302020204030204\"/>\n            <w:charset w:val=\"00\"/>\n            <w:family w:val=\"swiss\"/>\n            <w:pitch w:val=\"variable\"/>\n            <w:sig w:usb0=\"E4002EFF\" w:usb1=\"C000247B\" w:usb2=\"00000009\" w:usb3=\"00000000\" w:csb0=\"000001FF\" w:csb1=\"00000000\"/>\n        </w:font>\n    </w:fonts>\n`;\n\nexport default fontTableXML;\n","import { namespaces } from '../helpers';\n\nconst settingsXML = `\n    <?xml version=\"1.0\" encoding=\"UTF-8\" standalone=\"yes\"?>\n\n    <w:settings xmlns:w=\"${namespaces.w}\" xmlns:o=\"${namespaces.o}\" xmlns:r=\"${namespaces.r}\" xmlns:v=\"${namespaces.v}\" xmlns:w10=\"${namespaces.w10}\" xmlns:sl=\"${namespaces.sl}\">\n        <w:zoom w:percent=\"100\"/>\n        <w:defaultTabStop w:val=\"720\"/>\n        <w:decimalSymbol w:val=\".\"/>\n        <w:listSeparator w:val=\",\"/>\n    </w:settings>\n`;\n\nexport default settingsXML;\n","import { namespaces } from '../helpers';\n\nconst webSettingsXML = `\n    <?xml version=\"1.0\" encoding=\"UTF-8\" standalone=\"yes\"?>\n\n    <w:webSettings xmlns:w=\"${namespaces.w}\" xmlns:r=\"${namespaces.r}\">\n    </w:webSettings>\n`;\n\nexport default webSettingsXML;\n","'use strict';\n\n// Found this seed-based random generator somewhere\n// Based on The Central Randomizer 1.3 (C) 1997 by Paul Houle (houle@msc.cornell.edu)\n\nvar seed = 1;\n\n/**\n * return a random number based on a seed\n * @param seed\n * @returns {number}\n */\nfunction getNextValue() {\n    seed = (seed * 9301 + 49297) % 233280;\n    return seed/(233280.0);\n}\n\nfunction setSeed(_seed_) {\n    seed = _seed_;\n}\n\nmodule.exports = {\n    nextValue: getNextValue,\n    seed: setSeed\n};\n","'use strict';\n\nvar randomFromSeed = require('./random/random-from-seed');\n\nvar ORIGINAL = '0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ_-';\nvar alphabet;\nvar previousSeed;\n\nvar shuffled;\n\nfunction reset() {\n    shuffled = false;\n}\n\nfunction setCharacters(_alphabet_) {\n    if (!_alphabet_) {\n        if (alphabet !== ORIGINAL) {\n            alphabet = ORIGINAL;\n            reset();\n        }\n        return;\n    }\n\n    if (_alphabet_ === alphabet) {\n        return;\n    }\n\n    if (_alphabet_.length !== ORIGINAL.length) {\n        throw new Error('Custom alphabet for shortid must be ' + ORIGINAL.length + ' unique characters. You submitted ' + _alphabet_.length + ' characters: ' + _alphabet_);\n    }\n\n    var unique = _alphabet_.split('').filter(function(item, ind, arr){\n       return ind !== arr.lastIndexOf(item);\n    });\n\n    if (unique.length) {\n        throw new Error('Custom alphabet for shortid must be ' + ORIGINAL.length + ' unique characters. These characters were not unique: ' + unique.join(', '));\n    }\n\n    alphabet = _alphabet_;\n    reset();\n}\n\nfunction characters(_alphabet_) {\n    setCharacters(_alphabet_);\n    return alphabet;\n}\n\nfunction setSeed(seed) {\n    randomFromSeed.seed(seed);\n    if (previousSeed !== seed) {\n        reset();\n        previousSeed = seed;\n    }\n}\n\nfunction shuffle() {\n    if (!alphabet) {\n        setCharacters(ORIGINAL);\n    }\n\n    var sourceArray = alphabet.split('');\n    var targetArray = [];\n    var r = randomFromSeed.nextValue();\n    var characterIndex;\n\n    while (sourceArray.length > 0) {\n        r = randomFromSeed.nextValue();\n        characterIndex = Math.floor(r * sourceArray.length);\n        targetArray.push(sourceArray.splice(characterIndex, 1)[0]);\n    }\n    return targetArray.join('');\n}\n\nfunction getShuffled() {\n    if (shuffled) {\n        return shuffled;\n    }\n    shuffled = shuffle();\n    return shuffled;\n}\n\n/**\n * lookup shuffled letter\n * @param index\n * @returns {string}\n */\nfunction lookup(index) {\n    var alphabetShuffled = getShuffled();\n    return alphabetShuffled[index];\n}\n\nfunction get () {\n  return alphabet || ORIGINAL;\n}\n\nmodule.exports = {\n    get: get,\n    characters: characters,\n    seed: setSeed,\n    lookup: lookup,\n    shuffled: getShuffled\n};\n","'use strict';\n\nvar crypto = typeof window === 'object' && (window.crypto || window.msCrypto); // IE 11 uses window.msCrypto\n\nvar randomByte;\n\nif (!crypto || !crypto.getRandomValues) {\n    randomByte = function(size) {\n        var bytes = [];\n        for (var i = 0; i < size; i++) {\n            bytes.push(Math.floor(Math.random() * 256));\n        }\n        return bytes;\n    };\n} else {\n    randomByte = function(size) {\n        return crypto.getRandomValues(new Uint8Array(size));\n    };\n}\n\nmodule.exports = randomByte;\n","// This file replaces `format.js` in bundlers like webpack or Rollup,\n// according to `browser` config in `package.json`.\n\nmodule.exports = function (random, alphabet, size) {\n  // We can’t use bytes bigger than the alphabet. To make bytes values closer\n  // to the alphabet, we apply bitmask on them. We look for the closest\n  // `2 ** x - 1` number, which will be bigger than alphabet size. If we have\n  // 30 symbols in the alphabet, we will take 31 (00011111).\n  // We do not use faster Math.clz32, because it is not available in browsers.\n  var mask = (2 << Math.log(alphabet.length - 1) / Math.LN2) - 1\n  // Bitmask is not a perfect solution (in our example it will pass 31 bytes,\n  // which is bigger than the alphabet). As a result, we will need more bytes,\n  // than ID size, because we will refuse bytes bigger than the alphabet.\n\n  // Every hardware random generator call is costly,\n  // because we need to wait for entropy collection. This is why often it will\n  // be faster to ask for few extra bytes in advance, to avoid additional calls.\n\n  // Here we calculate how many random bytes should we call in advance.\n  // It depends on ID length, mask / alphabet size and magic number 1.6\n  // (which was selected according benchmarks).\n\n  // -~f => Math.ceil(f) if n is float number\n  // -~i => i + 1 if n is integer number\n  var step = -~(1.6 * mask * size / alphabet.length)\n  var id = ''\n\n  while (true) {\n    var bytes = random(step)\n    // Compact alternative for `for (var i = 0; i < step; i++)`\n    var i = step\n    while (i--) {\n      // If random byte is bigger than alphabet even after bitmask,\n      // we refuse it by `|| ''`.\n      id += alphabet[bytes[i] & mask] || ''\n      // More compact than `id.length + 1 === size`\n      if (id.length === +size) return id\n    }\n  }\n}\n","'use strict';\n\nvar alphabet = require('./alphabet');\nvar random = require('./random/random-byte');\nvar format = require('nanoid/format');\n\nfunction generate(number) {\n    var loopCounter = 0;\n    var done;\n\n    var str = '';\n\n    while (!done) {\n        str = str + format(random, alphabet.get(), 1);\n        done = number < (Math.pow(16, loopCounter + 1 ) );\n        loopCounter++;\n    }\n    return str;\n}\n\nmodule.exports = generate;\n","'use strict';\n\nvar generate = require('./generate');\nvar alphabet = require('./alphabet');\n\n// Ignore all milliseconds before a certain time to reduce the size of the date entropy without sacrificing uniqueness.\n// This number should be updated every year or so to keep the generated id short.\n// To regenerate `new Date() - 0` and bump the version. Always bump the version!\nvar REDUCE_TIME = 1567752802062;\n\n// don't change unless we change the algos or REDUCE_TIME\n// must be an integer and less than 16\nvar version = 7;\n\n// Counter is used when shortid is called multiple times in one second.\nvar counter;\n\n// Remember the last time shortid was called in case counter is needed.\nvar previousSeconds;\n\n/**\n * Generate unique id\n * Returns string id\n */\nfunction build(clusterWorkerId) {\n    var str = '';\n\n    var seconds = Math.floor((Date.now() - REDUCE_TIME) * 0.001);\n\n    if (seconds === previousSeconds) {\n        counter++;\n    } else {\n        counter = 0;\n        previousSeconds = seconds;\n    }\n\n    str = str + generate(version);\n    str = str + generate(clusterWorkerId);\n    if (counter > 0) {\n        str = str + generate(counter);\n    }\n    str = str + generate(seconds);\n    return str;\n}\n\nmodule.exports = build;\n","'use strict';\nvar alphabet = require('./alphabet');\n\nfunction isShortId(id) {\n    if (!id || typeof id !== 'string' || id.length < 6 ) {\n        return false;\n    }\n\n    var nonAlphabetic = new RegExp('[^' +\n      alphabet.get().replace(/[|\\\\{}()[\\]^$+*?.-]/g, '\\\\$&') +\n    ']');\n    return !nonAlphabetic.test(id);\n}\n\nmodule.exports = isShortId;\n","'use strict';\n\nvar alphabet = require('./alphabet');\nvar build = require('./build');\nvar isValid = require('./is-valid');\n\n// if you are using cluster or multiple servers use this to make each instance\n// has a unique value for worker\n// Note: I don't know if this is automatically set when using third\n// party cluster solutions such as pm2.\nvar clusterWorkerId = require('./util/cluster-worker-id') || 0;\n\n/**\n * Set the seed.\n * Highly recommended if you don't want people to try to figure out your id schema.\n * exposed as shortid.seed(int)\n * @param seed Integer value to seed the random alphabet.  ALWAYS USE THE SAME SEED or you might get overlaps.\n */\nfunction seed(seedValue) {\n    alphabet.seed(seedValue);\n    return module.exports;\n}\n\n/**\n * Set the cluster worker or machine id\n * exposed as shortid.worker(int)\n * @param workerId worker must be positive integer.  Number less than 16 is recommended.\n * returns shortid module so it can be chained.\n */\nfunction worker(workerId) {\n    clusterWorkerId = workerId;\n    return module.exports;\n}\n\n/**\n *\n * sets new characters to use in the alphabet\n * returns the shuffled alphabet\n */\nfunction characters(newCharacters) {\n    if (newCharacters !== undefined) {\n        alphabet.characters(newCharacters);\n    }\n\n    return alphabet.shuffled();\n}\n\n/**\n * Generate unique id\n * Returns string id\n */\nfunction generate() {\n  return build(clusterWorkerId);\n}\n\n// Export all other functions as properties of the generate function\nmodule.exports = generate;\nmodule.exports.generate = generate;\nmodule.exports.seed = seed;\nmodule.exports.worker = worker;\nmodule.exports.characters = characters;\nmodule.exports.isValid = isValid;\n","'use strict';\nmodule.exports = require('./lib/index');\n","import { namespaces } from '../src/helpers';\n\nconst generateDocumentTemplate = (width, height, orientation, margins) => {\n  return `\n  <?xml version=\"1.0\" encoding=\"UTF-8\" standalone=\"yes\"?>\n\n    <w:document\n        xmlns:a=\"${namespaces.a}\"\n        xmlns:cdr=\"${namespaces.cdr}\"\n        xmlns:o=\"${namespaces.o}\"\n        xmlns:pic=\"${namespaces.pic}\"\n        xmlns:r=\"${namespaces.r}\"\n        xmlns:v=\"${namespaces.v}\"\n        xmlns:ve=\"${namespaces.ve}\"\n        xmlns:vt=\"${namespaces.vt}\"\n        xmlns:w=\"${namespaces.w}\"\n        xmlns:w10=\"${namespaces.w10}\"\n        xmlns:wp=\"${namespaces.wp}\"\n        xmlns:wne=\"${namespaces.wne}\"\n        >\n        <w:body>\n            <w:sectPr>\n                <w:pgSz w:w=\"${width}\" w:h=\"${height}\" w:orient=\"${orientation}\" />\n                <w:pgMar w:top=\"${margins.top}\"\n                        w:right=\"${margins.right}\"\n                        w:bottom=\"${margins.bottom}\"\n                        w:left=\"${margins.left}\"\n                        w:header=\"${margins.header}\"\n                        w:footer=\"${margins.footer}\"\n                        w:gutter=\"${margins.gutter}\"/>\n            </w:sectPr>\n        </w:body>\n    </w:document>\n  `;\n};\n\nexport default generateDocumentTemplate;\n","import { create, fragment } from 'xmlbuilder2';\nimport * as shortid from 'shortid';\n\nimport {\n  generateCoreXML,\n  generateStylesXML,\n  generateNumberingXMLTemplate,\n  generateThemeXML,\n  documentRelsXML as documentRelsXMLString,\n  settingsXML as settingsXMLString,\n  webSettingsXML as webSettingsXMLString,\n  contentTypesXML as contentTypesXMLString,\n  fontTableXML as fontTableXMLString,\n  genericRelsXML as genericRelsXMLString,\n} from './schemas';\nimport { convertVTreeToXML, namespaces } from './helpers';\nimport generateDocumentTemplate from '../template/document.template';\n\nconst landscapeMargins = {\n  top: 1800,\n  right: 1440,\n  bottom: 1800,\n  left: 1440,\n  header: 720,\n  footer: 720,\n  gutter: 0,\n};\n\nconst portraitMargins = {\n  top: 1440,\n  right: 1800,\n  bottom: 1440,\n  left: 1800,\n  header: 720,\n  footer: 720,\n  gutter: 0,\n};\n\nclass DocxDocument {\n  constructor({\n    zip,\n    htmlString,\n    orientation,\n    margins,\n    title,\n    subject,\n    creator,\n    keywords,\n    description,\n    lastModifiedBy,\n    revision,\n    createdAt,\n    modifiedAt,\n    headerType,\n    header,\n    footerType,\n    footer,\n    font,\n    fontSize,\n    complexScriptFontSize,\n    table,\n    pageNumber,\n    skipFirstHeaderFooter,\n    lineNumber,\n    lineNumberOptions,\n  }) {\n    this.zip = zip;\n    this.htmlString = htmlString;\n    this.orientation = orientation;\n    this.width = orientation === 'landscape' ? 15840 : 12240;\n    this.height = orientation === 'landscape' ? 12240 : 15840;\n    this.margins =\n      // eslint-disable-next-line no-nested-ternary\n      margins && Object.keys(margins).length\n        ? margins\n        : orientation === 'landscape'\n        ? landscapeMargins\n        : portraitMargins;\n    this.availableDocumentSpace = this.width - this.margins.left - this.margins.right;\n    this.title = title || '';\n    this.subject = subject || '';\n    this.creator = creator || 'html-to-docx';\n    this.keywords = keywords || ['html-to-docx'];\n    this.description = description || '';\n    this.lastModifiedBy = lastModifiedBy || 'html-to-docx';\n    this.revision = revision || 1;\n    this.createdAt = createdAt || new Date();\n    this.modifiedAt = modifiedAt || new Date();\n    this.headerType = headerType || 'default';\n    this.header = header || false;\n    this.footerType = footerType || 'default';\n    this.footer = footer || false;\n    this.font = font || 'Times New Roman';\n    this.fontSize = fontSize || 22;\n    this.complexScriptFontSize = complexScriptFontSize || 22;\n    this.tableRowCantSplit = (table && table.row && table.row.cantSplit) || false;\n    this.pageNumber = pageNumber || false;\n    this.skipFirstHeaderFooter = skipFirstHeaderFooter || false;\n    this.lineNumber = lineNumber ? lineNumberOptions : null;\n\n    this.lastNumberingId = 0;\n    this.lastMediaId = 0;\n    this.lastHeaderId = 0;\n    this.lastFooterId = 0;\n    this.stylesObjects = [];\n    this.numberingObjects = [];\n    this.relationshipFilename = 'document';\n    this.relationships = [{ fileName: 'document', lastRelsId: 4, rels: [] }];\n    this.mediaFiles = [];\n    this.headerObjects = [];\n    this.footerObjects = [];\n    this.documentXML = null;\n\n    this.generateContentTypesXML = this.generateContentTypesXML.bind(this);\n    this.generateCoreXML = this.generateCoreXML.bind(this);\n    this.generateDocumentXML = this.generateDocumentXML.bind(this);\n    this.generateSettingsXML = this.generateSettingsXML.bind(this);\n    this.generateWebSettingsXML = this.generateWebSettingsXML.bind(this);\n    this.generateStylesXML = this.generateStylesXML.bind(this);\n    this.generateFontTableXML = this.generateFontTableXML.bind(this);\n    this.generateThemeXML = this.generateThemeXML.bind(this);\n    this.generateNumberingXML = this.generateNumberingXML.bind(this);\n    this.generateRelsXML = this.generateRelsXML.bind(this);\n    this.createMediaFile = this.createMediaFile.bind(this);\n    this.createDocumentRelationships = this.createDocumentRelationships.bind(this);\n    this.generateHeaderXML = this.generateHeaderXML.bind(this);\n    this.generateFooterXML = this.generateFooterXML.bind(this);\n  }\n\n  generateContentTypesXML() {\n    const contentTypesXML = create({ encoding: 'UTF-8', standalone: true }, contentTypesXMLString);\n\n    if (this.headerObjects && Array.isArray(this.headerObjects) && this.headerObjects.length) {\n      this.headerObjects.forEach(\n        // eslint-disable-next-line array-callback-return\n        ({ headerId }) => {\n          const contentTypesFragment = fragment({\n            defaultNamespace: {\n              ele: 'http://schemas.openxmlformats.org/package/2006/content-types',\n            },\n          })\n            .ele('Override')\n            .att('PartName', `/word/header${headerId}.xml`)\n            .att(\n              'ContentType',\n              'application/vnd.openxmlformats-officedocument.wordprocessingml.header+xml'\n            )\n            .up();\n          contentTypesXML.root().import(contentTypesFragment);\n        }\n      );\n    }\n    if (this.footerObjects && Array.isArray(this.footerObjects) && this.footerObjects.length) {\n      this.footerObjects.forEach(\n        // eslint-disable-next-line array-callback-return\n        ({ footerId }) => {\n          const contentTypesFragment = fragment({\n            defaultNamespace: {\n              ele: 'http://schemas.openxmlformats.org/package/2006/content-types',\n            },\n          })\n            .ele('Override')\n            .att('PartName', `/word/footer${footerId}.xml`)\n            .att(\n              'ContentType',\n              'application/vnd.openxmlformats-officedocument.wordprocessingml.footer+xml'\n            )\n            .up();\n          contentTypesXML.root().import(contentTypesFragment);\n        }\n      );\n    }\n\n    return contentTypesXML.toString({ prettyPrint: true });\n  }\n\n  generateCoreXML() {\n    const coreXML = create(\n      { encoding: 'UTF-8', standalone: true },\n      generateCoreXML(\n        this.title,\n        this.subject,\n        this.creator,\n        this.keywords,\n        this.description,\n        this.lastModifiedBy,\n        this.revision,\n        this.createdAt,\n        this.modifiedAt\n      )\n    );\n\n    return coreXML.toString({ prettyPrint: true });\n  }\n\n  generateDocumentXML() {\n    const documentXML = create(\n      { encoding: 'UTF-8', standalone: true },\n      generateDocumentTemplate(this.width, this.height, this.orientation, this.margins)\n    );\n    documentXML.root().first().import(this.documentXML);\n\n    if (\n      this.header &&\n      this.headerObjects &&\n      Array.isArray(this.headerObjects) &&\n      this.headerObjects.length\n    ) {\n      const headerXmlFragment = fragment();\n\n      this.headerObjects.forEach(\n        // eslint-disable-next-line array-callback-return\n        ({ relationshipId, type }) => {\n          const headerFragment = fragment({\n            namespaceAlias: {\n              w: namespaces.w,\n              r: namespaces.r,\n            },\n          })\n            .ele('@w', 'headerReference')\n            .att('@r', 'id', `rId${relationshipId}`)\n            .att('@w', 'type', type)\n            .up();\n          headerXmlFragment.import(headerFragment);\n        }\n      );\n\n      documentXML.root().first().first().import(headerXmlFragment);\n    }\n    if (\n      this.footer &&\n      this.footerObjects &&\n      Array.isArray(this.footerObjects) &&\n      this.footerObjects.length\n    ) {\n      const footerXmlFragment = fragment();\n\n      this.footerObjects.forEach(\n        // eslint-disable-next-line array-callback-return\n        ({ relationshipId, type }) => {\n          const footerFragment = fragment({\n            namespaceAlias: {\n              w: namespaces.w,\n              r: namespaces.r,\n            },\n          })\n            .ele('@w', 'footerReference')\n            .att('@r', 'id', `rId${relationshipId}`)\n            .att('@w', 'type', type)\n            .up();\n          footerXmlFragment.import(footerFragment);\n        }\n      );\n\n      documentXML.root().first().first().import(footerXmlFragment);\n    }\n    if ((this.header || this.footer) && this.skipFirstHeaderFooter) {\n      const titlePageFragment = fragment({\n        namespaceAlias: {\n          w: namespaces.w,\n        },\n      }).ele('@w', 'titlePg');\n\n      documentXML.root().first().first().import(titlePageFragment);\n    }\n    if (this.lineNumber) {\n      const { countBy, start, restart } = this.lineNumber;\n      const lineNumberFragment = fragment({\n        namespaceAlias: {\n          w: namespaces.w,\n        },\n      })\n        .ele('@w', 'lnNumType')\n        .att('@w', 'countBy', countBy)\n        .att('@w', 'start', start)\n        .att('@w', 'restart', restart);\n      documentXML.root().first().first().import(lineNumberFragment);\n    }\n\n    return documentXML.toString({ prettyPrint: true });\n  }\n\n  // eslint-disable-next-line class-methods-use-this\n  generateSettingsXML() {\n    const settingsXML = create({ encoding: 'UTF-8', standalone: true }, settingsXMLString);\n\n    return settingsXML.toString({ prettyPrint: true });\n  }\n\n  // eslint-disable-next-line class-methods-use-this\n  generateWebSettingsXML() {\n    const webSettingsXML = create({ encoding: 'UTF-8', standalone: true }, webSettingsXMLString);\n\n    return webSettingsXML.toString({ prettyPrint: true });\n  }\n\n  // eslint-disable-next-line class-methods-use-this\n  generateStylesXML() {\n    const stylesXML = create(\n      { encoding: 'UTF-8', standalone: true },\n      generateStylesXML(this.font, this.fontSize, this.complexScriptFontSize)\n    );\n\n    return stylesXML.toString({ prettyPrint: true });\n  }\n\n  // eslint-disable-next-line class-methods-use-this\n  generateFontTableXML() {\n    const fontTableXML = create({ encoding: 'UTF-8', standalone: true }, fontTableXMLString);\n\n    return fontTableXML.toString({ prettyPrint: true });\n  }\n\n  // eslint-disable-next-line class-methods-use-this\n  generateThemeXML() {\n    const themeXml = create({ encoding: 'UTF-8', standalone: true }, generateThemeXML(this.font));\n\n    return themeXml.toString({ prettyPrint: true });\n  }\n\n  generateNumberingXML() {\n    const numberingXML = create(\n      { encoding: 'UTF-8', standalone: true },\n      generateNumberingXMLTemplate()\n    );\n\n    const abstractNumberingFragments = fragment();\n    const numberingFragments = fragment();\n\n    this.numberingObjects.forEach(\n      // eslint-disable-next-line array-callback-return\n      ({ numberingId, listElements }) => {\n        const abstractNumberingFragment = fragment({\n          namespaceAlias: { w: namespaces.w },\n        })\n          .ele('@w', 'abstractNum')\n          .att('@w', 'abstractNumId', String(numberingId))\n          .ele('@w', 'multiLevelType')\n          .att('@w', 'val', 'hybridMultilevel')\n          .up();\n\n        listElements\n          .filter((value, index, self) => {\n            return self.findIndex((v) => v.level === value.level) === index;\n          })\n          .forEach(({ level, type }) => {\n            const levelFragment = fragment({\n              namespaceAlias: { w: namespaces.w },\n            })\n              .ele('@w', 'lvl')\n              .att('@w', 'ilvl', level)\n              .ele('@w', 'start')\n              .att('@w', 'val', '1')\n              .up()\n              .ele('@w', 'numFmt')\n              .att('@w', 'val', type === 'ol' ? 'decimal' : 'bullet')\n              .up()\n              .ele('@w', 'lvlText')\n              .att('@w', 'val', type === 'ol' ? `%${level + 1}` : '')\n              .up()\n              .ele('@w', 'lvlJc')\n              .att('@w', 'val', 'left')\n              .up()\n              .ele('@w', 'pPr')\n              .ele('@w', 'tabs')\n              .ele('@w', 'tab')\n              .att('@w', 'val', 'num')\n              .att('@w', 'pos', (level + 1) * 720)\n              .up()\n              .up()\n              .ele('@w', 'ind')\n              .att('@w', 'left', (level + 1) * 720)\n              .att('@w', 'hanging', 360)\n              .up()\n              .up()\n              .up();\n\n            if (type === 'ul') {\n              const runPropertiesFragment = fragment({\n                namespaceAlias: { w: namespaces.w },\n              })\n                .ele('@w', 'rPr')\n                .ele('@w', 'rFonts')\n                .att('@w', 'ascii', 'Wingdings')\n                .att('@w', 'hAnsi', 'Wingdings')\n                .att('@w', 'hint', 'default')\n                .up()\n                .up();\n\n              levelFragment.last().import(runPropertiesFragment);\n            }\n\n            abstractNumberingFragment.import(levelFragment);\n          });\n\n        abstractNumberingFragment.up();\n\n        const numberingFragment = fragment({\n          namespaceAlias: { w: namespaces.w },\n        })\n          .ele('@w', 'num')\n          .att('@w', 'numId', String(numberingId))\n          .ele('@w', 'abstractNumId')\n          .att('@w', 'val', String(numberingId))\n          .up()\n          .up();\n\n        abstractNumberingFragments.import(abstractNumberingFragment);\n        numberingFragments.import(numberingFragment);\n      }\n    );\n\n    numberingXML.root().import(abstractNumberingFragments);\n    numberingXML.root().import(numberingFragments);\n\n    return numberingXML.toString({ prettyPrint: true });\n  }\n\n  // eslint-disable-next-line class-methods-use-this\n  appendRelationships(xmlFragment, relationships) {\n    relationships.forEach(\n      // eslint-disable-next-line array-callback-return\n      ({ relationshipId, type, target, targetMode }) => {\n        const relationshipFragment = fragment({\n          defaultNamespace: { ele: 'http://schemas.openxmlformats.org/package/2006/relationships' },\n        })\n          .ele('Relationship')\n          .att('Id', `rId${relationshipId}`)\n          .att('Type', type)\n          .att('Target', target)\n          .att('TargetMode', targetMode)\n          .up();\n\n        xmlFragment.import(relationshipFragment);\n      }\n    );\n  }\n\n  generateRelsXML() {\n    const relationshipXMLStrings = this.relationships.map(({ fileName, rels }) => {\n      let xmlFragment;\n      if (fileName === 'document') {\n        xmlFragment = create({ encoding: 'UTF-8', standalone: true }, documentRelsXMLString);\n      } else {\n        xmlFragment = create({ encoding: 'UTF-8', standalone: true }, genericRelsXMLString);\n      }\n      this.appendRelationships(xmlFragment.root(), rels);\n\n      return {\n        fileName,\n        xmlString: xmlFragment.toString({ prettyPrint: true }),\n      };\n    });\n\n    return relationshipXMLStrings;\n  }\n\n  createNumbering(listElements) {\n    this.lastNumberingId += 1;\n    this.numberingObjects.push({ numberingId: this.lastNumberingId, listElements });\n\n    return this.lastNumberingId;\n  }\n\n  createMediaFile(base64String) {\n    // eslint-disable-next-line no-useless-escape\n    const matches = base64String.match(/^data:([A-Za-z-+\\/]+);base64,(.+)$/);\n    if (matches.length !== 3) {\n      throw new Error('Invalid base64 string');\n    }\n\n    const base64FileContent = matches[2];\n    // matches array contains file type in base64 format - image/jpeg and base64 stringified data\n    const fileExtension =\n      matches[1].match(/\\/(.*?)$/)[1] === 'octet-stream' ? 'png' : matches[1].match(/\\/(.*?)$/)[1];\n\n    const fileNameWithExtension = `image-${shortid.generate()}.${fileExtension}`;\n\n    this.lastMediaId += 1;\n\n    return { id: this.lastMediaId, fileContent: base64FileContent, fileNameWithExtension };\n  }\n\n  createDocumentRelationships(fileName = 'document', type, target, targetMode = 'External') {\n    let relationshipObject = this.relationships.find(\n      (relationship) => relationship.fileName === fileName\n    );\n    let lastRelsId = 1;\n    if (relationshipObject) {\n      lastRelsId = relationshipObject.lastRelsId + 1;\n      relationshipObject.lastRelsId = lastRelsId;\n    } else {\n      relationshipObject = { fileName, lastRelsId, rels: [] };\n      this.relationships.push(relationshipObject);\n    }\n    let relationshipType;\n    switch (type) {\n      case 'hyperlink':\n        relationshipType = namespaces.hyperlinks;\n        break;\n      case 'image':\n        relationshipType = namespaces.images;\n        break;\n      case 'header':\n        relationshipType = namespaces.headers;\n        break;\n      case 'footer':\n        relationshipType = namespaces.footers;\n        break;\n      case 'theme':\n        relationshipType = namespaces.themes;\n        break;\n      default:\n        break;\n    }\n\n    relationshipObject.rels.push({\n      relationshipId: lastRelsId,\n      type: relationshipType,\n      target,\n      targetMode,\n    });\n\n    return lastRelsId;\n  }\n\n  generateHeaderXML(vTree) {\n    const headerXML = create({\n      encoding: 'UTF-8',\n      standalone: true,\n      namespaceAlias: {\n        w: namespaces.w,\n        ve: namespaces.ve,\n        o: namespaces.o,\n        r: namespaces.r,\n        v: namespaces.v,\n        wp: namespaces.wp,\n        w10: namespaces.w10,\n      },\n    }).ele('@w', 'hdr');\n\n    const XMLFragment = fragment();\n    convertVTreeToXML(this, vTree, XMLFragment);\n    headerXML.root().import(XMLFragment);\n\n    this.lastHeaderId += 1;\n\n    return { headerId: this.lastHeaderId, headerXML };\n  }\n\n  generateFooterXML(vTree) {\n    const footerXML = create({\n      encoding: 'UTF-8',\n      standalone: true,\n      namespaceAlias: {\n        w: namespaces.w,\n        ve: namespaces.ve,\n        o: namespaces.o,\n        r: namespaces.r,\n        v: namespaces.v,\n        wp: namespaces.wp,\n        w10: namespaces.w10,\n      },\n    }).ele('@w', 'ftr');\n\n    const XMLFragment = fragment();\n    convertVTreeToXML(this, vTree, XMLFragment);\n    if (XMLFragment.first().node.tagName === 'p' && this.pageNumber) {\n      const fieldSimpleFragment = fragment({\n        namespaceAlias: {\n          w: namespaces.w,\n        },\n      })\n        .ele('@w', 'fldSimple')\n        .att('@w', 'instr', 'PAGE')\n        .ele('@w', 'r')\n        .up()\n        .up();\n      XMLFragment.first().import(fieldSimpleFragment);\n    }\n    footerXML.root().import(XMLFragment);\n\n    this.lastFooterId += 1;\n\n    return { footerId: this.lastFooterId, footerXML };\n  }\n}\n\nexport default DocxDocument;\n","const contentTypesXML = `\n    <?xml version=\"1.0\" encoding=\"UTF-8\" standalone=\"yes\"?>\n\n    <Types xmlns=\"http://schemas.openxmlformats.org/package/2006/content-types\">\n        <Default Extension=\"rels\" ContentType=\"application/vnd.openxmlformats-package.relationships+xml\" />\n        <Default Extension=\"jpeg\" ContentType=\"image/jpeg\"/>\n        <Default Extension=\"png\" ContentType=\"image/png\"/>\n        <Default Extension=\"xml\" ContentType=\"application/xml\"/>\n        <Override PartName=\"/_rels/.rels\" ContentType=\"application/vnd.openxmlformats-package.relationships+xml\"/>\n        <Override PartName=\"/word/_rels/document.xml.rels\" ContentType=\"application/vnd.openxmlformats-package.relationships+xml\"/>\n        <Override PartName=\"/word/document.xml\" ContentType=\"application/vnd.openxmlformats-officedocument.wordprocessingml.document.main+xml\"/>\n        <Override PartName=\"/word/styles.xml\" ContentType=\"application/vnd.openxmlformats-officedocument.wordprocessingml.styles+xml\"/>\n        <Override PartName=\"/word/numbering.xml\" ContentType=\"application/vnd.openxmlformats-officedocument.wordprocessingml.numbering+xml\"/>\n        <Override PartName=\"/word/theme/theme1.xml\" ContentType=\"application/vnd.openxmlformats-officedocument.theme+xml\"/>\n        <Override PartName=\"/word/fontTable.xml\" ContentType=\"application/vnd.openxmlformats-officedocument.wordprocessingml.fontTable+xml\"/>\n        <Override PartName=\"/docProps/core.xml\" ContentType=\"application/vnd.openxmlformats-package.core-properties+xml\"/>\n        <Override PartName=\"/word/settings.xml\" ContentType=\"application/vnd.openxmlformats-officedocument.wordprocessingml.settings+xml\"/>\n        <Override PartName=\"/word/webSettings.xml\" ContentType=\"application/vnd.openxmlformats-officedocument.wordprocessingml.webSettings+xml\"/>\n    </Types>\n`;\n\nexport default contentTypesXML;\n","import { namespaces } from '../helpers';\n\nconst generateStylesXML = (font = 'Times New Roman', fontSize = 22, complexScriptFontSize = 22) => {\n  return `\n  <?xml version=\"1.0\" encoding=\"UTF-8\" standalone=\"yes\"?>\n\n  <w:styles xmlns:w=\"${namespaces.w}\" xmlns:r=\"${namespaces.r}\">\n\t<w:docDefaults>\n\t  <w:rPrDefault>\n\t\t<w:rPr>\n\t\t  <w:rFonts w:ascii=\"${font}\" w:eastAsiaTheme=\"minorHAnsi\" w:hAnsiTheme=\"minorHAnsi\" w:cstheme=\"minorBidi\" />\n\t\t  <w:sz w:val=\"${fontSize}\" />\n\t\t  <w:szCs w:val=\"${complexScriptFontSize}\" />\n\t\t  <w:lang w:val=\"en-US\" w:eastAsia=\"en-US\" w:bidi=\"ar-SA\" />\n\t\t</w:rPr>\n\t  </w:rPrDefault>\n\t  <w:pPrDefault>\n\t\t<w:pPr>\n\t\t  <w:spacing w:after=\"120\" w:line=\"240\" w:lineRule=\"atLeast\" />\n\t\t</w:pPr>\n\t  </w:pPrDefault>\n\t</w:docDefaults>\n\t<w:style w:type=\"character\" w:styleId=\"Hyperlink\">\n\t  <w:name w:val=\"Hyperlink\" />\n\t  <w:rPr>\n\t\t<w:color w:val=\"0000FF\" />\n\t\t<w:u w:val=\"single\" />\n\t  </w:rPr>\n\t</w:style>\n\t<w:style w:type=\"paragraph\" w:styleId=\"Heading1\">\n\t  <w:name w:val=\"heading 1\" />\n\t  <w:basedOn w:val=\"Normal\" />\n\t  <w:next w:val=\"Normal\" />\n\t  <w:uiPriority w:val=\"9\" />\n\t  <w:qFormat />\n\t  <w:pPr>\n\t\t<w:keepNext />\n\t\t<w:keepLines />\n\t\t<w:spacing w:before=\"480\" />\n\t\t<w:outlineLvl w:val=\"0\" />\n\t  </w:pPr>\n\t  <w:rPr>\n\t\t<w:b />\n\t\t<w:sz w:val=\"48\" />\n\t\t<w:szCs w:val=\"48\" />\n\t  </w:rPr>\n\t</w:style>\n\t<w:style w:type=\"paragraph\" w:styleId=\"Heading2\">\n\t  <w:name w:val=\"heading 2\" />\n\t  <w:basedOn w:val=\"Normal\" />\n\t  <w:next w:val=\"Normal\" />\n\t  <w:uiPriority w:val=\"9\" />\n\t  <w:unhideWhenUsed />\n\t  <w:qFormat />\n\t  <w:pPr>\n\t\t<w:keepNext />\n\t\t<w:keepLines />\n\t\t<w:spacing w:before=\"360\" w:after=\"80\" />\n\t\t<w:outlineLvl w:val=\"1\" />\n\t  </w:pPr>\n\t  <w:rPr>\n\t\t<w:b />\n\t\t<w:sz w:val=\"36\" />\n\t\t<w:szCs w:val=\"36\" />\n\t  </w:rPr>\n\t</w:style>\n\t<w:style w:type=\"paragraph\" w:styleId=\"Heading3\">\n\t  <w:name w:val=\"heading 3\" />\n\t  <w:basedOn w:val=\"Normal\" />\n\t  <w:next w:val=\"Normal\" />\n\t  <w:uiPriority w:val=\"9\" />\n\t  <w:semiHidden />\n\t  <w:unhideWhenUsed />\n\t  <w:qFormat />\n\t  <w:pPr>\n\t\t<w:keepNext />\n\t\t<w:keepLines />\n\t\t<w:spacing w:before=\"280\" w:after=\"80\" />\n\t\t<w:outlineLvl w:val=\"2\" />\n\t  </w:pPr>\n\t  <w:rPr>\n\t\t<w:b />\n\t\t<w:sz w:val=\"28\" />\n\t\t<w:szCs w:val=\"28\" />\n\t  </w:rPr>\n\t</w:style>\n\t<w:style w:type=\"paragraph\" w:styleId=\"Heading4\">\n\t  <w:name w:val=\"heading 4\" />\n\t  <w:basedOn w:val=\"Normal\" />\n\t  <w:next w:val=\"Normal\" />\n\t  <w:uiPriority w:val=\"9\" />\n\t  <w:semiHidden />\n\t  <w:unhideWhenUsed />\n\t  <w:qFormat />\n\t  <w:pPr>\n\t\t<w:keepNext />\n\t\t<w:keepLines />\n\t\t<w:spacing w:before=\"240\" w:after=\"40\" />\n\t\t<w:outlineLvl w:val=\"3\" />\n\t  </w:pPr>\n\t  <w:rPr>\n\t\t<w:b />\n\t\t<w:sz w:val=\"24\" />\n\t\t<w:szCs w:val=\"24\" />\n\t  </w:rPr>\n\t</w:style>\n\t<w:style w:type=\"paragraph\" w:styleId=\"Heading5\">\n\t  <w:name w:val=\"heading 5\" />\n\t  <w:basedOn w:val=\"Normal\" />\n\t  <w:next w:val=\"Normal\" />\n\t  <w:uiPriority w:val=\"9\" />\n\t  <w:semiHidden />\n\t  <w:unhideWhenUsed />\n\t  <w:qFormat />\n\t  <w:pPr>\n\t\t<w:keepNext />\n\t\t<w:keepLines />\n\t\t<w:spacing w:before=\"220\" w:after=\"40\" />\n\t\t<w:outlineLvl w:val=\"4\" />\n\t  </w:pPr>\n\t  <w:rPr>\n\t\t<w:b />\n\t  </w:rPr>\n\t</w:style>\n\t<w:style w:type=\"paragraph\" w:styleId=\"Heading6\">\n\t  <w:name w:val=\"heading 6\" />\n\t  <w:basedOn w:val=\"Normal\" />\n\t  <w:next w:val=\"Normal\" />\n\t  <w:uiPriority w:val=\"9\" />\n\t  <w:semiHidden />\n\t  <w:unhideWhenUsed />\n\t  <w:qFormat />\n\t  <w:pPr>\n\t\t<w:keepNext />\n\t\t<w:keepLines />\n\t\t<w:spacing w:before=\"200\" w:after=\"40\" />\n\t\t<w:outlineLvl w:val=\"5\" />\n\t  </w:pPr>\n\t  <w:rPr>\n\t\t<w:b />\n\t\t<w:sz w:val=\"20\" />\n\t\t<w:szCs w:val=\"20\" />\n\t  </w:rPr>\n\t</w:style>\n  </w:styles>\n  `;\n};\n\nexport default generateStylesXML;\n","const generateThemeXML = (font = 'Times New Roman') => `\n    <?xml version=\"1.0\" encoding=\"UTF-8\" standalone=\"yes\"?>\n\n    <a:theme xmlns:a=\"http://schemas.openxmlformats.org/drawingml/2006/main\" name=\"Office Theme\">\n    <a:themeElements>\n      <a:clrScheme name=\"Office\">\n        <a:dk1>\n          <a:sysClr val=\"windowText\" lastClr=\"000000\"/>\n        </a:dk1>\n        <a:lt1>\n          <a:sysClr val=\"window\" lastClr=\"FFFFFF\"/>\n        </a:lt1>\n        <a:dk2>\n          <a:srgbClr val=\"44546A\"/>\n        </a:dk2>\n        <a:lt2>\n          <a:srgbClr val=\"E7E6E6\"/>\n        </a:lt2>\n        <a:accent1>\n          <a:srgbClr val=\"4472C4\"/>\n        </a:accent1>\n        <a:accent2>\n          <a:srgbClr val=\"ED7D31\"/>\n        </a:accent2>\n        <a:accent3>\n          <a:srgbClr val=\"A5A5A5\"/>\n        </a:accent3>\n        <a:accent4>\n          <a:srgbClr val=\"FFC000\"/>\n        </a:accent4>\n        <a:accent5>\n          <a:srgbClr val=\"5B9BD5\"/>\n        </a:accent5>\n        <a:accent6>\n          <a:srgbClr val=\"70AD47\"/>\n        </a:accent6>\n        <a:hlink>\n          <a:srgbClr val=\"0563C1\"/>\n        </a:hlink>\n        <a:folHlink>\n          <a:srgbClr val=\"954F72\"/>\n        </a:folHlink>\n      </a:clrScheme>\n      <a:fontScheme name=\"Office\">\n        <a:majorFont>\n          <a:latin typeface=\"${font}\"/>\n          <a:ea typeface=\"${font}\"/>\n          <a:cs typeface=\"\"/>\n        </a:majorFont>\n        <a:minorFont>\n          <a:latin typeface=\"${font}\"/>\n          <a:ea typeface=\"${font}\"/>\n          <a:cs typeface=\"\"/>\n        </a:minorFont>\n      </a:fontScheme>\n      <a:fmtScheme name=\"Office\">\n        <a:fillStyleLst>\n          <a:solidFill>\n            <a:schemeClr val=\"phClr\"/>\n          </a:solidFill>\n          <a:gradFill rotWithShape=\"1\">\n            <a:gsLst>\n              <a:gs pos=\"0\">\n                <a:schemeClr val=\"phClr\">\n                  <a:lumMod val=\"110000\"/>\n                  <a:satMod val=\"105000\"/>\n                  <a:tint val=\"67000\"/>\n                </a:schemeClr>\n              </a:gs>\n              <a:gs pos=\"50000\">\n                <a:schemeClr val=\"phClr\">\n                  <a:lumMod val=\"105000\"/>\n                  <a:satMod val=\"103000\"/>\n                  <a:tint val=\"73000\"/>\n                </a:schemeClr>\n              </a:gs>\n              <a:gs pos=\"100000\">\n                <a:schemeClr val=\"phClr\">\n                  <a:lumMod val=\"105000\"/>\n                  <a:satMod val=\"109000\"/>\n                  <a:tint val=\"81000\"/>\n                </a:schemeClr>\n              </a:gs>\n            </a:gsLst>\n            <a:lin ang=\"5400000\" scaled=\"0\"/>\n          </a:gradFill>\n          <a:gradFill rotWithShape=\"1\">\n            <a:gsLst>\n              <a:gs pos=\"0\">\n                <a:schemeClr val=\"phClr\">\n                  <a:satMod val=\"103000\"/>\n                  <a:lumMod val=\"102000\"/>\n                  <a:tint val=\"94000\"/>\n                </a:schemeClr>\n              </a:gs>\n              <a:gs pos=\"50000\">\n                <a:schemeClr val=\"phClr\">\n                  <a:satMod val=\"110000\"/>\n                  <a:lumMod val=\"100000\"/>\n                  <a:shade val=\"100000\"/>\n                </a:schemeClr>\n              </a:gs>\n              <a:gs pos=\"100000\">\n                <a:schemeClr val=\"phClr\">\n                  <a:lumMod val=\"99000\"/>\n                  <a:satMod val=\"120000\"/>\n                  <a:shade val=\"78000\"/>\n                </a:schemeClr>\n              </a:gs>\n            </a:gsLst>\n            <a:lin ang=\"5400000\" scaled=\"0\"/>\n          </a:gradFill>\n        </a:fillStyleLst>\n        <a:lnStyleLst>\n          <a:ln w=\"6350\" cap=\"flat\" cmpd=\"sng\" algn=\"ctr\">\n            <a:solidFill>\n              <a:schemeClr val=\"phClr\"/>\n            </a:solidFill>\n            <a:prstDash val=\"solid\"/>\n            <a:miter lim=\"800000\"/>\n          </a:ln>\n          <a:ln w=\"12700\" cap=\"flat\" cmpd=\"sng\" algn=\"ctr\">\n            <a:solidFill>\n              <a:schemeClr val=\"phClr\"/>\n            </a:solidFill>\n            <a:prstDash val=\"solid\"/>\n            <a:miter lim=\"800000\"/>\n          </a:ln>\n          <a:ln w=\"19050\" cap=\"flat\" cmpd=\"sng\" algn=\"ctr\">\n            <a:solidFill>\n              <a:schemeClr val=\"phClr\"/>\n            </a:solidFill>\n            <a:prstDash val=\"solid\"/>\n            <a:miter lim=\"800000\"/>\n          </a:ln>\n        </a:lnStyleLst>\n        <a:effectStyleLst>\n          <a:effectStyle>\n            <a:effectLst/>\n          </a:effectStyle>\n          <a:effectStyle>\n            <a:effectLst/>\n          </a:effectStyle>\n          <a:effectStyle>\n            <a:effectLst>\n              <a:outerShdw blurRad=\"57150\" dist=\"19050\" dir=\"5400000\" algn=\"ctr\" rotWithShape=\"0\">\n                <a:srgbClr val=\"000000\">\n                  <a:alpha val=\"63000\"/>\n                </a:srgbClr>\n              </a:outerShdw>\n            </a:effectLst>\n          </a:effectStyle>\n        </a:effectStyleLst>\n        <a:bgFillStyleLst>\n          <a:solidFill>\n            <a:schemeClr val=\"phClr\"/>\n          </a:solidFill>\n          <a:solidFill>\n            <a:schemeClr val=\"phClr\">\n              <a:tint val=\"95000\"/>\n              <a:satMod val=\"170000\"/>\n            </a:schemeClr>\n          </a:solidFill>\n          <a:gradFill rotWithShape=\"1\">\n            <a:gsLst>\n              <a:gs pos=\"0\">\n                <a:schemeClr val=\"phClr\">\n                  <a:tint val=\"93000\"/>\n                  <a:satMod val=\"150000\"/>\n                  <a:shade val=\"98000\"/>\n                  <a:lumMod val=\"102000\"/>\n                </a:schemeClr>\n              </a:gs>\n              <a:gs pos=\"50000\">\n                <a:schemeClr val=\"phClr\">\n                  <a:tint val=\"98000\"/>\n                  <a:satMod val=\"130000\"/>\n                  <a:shade val=\"90000\"/>\n                  <a:lumMod val=\"103000\"/>\n                </a:schemeClr>\n              </a:gs>\n              <a:gs pos=\"100000\">\n                <a:schemeClr val=\"phClr\">\n                  <a:shade val=\"63000\"/>\n                  <a:satMod val=\"120000\"/>\n                </a:schemeClr>\n              </a:gs>\n            </a:gsLst>\n            <a:lin ang=\"5400000\" scaled=\"0\"/>\n          </a:gradFill>\n        </a:bgFillStyleLst>\n      </a:fmtScheme>\n    </a:themeElements>\n  </a:theme>\n`;\n\nexport default generateThemeXML;\n","import { namespaces } from '../helpers';\n\nconst generateNumberingXMLTemplate = () => {\n  return `\n        <?xml version=\"1.0\" encoding=\"UTF-8\" standalone=\"yes\"?>\n\n        <w:numbering\n        xmlns:w=\"${namespaces.w}\"\n        xmlns:ve=\"${namespaces.ve}\"\n        xmlns:o=\"${namespaces.o}\"\n        xmlns:r=\"${namespaces.r}\"\n        xmlns:v=\"${namespaces.v}\"\n        xmlns:wp=\"${namespaces.wp}\"\n        xmlns:w10=\"${namespaces.w10}\"\n        xmlns:wne=\"${namespaces.wne}\">\n        </w:numbering>\n    `;\n};\n\nexport default generateNumberingXMLTemplate;\n","const genericRelsXML = `\n    <?xml version=\"1.0\" encoding=\"UTF-8\" standalone=\"yes\"?>\n\n    <Relationships xmlns=\"http://schemas.openxmlformats.org/package/2006/relationships\">\n    </Relationships>\n`;\n\nexport default genericRelsXML;\n","import { create } from 'xmlbuilder2';\nimport VNode from 'virtual-dom/vnode/vnode';\nimport VText from 'virtual-dom/vnode/vtext';\nimport HTMLToVDOM from 'html-to-vdom';\n\nimport { relsXML } from './schemas';\nimport DocxDocument from './docx-document';\nimport { renderDocumentFile } from './helpers';\nimport {\n  pixelRegex,\n  pixelToTWIP,\n  cmRegex,\n  cmToTWIP,\n  inchRegex,\n  inchToTWIP,\n  pointRegex,\n  pointToHIP,\n} from './utils/unit-conversion';\n\nconst convertHTML = HTMLToVDOM({\n  VNode,\n  VText,\n});\n\nconst defaultDocumentOptions = {\n  orientation: 'portrait',\n  margins: {\n    top: 1440,\n    right: 1800,\n    bottom: 1440,\n    left: 1800,\n    header: 720,\n    footer: 720,\n    gutter: 0,\n  },\n  title: '',\n  subject: '',\n  creator: 'html-to-docx',\n  keywords: ['html-to-docx'],\n  description: '',\n  lastModifiedBy: 'html-to-docx',\n  revision: 1,\n  createdAt: new Date(),\n  modifiedAt: new Date(),\n  headerType: 'default',\n  header: false,\n  footerType: 'default',\n  footer: false,\n  font: 'Times New Roman',\n  fontSize: 22,\n  complexScriptFontSize: 22,\n  table: {\n    row: {\n      cantSplit: false,\n    },\n  },\n  pageNumber: false,\n  skipFirstHeaderFooter: false,\n  lineNumber: false,\n  lineNumberOptions: {\n    countBy: 1,\n    start: 0,\n    restart: 'continuous',\n  },\n};\n\nconst mergeOptions = (options, patch) => ({ ...options, ...patch });\n\nconst fixupFontSize = (fontSize) => {\n  let normalizedFontSize;\n  if (pointRegex.test(fontSize)) {\n    const matchedParts = fontSize.match(pointRegex);\n\n    normalizedFontSize = pointToHIP(matchedParts[1]);\n  } else if (fontSize) {\n    // assuming it is already in HIP\n    normalizedFontSize = fontSize;\n  } else {\n    normalizedFontSize = null;\n  }\n\n  return normalizedFontSize;\n};\n\nconst fixupMargins = (margins) => {\n  let normalizedMargins = {};\n  if (typeof margins === 'object' && margins !== null) {\n    Object.keys(margins).forEach((key) => {\n      if (pixelRegex.test(margins[key])) {\n        const matchedParts = margins[key].match(pixelRegex);\n        normalizedMargins[key] = pixelToTWIP(matchedParts[1]);\n      } else if (cmRegex.test(margins[key])) {\n        const matchedParts = margins[key].match(cmRegex);\n        normalizedMargins[key] = cmToTWIP(matchedParts[1]);\n      } else if (inchRegex.test(margins[key])) {\n        const matchedParts = margins[key].match(inchRegex);\n        normalizedMargins[key] = inchToTWIP(matchedParts[1]);\n      } else if (margins[key]) {\n        normalizedMargins[key] = margins[key];\n      } else {\n        // incase value is something like 0\n        normalizedMargins[key] = defaultDocumentOptions.margins[key];\n      }\n    });\n  } else {\n    // eslint-disable-next-line no-param-reassign\n    normalizedMargins = null;\n  }\n\n  return normalizedMargins;\n};\n\nconst normalizeDocumentOptions = (documentOptions) => {\n  const normalizedDocumentOptions = { ...documentOptions };\n  Object.keys(documentOptions).forEach((key) => {\n    // eslint-disable-next-line default-case\n    switch (key) {\n      case 'margins':\n        normalizedDocumentOptions.margins = fixupMargins(documentOptions[key]);\n        break;\n      case 'fontSize':\n      case 'complexScriptFontSize':\n        normalizedDocumentOptions[key] = fixupFontSize(documentOptions[key]);\n        break;\n    }\n  });\n\n  return normalizedDocumentOptions;\n};\n\n// Ref: https://en.wikipedia.org/wiki/Office_Open_XML_file_formats\n// http://officeopenxml.com/anatomyofOOXML.php\n// eslint-disable-next-line import/prefer-default-export\nexport function addFilesToContainer(\n  zip,\n  htmlString,\n  suppliedDocumentOptions,\n  headerHTMLString,\n  footerHTMLString\n) {\n  const normalizedDocumentOptions = normalizeDocumentOptions(suppliedDocumentOptions);\n  const documentOptions = mergeOptions(defaultDocumentOptions, normalizedDocumentOptions);\n\n  if (documentOptions.header && !headerHTMLString) {\n    // eslint-disable-next-line no-param-reassign\n    headerHTMLString = '<p></p>';\n  }\n  if (documentOptions.footer && !footerHTMLString) {\n    // eslint-disable-next-line no-param-reassign\n    footerHTMLString = '<p></p>';\n  }\n\n  const docxDocument = new DocxDocument({ zip, htmlString, ...documentOptions });\n  // Conversion to Word XML happens here\n  docxDocument.documentXML = renderDocumentFile(docxDocument);\n\n  zip\n    .folder('_rels')\n    .file(\n      '.rels',\n      create({ encoding: 'UTF-8', standalone: true }, relsXML).toString({ prettyPrint: true }),\n      { createFolders: false }\n    );\n\n  zip.folder('docProps').file('core.xml', docxDocument.generateCoreXML(), {\n    createFolders: false,\n  });\n\n  if (docxDocument.header && headerHTMLString) {\n    const vTree = convertHTML(headerHTMLString);\n\n    docxDocument.relationshipFilename = 'header1';\n    const { headerId, headerXML } = docxDocument.generateHeaderXML(vTree);\n    docxDocument.relationshipFilename = 'document';\n\n    const relationshipId = docxDocument.createDocumentRelationships(\n      docxDocument.relationshipFilename,\n      'header',\n      `header${headerId}.xml`,\n      'Internal'\n    );\n\n    zip.folder('word').file(`header${headerId}.xml`, headerXML.toString({ prettyPrint: true }), {\n      createFolders: false,\n    });\n\n    docxDocument.headerObjects.push({ headerId, relationshipId, type: docxDocument.headerType });\n  }\n  if (docxDocument.footer && footerHTMLString) {\n    const vTree = convertHTML(footerHTMLString);\n\n    docxDocument.relationshipFilename = 'footer1';\n    const { footerId, footerXML } = docxDocument.generateFooterXML(vTree);\n    docxDocument.relationshipFilename = 'document';\n\n    const relationshipId = docxDocument.createDocumentRelationships(\n      docxDocument.relationshipFilename,\n      'footer',\n      `footer${footerId}.xml`,\n      'Internal'\n    );\n\n    zip.folder('word').file(`footer${footerId}.xml`, footerXML.toString({ prettyPrint: true }), {\n      createFolders: false,\n    });\n\n    docxDocument.footerObjects.push({ footerId, relationshipId, type: docxDocument.footerType });\n  }\n\n  docxDocument.createDocumentRelationships(\n    docxDocument.relationshipFilename,\n    'theme',\n    'theme/theme1.xml',\n    'Internal'\n  );\n  zip.folder('word').folder('theme').file('theme1.xml', docxDocument.generateThemeXML(), {\n    createFolders: false,\n  });\n\n  zip\n    .folder('word')\n    .file('document.xml', docxDocument.generateDocumentXML(), {\n      createFolders: false,\n    })\n    .file('fontTable.xml', docxDocument.generateFontTableXML(), {\n      createFolders: false,\n    })\n    .file('styles.xml', docxDocument.generateStylesXML(), {\n      createFolders: false,\n    })\n    .file('numbering.xml', docxDocument.generateNumberingXML(), {\n      createFolders: false,\n    })\n    .file('settings.xml', docxDocument.generateSettingsXML(), {\n      createFolders: false,\n    })\n    .file('webSettings.xml', docxDocument.generateWebSettingsXML(), {\n      createFolders: false,\n    });\n\n  const relationshipXMLs = docxDocument.generateRelsXML();\n  if (relationshipXMLs && Array.isArray(relationshipXMLs)) {\n    relationshipXMLs.forEach(({ fileName, xmlString }) => {\n      zip.folder('word').folder('_rels').file(`${fileName}.xml.rels`, xmlString, {\n        createFolders: false,\n      });\n    });\n  }\n\n  zip.file('[Content_Types].xml', docxDocument.generateContentTypesXML(), { createFolders: false });\n\n  return zip;\n}\n","/* eslint-disable no-useless-escape */\n/* eslint-disable no-param-reassign */\nimport JSZip from 'jszip';\nimport { addFilesToContainer } from './src/html-to-docx';\n\nconst minifyHTMLString = (htmlString) => {\n  if (typeof htmlString === 'string' || htmlString instanceof String) {\n    try {\n      const minifiedHTMLString = htmlString\n        .replace(/\\n/g, '')\n        .replace(/[\\t]+\\</g, '<')\n        .replace(/\\>[\\t ]+\\</g, '><')\n        .replace(/\\>[\\t ]+$/g, '>');\n\n      return minifiedHTMLString;\n    } catch (error) {\n      return null;\n    }\n  } else {\n    return null;\n  }\n};\n\nasync function generateContainer(\n  htmlString,\n  headerHTMLString,\n  documentOptions = {},\n  footerHTMLString\n) {\n  const zip = new JSZip();\n\n  let contentHTML = htmlString;\n  let headerHTML = headerHTMLString;\n  let footerHTML = footerHTMLString;\n  if (htmlString) {\n    contentHTML = minifyHTMLString(contentHTML);\n  }\n  if (headerHTMLString) {\n    headerHTML = minifyHTMLString(headerHTML);\n  }\n  if (footerHTMLString) {\n    footerHTML = minifyHTMLString(footerHTML);\n  }\n\n  addFilesToContainer(zip, contentHTML, documentOptions, headerHTML, footerHTML);\n\n  const buffer = await zip.generateAsync({ type: 'arraybuffer' });\n  if (Object.prototype.hasOwnProperty.call(global, 'Blob')) {\n    // eslint-disable-next-line no-undef\n    return new Blob([buffer], {\n      type: 'application/vnd.openxmlformats-officedocument.wordprocessingml.document',\n    });\n  }\n  if (Object.prototype.hasOwnProperty.call(global, 'Buffer')) {\n    return Buffer.from(new Uint8Array(buffer));\n  }\n  throw new Error(\n    'Add blob support using a polyfill eg https://github.com/bjornstar/blob-polyfill'\n  );\n}\n\nexport default generateContainer;\n"],"names":["x","type","version","w","t","hook","hasOwnProperty","unhook","VirtualNode","noProperties","noChildren","tagName","properties","children","key","namespace","this","String","undefined","hooks","count","length","descendants","hasWidgets","hasThunks","descendantHooks","propName","property","isVHook","i","child","isVNode","isWidget","destroy","isThunk","prototype","VirtualText","text","normalizeArray","parts","allowAboveRoot","up","last","splice","unshift","splitPathRe","splitPath","filename","exec","slice","resolve","resolvedPath","resolvedAbsolute","arguments","path","TypeError","charAt","filter","split","p","join","normalize","isPathAbsolute","isAbsolute","trailingSlash","substr","extname","basename","ext","f","dirname","result","root","dir","sep","delimiter","relative","from","to","trim","arr","start","end","fromParts","toParts","Math","min","samePartsLength","outputParts","push","concat","paths","Array","call","index","xs","res","str","len","Object","create","module","ctor","superCtor","super_","constructor","value","enumerable","writable","configurable","TempCtor","EventHandlers","EventEmitter","init","$getMaxListeners","that","_maxListeners","defaultMaxListeners","emitNone","handler","isFn","self","listeners","arrayClone","emitOne","arg1","emitTwo","arg2","emitThree","arg3","emitMany","args","apply","_addListener","target","listener","prepend","m","events","existing","e","_events","newListener","emit","_eventsCount","warned","Error","name","emitter","console","warn","log","_onceWrap","fired","g","removeListener","listenerCount","evlistener","copy","usingDomains","domain","active","getPrototypeOf","setMaxListeners","n","isNaN","getMaxListeners","er","doError","error","err","context","domainEmitter","domainThrown","addListener","on","prependListener","once","prependOnceListener","list","position","originalListener","k","pop","spliceOne","removeAllListeners","keys","ret","unwrapListeners","eventNames","Reflect","ownKeys","require$$0","Queue","options","concurrency","Infinity","timeout","autostart","results","pending","session","running","jobs","timers","inherits","forEach","method","begin","reverse","clearTimers","timeoutId","clearTimeout","callOnErrorOrEnd","cb","onerror","onend","done","methodResult","defineProperty","get","job","shift","didTimeout","resultIndex","setTimeout","next","promise","then","catch","stop","exports","validate","buffer","toString","calculate","height","abs","readInt32LE","width","readUInt32LE","getSizeFromOffset","offset","readUInt8","getImageSize","imageIndex","readUInt16LE","[object Object]","nbImages","imageSize","imgs","images","ico_1","ICO","gifRegexp","signature","test","ICON_TYPE_SIZE","ICON","ICN#","icm#","icm4","icm8","ics#","ics4","ics8","is32","s8mk","icp4","icl4","icl8","il32","l8mk","icp5","ic11","ich4","ich8","ih32","h8mk","icp6","ic12","it32","t8mk","ic07","ic08","ic13","ic09","ic14","ic10","readImageHeader","imageOffset","imageLengthOffset","readUInt32BE","size","bufferLength","fileLength","imageHeader","BoxTypes","parseIHDR","box","signatureLength","ftypeBoxStart","ftypBoxLength","readUInt16BE","unit","calculateRREQLength","bits","isBigEndian","isEXIF","extractSize","validateExifBlock","exifBlock","byteAlign","EXIF_HEADER_BYTES","idfDirectoryEntries","readUInt_1","readUInt","directoryEntryNumber","block","extractOrientation","validateBuffer","orientation","chunkName","PNMTypes","P1","P2","P3","P4","P5","P6","P7","PF","Signatures","handlers","default","lines","dimensions","line","parseInt","pam","charCodeAt","toLowerCase","includes","svgReg","extractorRegExps","viewbox","units","cm","em","ex","mm","pc","pt","parseLength","round","parseFloat","parseViewbox","bounds","match","attrs","parseAttributes","calculateByDimensions","ratio","floor","calculateByViewbox","readValue","low","nextTag","signatures","filepath","determineEndianness","tags","temp","code","extractTags","ifdOffset","bufferSize","fileSize","fs","statSync","endBuffer","Buffer","alloc","descriptor","openSync","readSync","readIFD","riffHeader","webpHeader","vp8Header","chunkHeader","extendedHeader","validEnd","readUIntLE","calculateExtended","readInt16LE","calculateLossy","calculateLossless","bmp","bmp_1","BMP","cur","cur_1","CUR","dds","dds_1","DDS","gif","gif_1","GIF","icns","icns_1","ICNS","ico","j2c","j2c_1","J2C","jp2","jp2_1","JP2","jpg","jpg_1","JPG","ktx","ktx_1","KTX","png","png_1","PNG","pnm","pnm_1","PNM","psd","psd_1","PSD","svg","svg_1","SVG","tiff","tiff_1","TIFF","webp","webp_1","WEBP","types_1","typeHandlers","firstBytes","56","66","68","71","73","77","82","105","137","255","byte","find","FileHandle","fd","Promise","reject","fstat","stats","read","close","open","flags","__awaiter","thisArg","_arguments","P","generator","fulfilled","step","rejected","queue","queue_1","lookup","detector_1","detector","input","callback","isBuffer","fstatSync","closeSync","syncFileToBuffer","handle","promises","stat","asyncFileToBuffer","process","nextTick","c","namespaces","rgbRegex","hslRegex","hexRegex","hex3Regex","rgbToHex","red","green","blue","map","pixelRegex","percentageRegex","pointRegex","cmRegex","inchRegex","pixelToEMU","pixelValue","EMUToTWIP","EMUValue","pointToTWIP","pointValue","pointToHIP","pixelToTWIP","pixelToHIP","TWIPValue","inchToTWIP","inchValue","inchToPoint","pixelToPoint","HIPValue","pointToEIP","PointValue","fixupColorCode","colorCodeString","colorNames","matchedParts","hue","saturation","luminosity","hue2rgb","q","hex","hslToHex","hex3ToHex","buildShading","colorCode","fragment","namespaceAlias","ele","att","buildVertAlign","buildBold","buildItalics","buildUnderline","buildBorder","borderSide","borderSize","borderSpacing","borderColor","borderStroke","buildTextElement","txt","buildRunProperties","attributes","runPropertiesFragment","boldFragment","import","italicsFragment","underlineFragment","colorFragment","shadingFragment","fontSizeFragment","fontSize","hyperlinkStyleFragment","buildRunStyleFragment","buildTextFormatting","vNode","color","buildHighlight","fixupLineHeight","lineHeight","fixupFontSize","fontSizeString","buildHorizontalAlignment","horizontalAlignment","buildParagraphProperties","paragraphPropertiesFragment","levelId","numberingId","numberingPropertiesFragment","buildNumberingProperties","numbering","horizontalAlignmentFragment","textAlign","display","paragraphBorderFragment","bordersObject","top","spacing","left","bottom","right","borderName","borderFragment","buildParagraphBorder","backgroundColor","pStyleFragment","style","buildPStyle","paragraphStyle","indentationFragment","buildIndentation","indentation","spacingFragment","lineSpacing","beforeSpacing","afterSpacing","buildSpacing","computeImageDimensions","maximumWidth","originalWidth","originalHeight","aspectRatio","maximumWidthInEMU","modifiedHeight","modifiedWidth","originalWidthInEMU","originalHeightInEMU","percentageValue","buildImage","docxDocumentInstance","response","createMediaFile","decodeURIComponent","src","zip","folder","file","fileNameWithExtension","fileContent","createFolders","documentRelsId","createDocumentRelationships","relationshipFilename","imageBuffer","imageProperties","sizeOf","inlineOrAnchored","relationshipId","availableDocumentSpace","addTo","fragments","parentFragment","isArray","item","getModifiedAttributes","modifiedAttributes","verticalAlign","strong","getRunFragment","withProp","runFragment","buildNestedTextChildrens","textEls","childVNode","isVText","buildNestedText","tempNode","formats","format","buildNested","href","r","hyperLinkFragment","hyperlink","buildLineBreak","otherAttributes","buildDrawing","runFragments","buildParagraph","paragraphFragment","buildTableCellProperties","tableCellPropertiesFragment","verticalAlignmentFragment","verticalAlignment","buildVerticalAlignment","gridSpanFragment","spanValue","colSpan","tableCellBorderFragment","tableCellBorder","tableCellBordersFragment","stroke","borders","border","buildTableCellBorders","verticalMergeFragment","verticalMerge","buildVerticalMerge","rowSpan","fixupTableCellBorder","cssBorderParser","buildTableCell","rowSpanMap","columnIndex","tableCellFragment","set","previousSpanObject","assign","iteratorIndex","grandChildVNode","buildRowSpanCell","rowSpanCellFragments","spanObject","rowSpanCellFragment","delete","buildTableRowProperties","tableRowPropertiesFragment","tableRowHeightFragment","tableRowHeight","rowCantSplit","cantSplitFragment","buildTableRow","tableRowFragment","rowHeightString","fixupRowHeight","tableColumns","columnWidth","buildTableGridCol","gridWidth","buildTableGrid","tableGridFragment","gridColumns","tableGridColFragment","buildTableGridFromTableRow","numberOfGridColumns","reduce","accumulator","buildCellMargin","side","margin","buildTableProperties","tablePropertiesFragment","tableBordersFragment","tableBorder","buildTableBorders","tableCellSpacingFragment","cellSpacing","buildTableCellSpacing","tableCellSpacing","tableWidthFragment","tableWidth","tableCellMarginFragment","tableCellMarFragment","marginFragment","buildTableCellMargins","alignmentFragment","borderString","toUpperCase","buildTable","tableFragment","tableAttributes","tableStyles","tableBorders","tableCellBorders","minimumWidth","borderStrike","cssSize","cssStroke","cssColor","insideV","insideH","lastIndex","max","Map","buildGraphicFrameTransform","graphicFrameTransformFragment","a","offsetFragment","extentsFragment","buildExtents","buildShapeProperties","shapeProperties","pic","presetGeometryFragment","buildStretch","stretchFragment","fillRectFragment","buildBinaryLargeImageOrPictureFill","binaryLargeImageOrPictureFillFragment","binaryLargeImageOrPictureFragment","buildBinaryLargeImageOrPicture","srcRectFragment","buildNonVisualPictureProperties","pictureId","pictureNameWithExtension","pictureDescription","nonVisualPicturePropertiesFragment","nonVisualDrawingPropertiesFragment","buildNonVisualDrawingProperties","nonVisualPictureDrawingPropertiesFragment","buildNonVisualPictureDrawingProperties","buildGraphicData","graphicType","graphicDataFragment","pictureFragment","id","description","binaryLargeImageOrPictureFill","buildPicture","buildGraphic","graphicFragment","buildDrawingObjectNonVisualProperties","pictureName","wp","buildEffectExtentFragment","buildExtent","buildAnchoredDrawing","anchoredDrawingFragment","simplePosFragment","positionHFragment","positionVFragment","extentFragment","effectExtentFragment","wrapSquareFragment","drawingObjectNonVisualPropertiesFragment","drawingFragment","inlineOrAnchoredDrawingFragment","inlineDrawingFragment","buildInlineDrawing","convertHTML","HTMLToVDOM","VNode","VText","xmlBuilder.buildParagraph","findXMLEquivalent","xmlFragment","class","headingFragment","xmlBuilder.buildTable","tableRowCantSplit","emptyParagraphFragment","imageFragment","listElements","vNodeObjects","node","level","tempVNodeObject","paragraphVNode","buildList","createNumbering","listElement","linebreakFragment","convertVTreeToXML","vTree","xmlBuilder.buildTextElement","escape","documentRelsXML","relsXML","fontTableXML","settingsXML","webSettingsXML","seed","alphabet","previousSeed","shuffled","nextValue","_seed_","ORIGINAL","reset","setCharacters","_alphabet_","unique","ind","lastIndexOf","getShuffled","characterIndex","sourceArray","targetArray","randomFromSeed","shuffle","characters","crypto","window","msCrypto","getRandomValues","Uint8Array","bytes","random","mask","LN2","counter","previousSeconds","number","loopCounter","pow","clusterWorkerId","seconds","Date","now","generate","RegExp","replace","build","seedValue","workerId","newCharacters","isValid","landscapeMargins","header","footer","gutter","portraitMargins","DocxDocument","htmlString","margins","title","subject","creator","keywords","lastModifiedBy","revision","createdAt","modifiedAt","headerType","footerType","font","complexScriptFontSize","table","pageNumber","skipFirstHeaderFooter","lineNumber","lineNumberOptions","row","cantSplit","lastNumberingId","lastMediaId","lastHeaderId","lastFooterId","stylesObjects","numberingObjects","relationships","fileName","lastRelsId","rels","mediaFiles","headerObjects","footerObjects","documentXML","generateContentTypesXML","bind","generateCoreXML","generateDocumentXML","generateSettingsXML","generateWebSettingsXML","generateStylesXML","generateFontTableXML","generateThemeXML","generateNumberingXML","generateRelsXML","generateHeaderXML","generateFooterXML","contentTypesXML","encoding","standalone","headerId","contentTypesFragment","defaultNamespace","footerId","prettyPrint","toISOString","first","headerXmlFragment","headerFragment","footerXmlFragment","footerFragment","titlePageFragment","countBy","restart","lineNumberFragment","settingsXMLString","webSettingsXMLString","fontTableXMLString","numberingXML","abstractNumberingFragments","numberingFragments","abstractNumberingFragment","findIndex","v","levelFragment","numberingFragment","targetMode","relationshipFragment","documentRelsXMLString","appendRelationships","xmlString","base64String","matches","base64FileContent","fileExtension","shortid.generate","relationshipType","relationshipObject","relationship","headerXML","ve","o","w10","XMLFragment","footerXML","fieldSimpleFragment","defaultDocumentOptions","fixupMargins","normalizedMargins","cmValue","cmToInch","normalizeDocumentOptions","documentOptions","normalizedDocumentOptions","normalizedFontSize","addFilesToContainer","suppliedDocumentOptions","headerHTMLString","footerHTMLString","patch","docxDocument","relationshipXMLs","minifyHTMLString","async","JSZip","contentHTML","headerHTML","footerHTML","generateAsync","global","Blob"],"mappings":"0KAAA,YCIA,SAAuBA,GACnB,OAAOA,GAAgB,gBAAXA,EAAEC,MDLD,MCK2BD,EAAEE,SCL9C,eAEA,SAAkBC,GACd,OAAOA,GAAgB,WAAXA,EAAEF,MCHlB,cAEA,SAAiBG,GACb,OAAOA,GAAgB,UAAXA,EAAEH,MCHlB,YAEA,SAAgBI,MACZ,OAAOA,OACiB,mBAAdA,KAAKA,OAAwBA,KAAKC,eAAe,SACjC,mBAAhBD,KAAKE,SAA0BF,KAAKC,eAAe,YCCjE,UAAiBE,YAEbC,aAAe,GACfC,WAAa,GAEjB,SAASF,YAAYG,QAASC,WAAYC,SAAUC,IAAKC,WACrDC,KAAKL,QAAUA,QACfK,KAAKJ,WAAaA,YAAcH,aAChCO,KAAKH,SAAWA,UAAYH,WAC5BM,KAAKF,IAAa,MAAPA,IAAcG,OAAOH,UAAOI,EACvCF,KAAKD,UAAkC,iBAAdA,UAA0BA,UAAY,KAE/D,IAKII,MALAC,MAASP,UAAYA,SAASQ,QAAW,EACzCC,YAAc,EACdC,YAAa,EACbC,WAAY,EACZC,iBAAkB,EAGtB,IAAK,IAAIC,YAAYd,WACjB,GAAIA,WAAWN,eAAeoB,UAAW,CACrC,IAAIC,SAAWf,WAAWc,UACtBE,QAAQD,WAAaA,SAASpB,SACzBY,QACDA,MAAQ,IAGZA,MAAMO,UAAYC,UAK9B,IAAK,IAAIE,EAAI,EAAGA,EAAIT,MAAOS,IAAK,CAC5B,IAAIC,MAAQjB,SAASgB,GACjBE,QAAQD,QACRR,aAAeQ,MAAMV,OAAS,GAEzBG,YAAcO,MAAMP,aACrBA,YAAa,IAGZC,WAAaM,MAAMN,YACpBA,WAAY,GAGXC,kBAAoBK,MAAMX,QAASW,MAAML,kBAC1CA,iBAAkB,KAEdF,YAAcS,WAASF,OACF,mBAAlBA,MAAMG,UACbV,YAAa,IAETC,WAAaU,UAAQJ,SAC7BN,WAAY,GAIpBR,KAAKI,MAAQA,MAAQE,YACrBN,KAAKO,WAAaA,WAClBP,KAAKQ,UAAYA,UACjBR,KAAKG,MAAQA,MACbH,KAAKS,gBAAkBA,gBAG3BjB,YAAY2B,UAAUjC,QLtEL,IKuEjBM,YAAY2B,UAAUlC,KAAO,cCrE7B,UAAiBmC,YAEjB,SAASA,YAAYC,MACjBrB,KAAKqB,KAAOpB,OAAOoB,MAGvBD,YAAYD,UAAUjC,QNRL,IMSjBkC,YAAYD,UAAUlC,KAAO,cCP7B,YAEA,SAAuBD,GACnB,OAAOA,GAAgB,gBAAXA,EAAEC,MPLD,MOK2BD,EAAEE,0jBCL9C,OAAe,GCyBf,SAASoC,eAAeC,MAAOC,gBAG7B,IADA,IAAIC,GAAK,EACAZ,EAAIU,MAAMlB,OAAS,EAAGQ,GAAK,EAAGA,IAAK,CAC1C,IAAIa,KAAOH,MAAMV,GACJ,MAATa,KACFH,MAAMI,OAAOd,EAAG,GACE,OAATa,MACTH,MAAMI,OAAOd,EAAG,GAChBY,MACSA,KACTF,MAAMI,OAAOd,EAAG,GAChBY,MAKJ,GAAID,eACF,KAAOC,KAAMA,GACXF,MAAMK,QAAQ,MAIlB,OAAOL,MAKT,IAAIM,YACA,gEACAC,UAAY,SAASC,UACvB,OAAOF,YAAYG,KAAKD,UAAUE,MAAM,IAKnC,SAASC,UAId,IAHA,IAAIC,aAAe,GACfC,kBAAmB,EAEdvB,EAAIwB,UAAUhC,OAAS,EAAGQ,IAAM,IAAMuB,iBAAkBvB,IAAK,CACpE,IAAIyB,KAAQzB,GAAK,EAAKwB,UAAUxB,GAAK,IAGrC,GAAoB,iBAATyB,KACT,MAAM,IAAIC,UAAU,6CACVD,OAIZH,aAAeG,KAAO,IAAMH,aAC5BC,iBAAsC,MAAnBE,KAAKE,OAAO,IAWjC,OAASJ,iBAAmB,IAAM,KAJlCD,aAAeb,eAAemB,OAAON,aAAaO,MAAM,MAAM,SAASC,GACrE,QAASA,MACNP,kBAAkBQ,KAAK,OAE6B,IAKpD,SAASC,UAAUP,MACxB,IAAIQ,eAAiBC,WAAWT,MAC5BU,cAAqC,MAArBC,OAAOX,MAAO,GAclC,OAXAA,KAAOhB,eAAemB,OAAOH,KAAKI,MAAM,MAAM,SAASC,GACrD,QAASA,MACNG,gBAAgBF,KAAK,OAEZE,iBACZR,KAAO,KAELA,MAAQU,gBACVV,MAAQ,MAGFQ,eAAiB,IAAM,IAAMR,KAIhC,SAASS,WAAWT,MACzB,MAA0B,MAAnBA,KAAKE,OAAO,GA4FrB,SAAe,CACbU,QAJK,SAAiBZ,MACtB,OAAOR,UAAUQ,MAAM,IAIvBa,SAfK,SAAkBb,KAAMc,KAC7B,IAAIC,EAAIvB,UAAUQ,MAAM,GAKxB,OAHIc,KAAOC,EAAEJ,QAAQ,EAAIG,IAAI/C,UAAY+C,MACvCC,EAAIA,EAAEJ,OAAO,EAAGI,EAAEhD,OAAS+C,IAAI/C,SAE1BgD,GAUPC,QAlCK,SAAiBhB,MACtB,IAAIiB,OAASzB,UAAUQ,MACnBkB,KAAOD,OAAO,GACdE,IAAMF,OAAO,GAEjB,OAAKC,MAASC,KAKVA,MAEFA,IAAMA,IAAIR,OAAO,EAAGQ,IAAIpD,OAAS,IAG5BmD,KAAOC,KARL,KA4BTC,IAtCe,IAuCfC,UAtCqB,IAuCrBC,SAjFK,SAAkBC,KAAMC,IAI7B,SAASC,KAAKC,KAEZ,IADA,IAAIC,MAAQ,EACLA,MAAQD,IAAI3D,QACE,KAAf2D,IAAIC,OADiBA,SAK3B,IADA,IAAIC,IAAMF,IAAI3D,OAAS,EAChB6D,KAAO,GACK,KAAbF,IAAIE,KADOA,OAIjB,OAAID,MAAQC,IAAY,GACjBF,IAAI/B,MAAMgC,MAAOC,IAAMD,MAAQ,GAfxCJ,KAAO3B,QAAQ2B,MAAMZ,OAAO,GAC5Ba,GAAK5B,QAAQ4B,IAAIb,OAAO,GAsBxB,IALA,IAAIkB,UAAYJ,KAAKF,KAAKnB,MAAM,MAC5B0B,QAAUL,KAAKD,GAAGpB,MAAM,MAExBrC,OAASgE,KAAKC,IAAIH,UAAU9D,OAAQ+D,QAAQ/D,QAC5CkE,gBAAkBlE,OACbQ,EAAI,EAAGA,EAAIR,OAAQQ,IAC1B,GAAIsD,UAAUtD,KAAOuD,QAAQvD,GAAI,CAC/B0D,gBAAkB1D,EAClB,MAIJ,IAAI2D,YAAc,GAClB,IAAS3D,EAAI0D,gBAAiB1D,EAAIsD,UAAU9D,OAAQQ,IAClD2D,YAAYC,KAAK,MAKnB,OAFAD,YAAcA,YAAYE,OAAON,QAAQnC,MAAMsC,mBAE5B3B,KAAK,MA4CxBA,KA/FK,WACL,IAAI+B,MAAQC,MAAMzD,UAAUc,MAAM4C,KAAKxC,UAAW,GAClD,OAAOQ,UAAUJ,OAAOkC,OAAO,SAAShC,EAAGmC,OACzC,GAAiB,iBAANnC,EACT,MAAM,IAAIJ,UAAU,0CAEtB,OAAOI,KACNC,KAAK,OAyFRG,WAAYA,WACZF,UAAWA,UACXX,QAASA,SAEX,SAASO,OAAQsC,GAAI1B,GACjB,GAAI0B,GAAGtC,OAAQ,OAAOsC,GAAGtC,OAAOY,GAEhC,IADA,IAAI2B,IAAM,GACDnE,EAAI,EAAGA,EAAIkE,GAAG1E,OAAQQ,IACvBwC,EAAE0B,GAAGlE,GAAIA,EAAGkE,KAAKC,IAAIP,KAAKM,GAAGlE,IAErC,OAAOmE,IAIX,IAAI/B,OAA6B,MAApB,KAAKA,QAAQ,GACtB,SAAUgC,IAAKhB,MAAOiB,KAAO,OAAOD,IAAIhC,OAAOgB,MAAOiB,MACtD,SAAUD,IAAKhB,MAAOiB,KAElB,OADIjB,MAAQ,IAAGA,MAAQgB,IAAI5E,OAAS4D,OAC7BgB,IAAIhC,OAAOgB,MAAOiB,8DCvOJ,mBAAlBC,OAAOC,OAEhBC,eAAiB,SAAkBC,KAAMC,WACnCA,YACFD,KAAKE,OAASD,UACdD,KAAKnE,UAAYgE,OAAOC,OAAOG,UAAUpE,UAAW,CAClDsE,YAAa,CACXC,MAAOJ,KACPK,YAAY,EACZC,UAAU,EACVC,cAAc,OAOtBR,eAAiB,SAAkBC,KAAMC,WACvC,GAAIA,UAAW,CACbD,KAAKE,OAASD,UACd,IAAIO,SAAW,aACfA,SAAS3E,UAAYoE,UAAUpE,UAC/BmE,KAAKnE,UAAY,IAAI2E,SACrBR,KAAKnE,UAAUsE,YAAcH,UChBnC,SAASS,iBAGT,SAASC,eACPA,aAAaC,KAAKpB,KAAK7E,MA6CzB,SAASkG,iBAAiBC,MACxB,YAA2BjG,IAAvBiG,KAAKC,cACAJ,aAAaK,oBACfF,KAAKC,cAYd,SAASE,SAASC,QAASC,KAAMC,MAC/B,GAAID,KACFD,QAAQ1B,KAAK4B,WAIb,IAFA,IAAIvB,IAAMqB,QAAQlG,OACdqG,UAAYC,WAAWJ,QAASrB,KAC3BrE,EAAI,EAAGA,EAAIqE,MAAOrE,EACzB6F,UAAU7F,GAAGgE,KAAK4B,MAGxB,SAASG,QAAQL,QAASC,KAAMC,KAAMI,MACpC,GAAIL,KACFD,QAAQ1B,KAAK4B,KAAMI,WAInB,IAFA,IAAI3B,IAAMqB,QAAQlG,OACdqG,UAAYC,WAAWJ,QAASrB,KAC3BrE,EAAI,EAAGA,EAAIqE,MAAOrE,EACzB6F,UAAU7F,GAAGgE,KAAK4B,KAAMI,MAG9B,SAASC,QAAQP,QAASC,KAAMC,KAAMI,KAAME,MAC1C,GAAIP,KACFD,QAAQ1B,KAAK4B,KAAMI,KAAME,WAIzB,IAFA,IAAI7B,IAAMqB,QAAQlG,OACdqG,UAAYC,WAAWJ,QAASrB,KAC3BrE,EAAI,EAAGA,EAAIqE,MAAOrE,EACzB6F,UAAU7F,GAAGgE,KAAK4B,KAAMI,KAAME,MAGpC,SAASC,UAAUT,QAASC,KAAMC,KAAMI,KAAME,KAAME,MAClD,GAAIT,KACFD,QAAQ1B,KAAK4B,KAAMI,KAAME,KAAME,WAI/B,IAFA,IAAI/B,IAAMqB,QAAQlG,OACdqG,UAAYC,WAAWJ,QAASrB,KAC3BrE,EAAI,EAAGA,EAAIqE,MAAOrE,EACzB6F,UAAU7F,GAAGgE,KAAK4B,KAAMI,KAAME,KAAME,MAI1C,SAASC,SAASX,QAASC,KAAMC,KAAMU,MACrC,GAAIX,KACFD,QAAQa,MAAMX,KAAMU,WAIpB,IAFA,IAAIjC,IAAMqB,QAAQlG,OACdqG,UAAYC,WAAWJ,QAASrB,KAC3BrE,EAAI,EAAGA,EAAIqE,MAAOrE,EACzB6F,UAAU7F,GAAGuG,MAAMX,KAAMU,MAyE/B,SAASE,aAAaC,OAAQrI,KAAMsI,SAAUC,SAC5C,IAAIC,EACAC,OACAC,SA4DeC,EA1DnB,GAAwB,mBAAbL,SACT,MAAM,IAAIhF,UAAU,0CAoBtB,IAlBAmF,OAASJ,OAAOO,UAOVH,OAAOI,cACTR,OAAOS,KAAK,cAAe9I,KACfsI,SAASA,SAAWA,SAASA,SAAWA,UAIpDG,OAASJ,OAAOO,SAElBF,SAAWD,OAAOzI,QAblByI,OAASJ,OAAOO,QAAU,IAAI9B,cAC9BuB,OAAOU,aAAe,GAenBL,UAmBH,GAdwB,mBAAbA,SAETA,SAAWD,OAAOzI,MAAQuI,QAAU,CAACD,SAAUI,UACX,CAACA,SAAUJ,UAG3CC,QACFG,SAAS/F,QAAQ2F,UAEjBI,SAASlD,KAAK8C,WAKbI,SAASM,SACZR,EAAIvB,iBAAiBoB,UACZG,EAAI,GAAKE,SAAStH,OAASoH,EAAG,CACrCE,SAASM,QAAS,EAClB,IAAI9I,EAAI,IAAI+I,MAAM,+CACEP,SAAStH,OAAS,IAAMpB,KAD1B,qEAGlBE,EAAEgJ,KAAO,8BACThJ,EAAEiJ,QAAUd,OACZnI,EAAEF,KAAOA,KACTE,EAAEiB,MAAQuH,SAAStH,OAQNuH,EAPDzI,EAQM,mBAAjBkJ,QAAQC,KAAsBD,QAAQC,KAAKV,GAAKS,QAAQE,IAAIX,SApCjED,SAAWD,OAAOzI,MAAQsI,WACxBD,OAAOU,aAgCX,OAAOV,OAgBT,SAASkB,UAAUlB,OAAQrI,KAAMsI,UAC/B,IAAIkB,OAAQ,EACZ,SAASC,IACPpB,OAAOqB,eAAe1J,KAAMyJ,GACvBD,QACHA,OAAQ,EACRlB,SAASH,MAAME,OAAQjF,YAI3B,OADAqG,EAAEnB,SAAWA,SACNmB,EA2JT,SAASE,cAAc3J,MACrB,IAAIyI,OAAS1H,KAAK6H,QAElB,GAAIH,OAAQ,CACV,IAAImB,WAAanB,OAAOzI,MAExB,GAA0B,mBAAf4J,WACT,OAAO,EACF,GAAIA,WACT,OAAOA,WAAWxI,OAItB,OAAO,EAcT,SAASsG,WAAW3C,IAAKnD,GAEvB,IADA,IAAIiI,KAAO,IAAIlE,MAAM/D,GACdA,KACLiI,KAAKjI,GAAKmD,IAAInD,GAChB,OAAOiI,KAzcT/C,cAAc5E,UAAYgE,OAAOC,OAAO,MAUxCY,aAAaA,aAAeA,aAE5BA,aAAa+C,cAAe,EAE5B/C,aAAa7E,UAAU6H,YAAS9I,EAChC8F,aAAa7E,UAAU0G,aAAU3H,EACjC8F,aAAa7E,UAAUiF,mBAAgBlG,EAIvC8F,aAAaK,oBAAsB,GAEnCL,aAAaC,KAAO,WAClBjG,KAAKgJ,OAAS,KACVhD,aAAa+C,oBA9BfC,GAgCWC,OAKRjJ,KAAK6H,SAAW7H,KAAK6H,UAAY1C,OAAO+D,eAAelJ,MAAM6H,UAChE7H,KAAK6H,QAAU,IAAI9B,cACnB/F,KAAKgI,aAAe,GAGtBhI,KAAKoG,cAAgBpG,KAAKoG,oBAAiBlG,GAK7C8F,aAAa7E,UAAUgI,gBAAkB,SAAyBC,GAChE,GAAiB,iBAANA,GAAkBA,EAAI,GAAKC,MAAMD,GAC1C,MAAM,IAAI7G,UAAU,0CAEtB,OADAvC,KAAKoG,cAAgBgD,EACdpJ,MASTgG,aAAa7E,UAAUmI,gBAAkB,WACvC,OAAOpD,iBAAiBlG,OA4D1BgG,aAAa7E,UAAU4G,KAAO,SAAc9I,MAC1C,IAAIsK,GAAIhD,QAASrB,IAAKiC,KAAMtG,EAAG6G,OAAQsB,OAEnCQ,QAAoB,UAATvK,KAGf,GADAyI,OAAS1H,KAAK6H,QAEZ2B,QAAWA,SAA2B,MAAhB9B,OAAO+B,WAC1B,IAAKD,QACR,OAAO,EAKT,GAHAR,OAAShJ,KAAKgJ,OAGVQ,QAAS,CAEX,GADAD,GAAKlH,UAAU,IACX2G,OAOG,CAAA,GAAIO,cAAcrB,MACvB,MAAMqB,GAGN,IAAIG,IAAM,IAAIxB,MAAM,yCAA2CqB,GAAK,KAEpE,MADAG,IAAIC,QAAUJ,GACRG,IAER,OAdOH,KACHA,GAAK,IAAIrB,MAAM,wCACjBqB,GAAGK,cAAgB5J,KACnBuJ,GAAGP,OAASA,OACZO,GAAGM,cAAe,EAClBb,OAAOjB,KAAK,QAASwB,KAShB,EAKT,KAFAhD,QAAUmB,OAAOzI,OAGf,OAAO,EAET,IAAIuH,KAA0B,mBAAZD,QAElB,OADArB,IAAM7C,UAAUhC,QAGd,KAAK,EACHiG,SAASC,QAASC,KAAMxG,MACxB,MACF,KAAK,EACH4G,QAAQL,QAASC,KAAMxG,KAAMqC,UAAU,IACvC,MACF,KAAK,EACHyE,QAAQP,QAASC,KAAMxG,KAAMqC,UAAU,GAAIA,UAAU,IACrD,MACF,KAAK,EACH2E,UAAUT,QAASC,KAAMxG,KAAMqC,UAAU,GAAIA,UAAU,GAAIA,UAAU,IACrE,MAEF,QAEE,IADA8E,KAAO,IAAIvC,MAAMM,IAAM,GAClBrE,EAAI,EAAGA,EAAIqE,IAAKrE,IACnBsG,KAAKtG,EAAI,GAAKwB,UAAUxB,GAC1BqG,SAASX,QAASC,KAAMxG,KAAMmH,MAMlC,OAAO,GAqETnB,aAAa7E,UAAU2I,YAAc,SAAqB7K,KAAMsI,UAC9D,OAAOF,aAAarH,KAAMf,KAAMsI,UAAU,IAG5CvB,aAAa7E,UAAU4I,GAAK/D,aAAa7E,UAAU2I,YAEnD9D,aAAa7E,UAAU6I,gBACnB,SAAyB/K,KAAMsI,UAC7B,OAAOF,aAAarH,KAAMf,KAAMsI,UAAU,IAgBhDvB,aAAa7E,UAAU8I,KAAO,SAAchL,KAAMsI,UAChD,GAAwB,mBAAbA,SACT,MAAM,IAAIhF,UAAU,0CAEtB,OADAvC,KAAK+J,GAAG9K,KAAMuJ,UAAUxI,KAAMf,KAAMsI,WAC7BvH,MAGTgG,aAAa7E,UAAU+I,oBACnB,SAA6BjL,KAAMsI,UACjC,GAAwB,mBAAbA,SACT,MAAM,IAAIhF,UAAU,0CAEtB,OADAvC,KAAKgK,gBAAgB/K,KAAMuJ,UAAUxI,KAAMf,KAAMsI,WAC1CvH,MAIbgG,aAAa7E,UAAUwH,eACnB,SAAwB1J,KAAMsI,UAC5B,IAAI4C,KAAMzC,OAAQ0C,SAAUvJ,EAAGwJ,iBAE/B,GAAwB,mBAAb9C,SACT,MAAM,IAAIhF,UAAU,0CAGtB,KADAmF,OAAS1H,KAAK6H,SAEZ,OAAO7H,KAGT,KADAmK,KAAOzC,OAAOzI,OAEZ,OAAOe,KAET,GAAImK,OAAS5C,UAAa4C,KAAK5C,UAAY4C,KAAK5C,WAAaA,SAC/B,KAAtBvH,KAAKgI,aACThI,KAAK6H,QAAU,IAAI9B,sBAEZ2B,OAAOzI,MACVyI,OAAOiB,gBACT3I,KAAK+H,KAAK,iBAAkB9I,KAAMkL,KAAK5C,UAAYA,gBAElD,GAAoB,mBAAT4C,KAAqB,CAGrC,IAFAC,UAAY,EAEPvJ,EAAIsJ,KAAK9J,OAAQQ,KAAM,GAC1B,GAAIsJ,KAAKtJ,KAAO0G,UACX4C,KAAKtJ,GAAG0G,UAAY4C,KAAKtJ,GAAG0G,WAAaA,SAAW,CACvD8C,iBAAmBF,KAAKtJ,GAAG0G,SAC3B6C,SAAWvJ,EACX,MAIJ,GAAIuJ,SAAW,EACb,OAAOpK,KAET,GAAoB,IAAhBmK,KAAK9J,OAAc,CAErB,GADA8J,KAAK,QAAKjK,EACkB,KAAtBF,KAAKgI,aAET,OADAhI,KAAK6H,QAAU,IAAI9B,cACZ/F,YAEA0H,OAAOzI,WAiH1B,SAAmBkL,KAAMrF,OACvB,IAAK,IAAIjE,EAAIiE,MAAOwF,EAAIzJ,EAAI,EAAGuI,EAAIe,KAAK9J,OAAQiK,EAAIlB,EAAGvI,GAAK,EAAGyJ,GAAK,EAClEH,KAAKtJ,GAAKsJ,KAAKG,GACjBH,KAAKI,MAjHGC,CAAUL,KAAMC,UAGd1C,OAAOiB,gBACT3I,KAAK+H,KAAK,iBAAkB9I,KAAMoL,kBAAoB9C,UAG1D,OAAOvH,MAGbgG,aAAa7E,UAAUsJ,mBACnB,SAA4BxL,MAC1B,IAAIyH,UAAWgB,OAGf,KADAA,OAAS1H,KAAK6H,SAEZ,OAAO7H,KAGT,IAAK0H,OAAOiB,eAUV,OATyB,IAArBtG,UAAUhC,QACZL,KAAK6H,QAAU,IAAI9B,cACnB/F,KAAKgI,aAAe,GACXN,OAAOzI,QACY,KAAtBe,KAAKgI,aACThI,KAAK6H,QAAU,IAAI9B,qBAEZ2B,OAAOzI,OAEXe,KAIT,GAAyB,IAArBqC,UAAUhC,OAAc,CAE1B,IADA,IACgBP,IADZ4K,KAAOvF,OAAOuF,KAAKhD,QACd7G,EAAI,EAAQA,EAAI6J,KAAKrK,SAAUQ,EAE1B,oBADZf,IAAM4K,KAAK7J,KAEXb,KAAKyK,mBAAmB3K,KAK1B,OAHAE,KAAKyK,mBAAmB,kBACxBzK,KAAK6H,QAAU,IAAI9B,cACnB/F,KAAKgI,aAAe,EACbhI,KAKT,GAAyB,mBAFzB0G,UAAYgB,OAAOzI,OAGjBe,KAAK2I,eAAe1J,KAAMyH,gBACrB,GAAIA,UAET,GACE1G,KAAK2I,eAAe1J,KAAMyH,UAAUA,UAAUrG,OAAS,UAChDqG,UAAU,IAGrB,OAAO1G,MAGbgG,aAAa7E,UAAUuF,UAAY,SAAmBzH,MACpD,IAAI4J,WAEAnB,OAAS1H,KAAK6H,QAclB,OAZKH,SAGHmB,WAAanB,OAAOzI,OAGW,mBAAf4J,WACR,CAACA,WAAWtB,UAAYsB,YAmDpC,SAAyB7E,KAEvB,IADA,IAAI2G,IAAM,IAAI/F,MAAMZ,IAAI3D,QACfQ,EAAI,EAAGA,EAAI8J,IAAItK,SAAUQ,EAChC8J,IAAI9J,GAAKmD,IAAInD,GAAG0G,UAAYvD,IAAInD,GAElC,OAAO8J,IAtDGC,CAAgB/B,YARlB,IAcV7C,aAAa4C,cAAgB,SAASR,QAASnJ,MAC7C,MAAqC,mBAA1BmJ,QAAQQ,cACVR,QAAQQ,cAAc3J,MAEtB2J,cAAc/D,KAAKuD,QAASnJ,OAIvC+G,aAAa7E,UAAUyH,cAAgBA,cAiBvC5C,aAAa7E,UAAU0J,WAAa,WAClC,OAAO7K,KAAKgI,aAAe,EAAI8C,QAAQC,QAAQ/K,KAAK6H,SAAW,IClcjE,IAAI7B,eAAegF,aAAkBhF,mBAEpBiF,eACQA,MAEzB,SAASA,MAAOC,SACd,KAAMlL,gBAAgBiL,OACpB,OAAO,IAAIA,MAAMC,SAGnBlF,eAAanB,KAAK7E,MAClBkL,QAAUA,SAAW,GACrBlL,KAAKmL,YAAcD,QAAQC,aAAeC,EAAAA,EAC1CpL,KAAKqL,QAAUH,QAAQG,SAAW,EAClCrL,KAAKsL,UAAYJ,QAAQI,YAAa,EACtCtL,KAAKuL,QAAUL,QAAQK,SAAW,KAClCvL,KAAKwL,QAAU,EACfxL,KAAKyL,QAAU,EACfzL,KAAK0L,SAAU,EACf1L,KAAK2L,KAAO,GACZ3L,KAAK4L,OAAS,GAEhBC,iBAASZ,MAAOjF,gBAEG,CACjB,MACA,QACA,UACA,eAGW8F,SAAQ,SAAUC,QAC7Bd,MAAM9J,UAAU4K,QAAU,WACxB,OAAOnH,MAAMzD,UAAU4K,QAAQ3E,MAAMpH,KAAK2L,KAAMtJ,eAIpD4I,MAAM9J,UAAUc,MAAQ,SAAU+J,MAAO9H,KAEvC,OADAlE,KAAK2L,KAAO3L,KAAK2L,KAAK1J,MAAM+J,MAAO9H,KAC5BlE,MAGTiL,MAAM9J,UAAU8K,QAAU,WAExB,OADAjM,KAAK2L,KAAKM,UACHjM,MA4HT,SAASkM,cACP,IAAK,IAAIpM,OAAOE,KAAK4L,OAAQ,CAC3B,IAAIO,UAAYnM,KAAK4L,OAAO9L,YACrBE,KAAK4L,OAAO9L,KACnBsM,aAAaD,YAIjB,SAASE,iBAAkBC,IACzB,IAAI7F,KAAOzG,KAIX,SAASuM,QAAS7C,KAAOjD,KAAKvC,IAAIwF,KAHlC1J,KAAK+J,GAAG,QAASwC,SACjBvM,KAAK+J,GAAG,OAGR,SAASyC,MAAO9C,KACdjD,KAAKkC,eAAe,QAAS4D,SAC7B9F,KAAKkC,eAAe,MAAO6D,OAC3BF,GAAG5C,IAAK1J,KAAKuL,YAIjB,SAASkB,KAAM/C,KACb1J,KAAKyL,UACLzL,KAAK0L,SAAU,EACf1L,KAAK+H,KAAK,MAAO2B,KAjJG,CACpB,OACA,UACA,UAGcoC,SAAQ,SAAUC,QAChCd,MAAM9J,UAAU4K,QAAU,WACxB,IAAIW,aAAe9H,MAAMzD,UAAU4K,QAAQ3E,MAAMpH,KAAK2L,KAAMtJ,WAI5D,OAHIrC,KAAKsL,WACPtL,KAAKiE,QAEAyI,iBAIXvH,OAAOwH,eAAe1B,MAAM9J,UAAW,SAAU,CAC/CyL,IAAK,WACH,OAAO5M,KAAKwL,QAAUxL,KAAK2L,KAAKtL,UAIpC4K,MAAM9J,UAAU8C,MAAQ,SAAUqI,IAOhC,GANIA,IACFD,iBAAiBxH,KAAK7E,KAAMsM,IAG9BtM,KAAK0L,SAAU,IAEX1L,KAAKwL,SAAWxL,KAAKmL,aAIzB,GAAyB,IAArBnL,KAAK2L,KAAKtL,OAAd,CAOA,IAAIoG,KAAOzG,KACP6M,IAAM7M,KAAK2L,KAAKmB,QAChB7C,MAAO,EACPwB,QAAUzL,KAAKyL,QACfU,UAAY,KACZY,YAAa,EACbC,YAAc,KACd3B,QAAUwB,IAAIxB,SAAWrL,KAAKqL,QA8B9BA,UACFc,UAAYc,YAAW,WACrBF,YAAa,EACTtG,KAAKC,UAAU,WAAWrG,OAAS,EACrCoG,KAAKsB,KAAK,UAAWmF,KAAML,KAE3BK,SAED7B,SACHrL,KAAK4L,OAAOO,WAAaA,WAGvBnM,KAAKuL,UACPyB,YAAchN,KAAKuL,QAAQlL,OAC3BL,KAAKuL,QAAQyB,aAAe,MAG9BhN,KAAKwL,UACL/E,KAAKsB,KAAK,QAAS8E,KACnB,IAAIM,QAAUN,IAAIK,MACdC,SAAWA,QAAQC,MAAgC,mBAAjBD,QAAQC,MAC5CD,QAAQC,MAAK,SAAU7J,QACrB,OAAO2J,KAAK,KAAM3J,WACjB8J,OAAM,SAAU3D,KACjB,OAAOwD,KAAKxD,MAAO,MAInB1J,KAAK0L,SAAW1L,KAAK2L,KAAKtL,OAAS,GACrCL,KAAKiE,aAxEgB,IAAjBjE,KAAKwL,SACPiB,KAAK5H,KAAK7E,MAcd,SAASkN,KAAMxD,IAAKnG,QACd0G,MAAQxD,KAAKgF,UAAYA,UAC3BxB,MAAO,EACPxD,KAAK+E,UACa,OAAdW,mBACK1F,KAAKmF,OAAOO,WACnBC,aAAaD,YAGXzC,IACFjD,KAAKsB,KAAK,QAAS2B,IAAKmD,MACA,IAAfE,aACW,OAAhBC,cACFvG,KAAK8E,QAAQyB,aAAepI,MAAMzD,UAAUc,MAAM4C,KAAKxC,UAAW,IAEpEoE,KAAKsB,KAAK,UAAWxE,OAAQsJ,MAG3BpG,KAAKgF,UAAYA,UACE,IAAjBhF,KAAK+E,SAAsC,IAArB/E,KAAKkF,KAAKtL,OAClCoM,KAAK5H,KAAK4B,MACDA,KAAKiF,SACdjF,KAAKxC,YAuCfgH,MAAM9J,UAAUmM,KAAO,WACrBtN,KAAK0L,SAAU,GAGjBT,MAAM9J,UAAU+C,IAAM,SAAUwF,KAC9BwC,YAAYrH,KAAK7E,MACjBA,KAAK2L,KAAKtL,OAAS,EACnBL,KAAKwL,QAAU,EACfiB,KAAK5H,KAAK7E,KAAM0J,oFCrKlBvE,OAAOwH,eAAeY,QAAS,aAAc,CAAE7H,OAAO,IACtD6H,YAAc,CACVC,SAASC,QACG,OAASA,OAAOC,SAAS,QAAS,EAAG,GAEjDC,UAAUF,SACC,CACHG,OAAQvJ,KAAKwJ,IAAIJ,OAAOK,YAAY,KACpCC,MAAON,OAAOO,aAAa,4FCRvC7I,OAAOwH,eAAeY,QAAS,aAAc,CAAE7H,OAAO,IA6BtD,SAASuI,kBAAkBR,OAAQS,QAC/B,MAAMxI,MAAQ+H,OAAOU,UAAUD,QAC/B,OAAiB,IAAVxI,MAAc,IAAMA,MAE/B,SAAS0I,aAAaX,OAAQY,YAC1B,MAAMH,OAvBU,EAiBK,GAMSG,WAC9B,MAAO,CACHT,OAAQK,kBAAkBR,OAAQS,OAAS,GAC3CH,MAAOE,kBAAkBR,OAAQS,SAGzCX,YAAc,CACVC,SAASC,QAC0B,IAA3BA,OAAOa,aAAa,IAzCd,IA4CHb,OAAOa,aAAa,GAE/BC,UAAUd,QACN,MAAMe,SAAWf,OAAOa,aAAa,GAC/BG,UAAYL,aAAaX,OAAQ,GACvC,GAAiB,IAAbe,SACA,OAAOC,UAEX,MAAMC,KAAO,CAACD,WACd,IAAK,IAAIJ,WAAa,EAAGA,WAAaG,SAAUH,YAAc,EAC1DK,KAAKjK,KAAK2J,aAAaX,OAAQY,aAOnC,MALe,CACXT,OAAQa,UAAUb,OAClBe,OAAQD,KACRX,MAAOU,UAAUV,8FC5D7B5I,OAAOwH,eAAeY,QAAS,aAAc,CAAE7H,OAAO,IAGtD6H,YAAc,CACVC,SAASC,QAC0B,IAA3BA,OAAOa,aAAa,IAHZ,IAMLb,OAAOa,aAAa,GAE/BX,UAAUF,QACCmB,IAAMC,IAAIlB,UAAUF,8FCXnCtI,OAAOwH,eAAeY,QAAS,aAAc,CAAE7H,OAAO,IACtD6H,YAAc,CACVC,SAASC,QAC6B,YAA3BA,OAAOO,aAAa,GAE/BL,UAAUF,SACC,CACHG,OAAQH,OAAOO,aAAa,IAC5BD,MAAON,OAAOO,aAAa,4FCRvC7I,OAAOwH,eAAeY,QAAS,aAAc,CAAE7H,OAAO,IACtD,MAAMoJ,UAAY,aAClBvB,YAAc,CACVgB,SAASd,QACL,MAAMsB,UAAYtB,OAAOC,SAAS,QAAS,EAAG,GAC9C,OAAQoB,UAAUE,KAAKD,YAE3BpB,UAAUF,SACC,CACHG,OAAQH,OAAOa,aAAa,GAC5BP,MAAON,OAAOa,aAAa,4FCVvCnJ,OAAOwH,eAAeY,QAAS,aAAc,CAAE7H,OAAO,IAStD,MAYMuJ,eAAiB,CACnBC,KAAM,GACNC,OAAQ,GAERC,OAAQ,GACRC,KAAM,GACNC,KAAM,GAENC,OAAQ,GACRC,KAAM,GACNC,KAAM,GACNC,KAAM,GACNC,KAAM,GACNC,KAAM,GAENC,KAAM,GACNC,KAAM,GACNC,KAAM,GACNC,KAAM,GACNC,KAAM,GACNC,KAAM,GAENC,KAAM,GACNC,KAAM,GACNC,KAAM,GACNC,KAAM,GAENC,KAAM,GACNC,KAAM,GAENC,KAAM,IACNC,KAAM,IACNC,KAAM,IAENC,KAAM,IACNC,KAAM,IAENC,KAAM,IACNC,KAAM,IAENC,KAAM,MAGV,SAASC,gBAAgBxD,OAAQyD,aAC7B,MAAMC,kBAAoBD,YA9CF,EA+CxB,MAAO,CACHzD,OAAOC,SAAS,QAASwD,YAAaC,mBACtC1D,OAAO2D,aAAaD,oBAG5B,SAAS/C,aAAanP,MAClB,MAAMoS,KAAOpC,eAAehQ,MAC5B,MAAO,CAAE8O,MAAOsD,KAAMzD,OAAQyD,KAAMpS,KAAAA,MAExCsO,aAAe,CACXC,SAASC,QACG,SAAWA,OAAOC,SAAS,QAAS,EAAG,GAEnDa,UAAUd,QACN,MAAM6D,aAAe7D,OAAOpN,OACtBkR,WAAa9D,OAAO2D,aAvEP,GAwEnB,IAAIF,YAzEQ,EA0ERM,YAAcP,gBAAgBxD,OAAQyD,aACtCzC,UAAYL,aAAaoD,YAAY,IAEzC,GADAN,aAAeM,YAAY,GACvBN,cAAgBK,WAChB,OAAO9C,UAEX,MAAMlL,OAAS,CACXqK,OAAQa,UAAUb,OAClBe,OAAQ,CAACF,WACTV,MAAOU,UAAUV,OAErB,KAAOmD,YAAcK,YAAcL,YAAcI,cAC7CE,YAAcP,gBAAgBxD,OAAQyD,aACtCzC,UAAYL,aAAaoD,YAAY,IACrCN,aAAeM,YAAY,GAC3BjO,OAAOoL,OAAOlK,KAAKgK,WAEvB,OAAOlL,iGCpGf4B,OAAOwH,eAAeY,QAAS,aAAc,CAAE7H,OAAO,IACtD6H,YAAc,CACVC,SAASC,QAEmC,aAAjCA,OAAOC,SAAS,MAAO,EAAG,GAErCC,UAAUF,SACC,CACHG,OAAQH,OAAO2D,aAAa,IAC5BrD,MAAON,OAAO2D,aAAa,2FCTvCjM,OAAOwH,eAAeY,QAAS,aAAc,CAAE7H,OAAO,IACtD,MAAM+L,cACI,WADJA,cAGI,WAHJA,cAII,WAJJA,cAKI,WAaJC,UAAaC,MACR,CACH/D,OAAQ+D,IAAIP,aAAa,GACzBrD,MAAO4D,IAAIP,aAAa,KAGhC7D,YAAc,CACVgB,SAASd,QACL,MAAMsB,UAAYtB,OAAOC,SAAS,MAAO,EAAG,GACtCkE,gBAAkBnE,OAAO2D,aAAa,GAC5C,GAAIrC,YAAc0C,eAAiBG,gBAAkB,EACjD,OAAO,EAEX,MAAMC,cAAgBD,gBAAkB,EAClCE,cAAgBrE,OAAO2D,aAAaQ,iBAE1C,OADgBnE,OAAOxL,MAAM4P,cAAeA,cAAgBC,eAC7CpE,SAAS,MAAO,EAAG,KAAO+D,eAE7ClD,UAAUd,QACN,MAAMmE,gBAAkBnE,OAAO2D,aAAa,GAE5C,IAAIlD,OAAS0D,gBAAkB,EADTnE,OAAOsE,aAAaH,gBAAkB,GAG5D,OADoBnE,OAAOC,SAAS,MAAOQ,OAAQA,OAAS,IAExD,KAAKuD,cAID,OADAvD,OAASA,OAAS,EADJ,EApCF,CAACyD,MACzB,MAAMK,KAAOL,IAAIxD,UAAU,GAC3B,IAAID,OAAS,EAAK,EAAI8D,KAGtB9D,OAASA,OAAS,EAFEyD,IAAII,aAAa7D,SACF,EAAI8D,MAIvC,OAAO9D,OAAS,EAFUyD,IAAII,aAAa7D,SACC,GAAK8D,OA8BPC,CAAoBxE,OAAOxL,MAAMiM,OAAS,IACjEwD,UAAUjE,OAAOxL,MAAMiM,OAAS,EAAGA,OAAS,KACvD,KAAKuD,cACD,OAAOC,UAAUjE,OAAOxL,MAAMiM,OAAS,EAAGA,OAAS,KACvD,QACI,MAAM,IAAI3L,UAAU,6BAA+BkL,OAAOC,SAAS,QAASQ,OAAQA,OAAS,mGCnD7G/I,OAAOwH,eAAeY,QAAS,aAAc,CAAE7H,OAAO,IAStD6H,iBAPA,SAAkBE,OAAQyE,KAAMhE,OAAQiE,aAKpC,OAJAjE,OAASA,QAAU,EAGJT,OADK,WAAayE,MADlBC,YAAc,KAAO,OAGtBtN,KAAK4I,OAAQS,iHCH/B/I,OAAOwH,eAAeY,QAAS,aAAc,CAAE7H,OAAO,IAWtD,SAAS0M,OAAO3E,QACZ,MAVgB,aAURA,OAAOC,SAAS,MAAO,EAAG,GAEtC,SAAS2E,YAAY5E,OAAQ3I,OACzB,MAAO,CACH8I,OAAQH,OAAOsE,aAAajN,OAC5BiJ,MAAON,OAAOsE,aAAajN,MAAQ,IAG3C,SAASwN,kBAAkB7E,OAAQ3I,OAE/B,MAAMyN,UAAY9E,OAAOxL,MAnBA,EAmB4B6C,OAE/C0N,UAAYD,UAAU7E,SAAS,MApBf,EAoByC+E,GAEzDN,YApBoB,SAoBNK,UAEpB,GAAIL,aArByB,SAoBNK,UAEnB,OAGR,SAA4BD,UAAWJ,aAKnC,MAIMO,oBAAsBC,WAAWC,SAASL,UAAW,GAD5CE,GACwDN,aACvE,IAAK,IAAIU,qBAAuB,EAAGA,qBAAuBH,oBAAqBG,uBAAwB,CACnG,MAAM5O,MAAQiK,GAlCE,GAkCsC2E,qBAChD3O,IAAMD,MAnCI,GAqChB,GAAIA,MAAQsO,UAAUlS,OAClB,OAEJ,MAAMyS,MAAQP,UAAUtQ,MAAMgC,MAAOC,KAGrC,GAAkB,MAFAyO,WAAWC,SAASE,MAAO,GAAI,EAAGX,aAE7B,CAEnB,GAAmB,IADAQ,WAAWC,SAASE,MAAO,GAAI,EAAGX,aAEjD,OAKJ,GAA2B,IADAQ,WAAWC,SAASE,MAAO,GAAI,EAAGX,aAEzD,OAEJ,OAAOQ,WAAWC,SAASE,MAAO,GAAI,EAAGX,eAlCtCY,CAAmBR,UAAWJ,aAsC7C,SAASa,eAAevF,OAAQ3I,OAE5B,GAAIA,MAAQ2I,OAAOpN,OACf,MAAM,IAAIkC,UAAU,uCAGxB,GAAsB,MAAlBkL,OAAO3I,OACP,MAAM,IAAIvC,UAAU,uCAG5BgL,YAAc,CACVC,SAASC,QAEG,SADUA,OAAOC,SAAS,MAAO,EAAG,GAGhDa,UAAUd,QAGN,IAAIwF,YACA/F,KACJ,IAHAO,OAASA,OAAOxL,MAAM,GAGfwL,OAAOpN,QAAQ,CAElB,MAAMQ,EAAI4M,OAAOsE,aAAa,GAU9B,GATIK,OAAO3E,UACPwF,YAAcX,kBAAkB7E,OAAQ5M,IAG5CmS,eAAevF,OAAQ5M,GAIvBqM,KAAOO,OAAO5M,EAAI,GACL,MAATqM,MAA0B,MAATA,MAA0B,MAATA,KAAe,CACjD,MAAMmE,KAAOgB,YAAY5E,OAAQ5M,EAAI,GAErC,OAAKoS,YAGE,CACHrF,OAAQyD,KAAKzD,OACbqF,YAAAA,YACAlF,MAAOsD,KAAKtD,OALLsD,KASf5D,OAASA,OAAOxL,MAAMpB,EAAI,GAE9B,MAAM,IAAI0B,UAAU,qHCtH5B4C,OAAOwH,eAAeY,QAAS,aAAc,CAAE7H,OAAO,IAEtD6H,YAAc,CACVC,SAASC,QAFK,WAGWA,OAAOC,SAAS,QAAS,EAAG,GAErDC,UAAUF,SACC,CACHG,OAAQH,OAAOO,aAAa,IAC5BD,MAAON,OAAOO,aAAa,4FCTvC7I,OAAOwH,eAAeY,QAAS,aAAc,CAAE7H,OAAO,IAKtD6H,YAAc,CACVgB,SAASd,QACL,GANa,eAMQA,OAAOC,SAAS,QAAS,EAAG,GAAI,CACjD,IAAIwF,UAAYzF,OAAOC,SAAS,QAAS,GAAI,IAI7C,GARc,SAKVwF,YACAA,UAAYzF,OAAOC,SAAS,QAAS,GAAI,KARzB,SAUhBwF,UACA,MAAM,IAAI3Q,UAAU,eAExB,OAAO,EAEX,OAAO,GAEXoL,UAAUF,QAfY,SAgBdA,OAAOC,SAAS,QAAS,GAAI,IACtB,CACHE,OAAQH,OAAO2D,aAAa,IAC5BrD,MAAON,OAAO2D,aAAa,KAG5B,CACHxD,OAAQH,OAAO2D,aAAa,IAC5BrD,MAAON,OAAO2D,aAAa,2FC5BvCjM,OAAOwH,eAAeY,QAAS,aAAc,CAAE7H,OAAO,IACtD,MAAMyN,SAAW,CACbC,GAAI,YACJC,GAAI,YACJC,GAAI,YACJC,GAAI,MACJC,GAAI,MACJC,GAAI,MACJC,GAAI,MACJC,GAAI,OAEFC,WAAazO,OAAOuF,KAAKyI,UACzBU,SAAW,CACbC,QAAUC,QACN,IAAIC,WAAa,GACjB,KAAOD,MAAM1T,OAAS,GAAG,CACrB,MAAM4T,KAAOF,MAAMjH,QACnB,GAAgB,MAAZmH,KAAK,GAAT,CAGAD,WAAaC,KAAKvR,MAAM,KACxB,OAEJ,GAA0B,IAAtBsR,WAAW3T,OACX,MAAO,CACHuN,OAAQsG,SAASF,WAAW,GAAI,IAChCjG,MAAOmG,SAASF,WAAW,GAAI,KAInC,MAAM,IAAIzR,UAAU,gBAG5B4R,IAAMJ,QACF,MAAM1C,KAAO,GACb,KAAO0C,MAAM1T,OAAS,GAAG,CACrB,MAAM4T,KAAOF,MAAMjH,QACnB,GAAImH,KAAK5T,OAAS,IAAM4T,KAAKG,WAAW,GAAK,IACzC,SAEJ,MAAOtU,IAAK4F,OAASuO,KAAKvR,MAAM,KAIhC,GAHI5C,KAAO4F,QACP2L,KAAKvR,IAAIuU,eAAiBH,SAASxO,MAAO,KAE1C2L,KAAKzD,QAAUyD,KAAKtD,MACpB,MAGR,GAAIsD,KAAKzD,QAAUyD,KAAKtD,MACpB,MAAO,CACHH,OAAQyD,KAAKzD,OACbG,MAAOsD,KAAKtD,OAIhB,MAAM,IAAIxL,UAAU,iBAIhCgL,YAAc,CACVgB,SAASd,QACL,MAAMsB,UAAYtB,OAAOC,SAAS,QAAS,EAAG,GAC9C,OAAOkG,WAAWU,SAASvF,YAE/BR,UAAUd,QACN,MAAMsB,UAAYtB,OAAOC,SAAS,QAAS,EAAG,GACxCzO,KAAOkU,SAASpE,WAEhBgF,MAAQtG,OAAOC,SAAS,QAAS,GAAGhL,MAAM,WAEhD,OADgBmR,SAAS5U,OAAS4U,SAASC,SAC5BC,8FCtEvB5O,OAAOwH,eAAeY,QAAS,aAAc,CAAE7H,OAAO,IACtD6H,YAAc,CACVC,SAASC,QACG,SAAWA,OAAOC,SAAS,QAAS,EAAG,GAEnDC,UAAUF,SACC,CACHG,OAAQH,OAAO2D,aAAa,IAC5BrD,MAAON,OAAO2D,aAAa,4FCRvCjM,OAAOwH,eAAeY,QAAS,aAAc,CAAE7H,OAAO,IACtD,MAAM6O,OAAS,mCACTC,iBAAmB,CACrB5G,OAAQ,4BACRpK,KAAM+Q,OACNE,QAAS,0BACT1G,MAAO,4BAGL2G,MAAQ,CACVC,GAAI,GAFQ,KAGZC,GAAI,GACJC,GAAI,EACJpN,EAAG,GALS,KAKM,IAClBqN,GAAI,GANQ,KAMO,GACnBC,GAAI,GAAK,GAAK,GACdC,GAAI,GAAK,IAEb,SAASC,YAAY/P,KACjB,MAAMuC,EAAI,oBAAoBzF,KAAKkD,KACnC,GAAKuC,EAGL,OAAOpD,KAAK6Q,MAAMC,WAAW1N,EAAE,KAAOiN,MAAMjN,EAAE,KAAO,IAEzD,SAAS2N,aAAaX,SAClB,MAAMY,OAASZ,QAAQ/R,MAAM,KAC7B,MAAO,CACHkL,OAAQqH,YAAYI,OAAO,IAC3BtH,MAAOkH,YAAYI,OAAO,KAsClC9H,YAAc,CACVgB,SAASd,QACL,MAAMxI,IAAMhF,OAAOwN,QACnB,OAAO8G,OAAOvF,KAAK/J,MAEvBsJ,UAAUd,QACN,MAAMjK,KAAOiK,OAAOC,SAAS,QAAQ4H,MAAMd,iBAAiBhR,MAC5D,GAAIA,KAAM,CACN,MAAM+R,MA3ClB,SAAyB/R,MACrB,MAAMuK,MAAQvK,KAAK8R,MAAMd,iBAAiBzG,OACpCH,OAASpK,KAAK8R,MAAMd,iBAAiB5G,QACrC6G,QAAUjR,KAAK8R,MAAMd,iBAAiBC,SAC5C,MAAO,CACH7G,OAAQA,QAAUqH,YAAYrH,OAAO,IACrC6G,QAASA,SAAWW,aAAaX,QAAQ,IACzC1G,MAAOA,OAASkH,YAAYlH,MAAM,KAoChByH,CAAgBhS,KAAK,IACnC,GAAI+R,MAAMxH,OAASwH,MAAM3H,OACrB,OAnChB,SAA+B2H,OAC3B,MAAO,CACH3H,OAAQ2H,MAAM3H,OACdG,MAAOwH,MAAMxH,OAgCE0H,CAAsBF,OAEjC,GAAIA,MAAMd,QACN,OAhChB,SAA4Bc,MAAOd,SAC/B,MAAMiB,MAAQjB,QAAQ1G,MAAQ0G,QAAQ7G,OACtC,OAAI2H,MAAMxH,MACC,CACHH,OAAQvJ,KAAKsR,MAAMJ,MAAMxH,MAAQ2H,OACjC3H,MAAOwH,MAAMxH,OAGjBwH,MAAM3H,OACC,CACHA,OAAQ2H,MAAM3H,OACdG,MAAO1J,KAAKsR,MAAMJ,MAAM3H,OAAS8H,QAGlC,CACH9H,OAAQ6G,QAAQ7G,OAChBG,MAAO0G,QAAQ1G,OAgBA6H,CAAmBL,MAAOA,MAAMd,SAG/C,MAAM,IAAIlS,UAAU,uGC9D5B,SAASsT,UAAUpI,OAAQ0E,aACvB,MAAM2D,IAAMnD,WAAWC,SAASnF,OAAQ,GAAI,EAAG0E,aAE/C,OADaQ,WAAWC,SAASnF,OAAQ,GAAI,GAAI0E,cACjC,IAAM2D,IAG1B,SAASC,QAAQtI,QACb,GAAIA,OAAOpN,OAAS,GAChB,OAAOoN,OAAOxL,MAAM,IA7B5BkD,OAAOwH,eAAeY,QAAS,aAAc,CAAE7H,OAAO,IAkEtD,MAAMsQ,WAAa,CAEf,WACA,YAEJzI,aAAe,CACXC,SAASC,QACEuI,WAAW1B,SAAS7G,OAAOC,SAAS,MAAO,EAAG,IAEzDa,UAAUd,OAAQwI,UACd,IAAKA,SACD,MAAM,IAAI1T,UAAU,+BAGxB,MAAM4P,YAA8C,OAvB5D,SAA6B1E,QACzB,MAAMsB,UAAYtB,OAAOC,SAAS,QAAS,EAAG,GAC9C,MAAI,OAASqB,UACF,KAEF,OAASA,UACP,UADN,EAkBmBmH,CAAoBzI,QAIlC0I,KAnDd,SAAqB1I,OAAQ0E,aACzB,MAAMgE,KAAO,GACb,IAAIC,KAAO3I,OACX,KAAO2I,MAAQA,KAAK/V,QAAQ,CACxB,MAAMgW,KAAO1D,WAAWC,SAASwD,KAAM,GAAI,EAAGjE,aACxClT,KAAO0T,WAAWC,SAASwD,KAAM,GAAI,EAAGjE,aACxC9R,OAASsS,WAAWC,SAASwD,KAAM,GAAI,EAAGjE,aAEhD,GAAa,IAATkE,KACA,MAKe,IAAXhW,QAA0B,IAATpB,MAAuB,IAATA,OAC/BkX,KAAKE,MAAQR,UAAUO,KAAMjE,cAGjCiE,KAAOL,QAAQK,MAGvB,OAAOD,KA8BUG,CA9ErB,SAAiB7I,OAAQwI,SAAU9D,aAC/B,MAAMoE,UAAY5D,WAAWC,SAASnF,OAAQ,GAAI,EAAG0E,aAErD,IAAIqE,WAAa,KACjB,MAAMC,SAAWC,GAAGC,SAASV,UAAU5E,KACnCkF,UAAYC,WAAaC,WACzBD,WAAaC,SAAWF,UAAY,IAGxC,MAAMK,UAAYC,OAAOC,MAAMN,YACzBO,WAAaL,GAAGM,SAASf,SAAU,KAEzC,OADAS,GAAGO,SAASF,WAAYH,UAAW,EAAGJ,WAAYD,WAC3CK,UAAU3U,MAAM,GAgEDiV,CAAQzJ,OAAQwI,SAAU9D,aAERA,aAC9BpE,MAAQoI,KAAK,KACbvI,OAASuI,KAAK,KACpB,IAAKpI,QAAUH,OACX,MAAM,IAAIrL,UAAU,8BAExB,MAAO,CAAEqL,OAAAA,OAAQG,MAAAA,kGC1FzB5I,OAAOwH,eAAeY,QAAS,aAAc,CAAE7H,OAAO,IAqBtD6H,aAAe,CACXgB,SAASd,QACL,MAAM0J,WAAa,SAAW1J,OAAOC,SAAS,QAAS,EAAG,GACpD0J,WAAa,SAAW3J,OAAOC,SAAS,QAAS,EAAG,IACpD2J,UAAY,QAAU5J,OAAOC,SAAS,QAAS,GAAI,IACzD,OAAQyJ,YAAcC,YAAcC,WAExC9I,UAAUd,QACN,MAAM6J,YAAc7J,OAAOC,SAAS,QAAS,GAAI,IAGjD,GAFAD,OAASA,OAAOxL,MAAM,GAAI,IAEN,SAAhBqV,YAAwB,CACxB,MAAMC,eAAiB9J,OAAO,GAExB+J,SAAuC,IAAV,EAAjBD,gBAClB,GAF+C,IAAV,IAAjBA,iBAEFC,SACd,OApChB,SAA2B/J,QACvB,MAAO,CACHG,OAAQ,EAAIH,OAAOgK,WAAW,EAAG,GACjC1J,MAAO,EAAIN,OAAOgK,WAAW,EAAG,IAiCjBC,CAAkBjK,QAIzB,MAAM,IAAIlL,UAAU,gBAI5B,GAAoB,SAAhB+U,aAAwC,KAAd7J,OAAO,GACjC,OAjCZ,SAAwBA,QAGpB,MAAO,CACHG,OAAgC,MAAxBH,OAAOkK,YAAY,GAC3B5J,MAA+B,MAAxBN,OAAOkK,YAAY,IA4BfC,CAAenK,QAG1B,MAAMsB,UAAYtB,OAAOC,SAAS,MAAO,EAAG,GAC5C,GAAoB,SAAhB4J,aAAwC,WAAdvI,UAC1B,OA5CZ,SAA2BtB,QACvB,MAAO,CACHG,OAAQ,IAAmB,GAAZH,OAAO,KAAa,GAAOA,OAAO,IAAM,GAAmB,IAAZA,OAAO,KAAc,GACnFM,MAAO,IAAmB,GAAZN,OAAO,KAAc,EAAKA,OAAO,KAyCpCoK,CAAkBpK,QAE7B,MAAM,IAAIlL,UAAU,4GCrD5B4C,OAAOwH,eAAeY,QAAS,aAAc,CAAE7H,OAAO,IAiBtD6H,qBAAuB,CACnBuK,IAAKC,IAAMC,IACXC,IAAKC,IAAMC,IACXC,IAAKC,IAAMC,IACXC,IAAKC,IAAMC,IACXC,KAAMC,KAAOC,KACbC,IAAKjK,IAAMC,IACXiK,IAAKC,IAAMC,IACXC,IAAKC,IAAMC,IACXC,IAAKC,IAAMC,IACXC,IAAKC,IAAMC,IACXC,IAAKC,IAAMC,IACXC,IAAKC,IAAMC,IACXC,IAAKC,IAAMC,IACXC,IAAKC,IAAMC,IACXC,KAAMC,KAAOC,KACbC,KAAMC,KAAOC,+GCjCjBxV,OAAOwH,eAAeY,QAAS,aAAc,CAAE7H,OAAO,IAEtD,MAAMgF,KAAOvF,OAAOuF,KAAKkQ,MAAQC,cAE3BC,WAAa,CACfC,GAAM,MACNC,GAAM,MACNC,GAAM,MACNC,GAAM,MACNC,GAAM,OACNC,GAAM,OACNC,GAAM,OACNC,IAAM,OACNC,IAAM,MACNC,IAAM,OAaVjO,iBAXA,SAAkBE,QACd,MAAMgO,KAAOhO,OAAO,GACpB,GAAIgO,QAAQX,WAAY,CACpB,MAAM7b,KAAO6b,WAAWW,MACxB,GAAIb,MAAQC,aAAa5b,MAAMuO,SAASC,QACpC,OAAOxO,KAIf,OAAOyL,KAAKgR,KADI5b,KAAQ8a,MAAQC,aAAa/a,KAAK0N,SAASC,wHCrB/D,GAHAtI,OAAOwH,eAAeY,QAAS,aAAc,CAAE7H,OAAO,MAGhD,aAAcgR,IAAK,CACrB,MAAMiF,WACFpN,YAAYqN,IACR5b,KAAK4b,GAAKA,GAEdrN,OACI,OAAO,IAAIsN,QAAQ,CAAC3Z,QAAS4Z,UACzBpF,GAAGqF,MAAM/b,KAAK4b,GAAI,CAAClS,IAAKsS,SAChBtS,IACAoS,OAAOpS,KAGPxH,QAAQ8Z,WAKxBzN,KAAKd,OAAQS,OAAQ7N,OAAQ+J,UACzB,OAAO,IAAIyR,QAAQ,CAAC3Z,QAAS4Z,UACzBpF,GAAGuF,KAAKjc,KAAK4b,GAAInO,OAAQS,OAAQ7N,OAAQ+J,SAAWV,MAC5CA,IACAoS,OAAOpS,KAGPxH,cAKhBqM,QACI,OAAO,IAAIsN,QAAQ,CAAC3Z,QAAS4Z,UACzBpF,GAAGwF,MAAMlc,KAAK4b,GAAKlS,MACXA,IACAoS,OAAOpS,KAGPxH,eAMpBiD,OAAOwH,eAAe+J,GAAI,WAAY,CAClChR,MAAO,CACHyW,KAAM,CAAClG,SAAUmG,YAAeP,QAAQ,CAAC3Z,QAAS4Z,UAC9CpF,GAAGyF,KAAKlG,SAAUmG,MAAO,CAAC1S,IAAKkS,MACvBlS,IACAoS,OAAOpS,KAGPxH,QAAQ,IAAIyZ,WAAWC,UAKvChW,UAAU,iEC1DlB,IAAIyW,UAAarc,gBAAQA,eAAKqc,WAAc,SAAUC,QAASC,WAAYC,EAAGC,WAE1E,OAAO,IAAKD,IAAMA,EAAIX,WAAU,SAAU3Z,QAAS4Z,QAC/C,SAASY,UAAUhX,OAAS,IAAMiX,KAAKF,UAAUvP,KAAKxH,QAAW,MAAOkC,GAAKkU,OAAOlU,IACpF,SAASgV,SAASlX,OAAS,IAAMiX,KAAKF,UAAiB,MAAE/W,QAAW,MAAOkC,GAAKkU,OAAOlU,IACvF,SAAS+U,KAAKpZ,QAJlB,IAAemC,MAIanC,OAAOkJ,KAAOvK,QAAQqB,OAAOmC,QAJ1CA,MAIyDnC,OAAOmC,MAJhDA,iBAAiB8W,EAAI9W,MAAQ,IAAI8W,GAAE,SAAUta,SAAWA,QAAQwD,WAIT0H,KAAKsP,UAAWE,UAClGD,MAAMF,UAAYA,UAAUrV,MAAMkV,QAASC,YAAc,KAAKrP,YAGtE/H,OAAOwH,eAAeY,QAAS,aAAc,CAAE7H,OAAO,IAStD,MAEMmX,QAAQ,IAAIC,MAAQhJ,QAAQ,CAAE3I,YAAa,IAAKG,WAAW,IAQjE,SAASyR,OAAOtP,OAAQwI,UAEpB,MAAMhX,KAAO+d,WAAWC,SAASxP,QAEjC,GAAIxO,MAAQA,QAAQ2b,MAAQC,aAAc,CACtC,MAAMxJ,KAAOuJ,MAAQC,aAAa5b,MAAM0O,UAAUF,OAAQwI,UAC1D,QAAa/V,IAATmR,KAEA,OADAA,KAAKpS,KAAOA,KACLoS,KAIf,MAAM,IAAI9O,UAAU,0BAA4BtD,KAAO,WAAagX,SAAW,KA0CnF,SAASxH,UAAUyO,MAAOC,UAEtB,GAAItG,OAAOuG,SAASF,OAChB,OAAOH,OAAOG,OAGlB,GAAqB,iBAAVA,MACP,MAAM,IAAI3a,UAAU,sBAGxB,MAAM0T,SAAW3T,KAAKJ,QAAQgb,OAC9B,GAAwB,mBAAbC,SAKN,CAED,OAAOJ,OAjCf,SAA0B9G,UAEtB,MAAMc,WAAaL,GAAGM,SAASf,SAAU,KACnC5E,KAAOqF,GAAG2G,UAAUtG,YAAY1F,KAChCmF,WAAanS,KAAKC,IAAI+M,KArDV,QAsDZ5D,OAASoJ,OAAOC,MAAMN,YAG5B,OAFAE,GAAGO,SAASF,WAAYtJ,OAAQ,EAAG+I,WAAY,GAC/CE,GAAG4G,UAAUvG,YACNtJ,OAwBY8P,CAAiBtH,UACVA,UANtB4G,QAAMpY,KAAK,IA/CnB,SAA2BwR,UACvB,OAAOoG,UAAUrc,UAAM,OAAQ,GAAQ,YACnC,MAAMwd,aAAe9G,GAAG+G,SAAStB,KAAKlG,SAAU,MAC1C5E,KAAEA,YAAemM,OAAOE,OAC9B,GAAIrM,MAAQ,EACR,MAAM,IAAInJ,MAAM,cAEpB,MAAMsO,WAAanS,KAAKC,IAAI+M,KApCd,QAqCR5D,OAASoJ,OAAOC,MAAMN,YAG5B,aAFMgH,OAAOvB,KAAKxO,OAAQ,EAAG+I,WAAY,SACnCgH,OAAOtB,QACNzO,UAoCUkQ,CAAkB1H,UAC9B7I,KAAMK,QAAWmQ,QAAQC,SAASV,SAAU,KAAMJ,OAAOtP,OAAQwI,YACjE5I,MAAM8P,WAnBnB9X,eAAiBkI,QAAUkB,UA0B3BlB,kBAAoBkB,UACpBlB,uBAA0BuQ,IAAQjB,QAAM1R,YAAc2S,GACtDvQ,cAAgBpI,OAAOuF,KAAKkQ,MAAQC,0FC1GpC,MAAMkD,aACD,wDADCA,eAGC,gEAHDA,cAIA,mCAJAA,oBAKM,+BALNA,mBAMK,4BANLA,aAOD,0CAPCA,eAQC,2DARDA,aASD,sEATCA,aAUD,gCAVCA,cAWA,8DAXAA,cAYA,uEAZAA,aAaD,+DAbCA,eAcC,wCAdDA,cAeA,yEAfAA,eAgBC,uDAhBDA,eAkBC,4CAlBDA,qBAmBO,gFAnBPA,sBAoBQ,gFApBRA,kBAqBI,4EArBJA,kBAsBI,6EAtBJA,mBAuBK,6EAvBLA,mBAwBK,6EAxBLA,kBAyBI,4EAzBJA,0BA0BY,0EA1BZA,kCA4BF,qFA5BEA,kCA8BF,wFA9BEA,4BA+Bc,+EA/BdA,+BAiCF,kFAjCEA,cAkCA,4DChCOC,SAAW,wCACXC,SAAW,0CACXC,SAAW,kBACXC,UAAY,mCAGZC,SAAW,CAACC,IAAKC,MAAOC,OACd,CAACF,IAAKC,MAAOC,MAC/BC,IAAKxf,GAGgB,KADpBA,EAAIkV,SAASlV,GAAG0O,SAAS,KAChBrN,OAAe,IAAIrB,EAAMA,GAEnC4D,KAAK,ICfG6b,WAAa,cACbC,gBAAkB,aAClBC,WAAa,WACbC,QAAU,cACVC,UAAY,cAEZC,WAAcC,YAClB1a,KAAK6Q,MAAmB,KAAb6J,YAWPC,UAAaC,UACjB5a,KAAK6Q,MAAM+J,SAAW,KAGlBC,YAAeC,YACnB9a,KAAK6Q,MAAmB,GAAbiK,YAOPC,WAAcD,YAClB9a,KAAK6Q,MAAmB,EAAbiK,YAePE,YAAeN,YACnBC,UAAUF,WAAWC,aAOjBO,WAAcP,aACzB,OAbwBQ,UAaPP,UAAUF,WAAWC,aAZ/B1a,KAAK6Q,MAAMqK,UAAY,IADP,IAACA,WAwBbC,WAAcC,WAClBP,YALkB,CAACO,WACnBpb,KAAK6Q,MAAkB,GAAZuK,WAICC,CAAYD,YAWpBE,aAAgBZ,aAC3B,OA7CyBa,SA6CPN,WAAWP,YA5CtB1a,KAAK6Q,MAAM0K,SAAW,GADL,IAACA,UAwDdC,WAAcC,YAClBzb,KAAK6Q,MAAmB,EAAb4K,YCrDdC,eAAkBC,kBACtB,GAAI7a,OAAOhE,UAAU7B,eAAeuF,KAAKob,WAAYD,gBAAgB3L,eAAgB,CACnF,MAAOgK,IAAKC,MAAOC,MAAQ0B,WAAWD,gBAAgB3L,eAEtD,OAAO+J,SAASC,IAAKC,MAAOC,MACvB,GAAIP,SAAShP,KAAKgR,iBAAkB,CACzC,MAAME,aAAeF,gBAAgB1K,MAAM0I,UACrCK,IAAM6B,aAAa,GACnB5B,MAAQ4B,aAAa,GACrB3B,KAAO2B,aAAa,GAE1B,OAAO9B,SAASC,IAAKC,MAAOC,MACvB,GAAIN,SAASjP,KAAKgR,iBAAkB,CACzC,MAAME,aAAeF,gBAAgB1K,MAAM2I,UAK3C,MFpCoB,EAACkC,IAAKC,WAAYC,cAKxC,IAAIhC,IAAKC,MAAOC,KAChB,GALA4B,KAAO,IAEPE,YAAc,IAGK,KAJnBD,YAAc,KAMZ/B,IAAMC,MAAQC,KAAO8B,eAChB,CACL,MAAMC,QAAU,CAAC3d,EAAG4d,EAAGnhB,KACjBA,EAAI,IAAGA,GAAK,GACZA,EAAI,IAAGA,GAAK,GACZA,EAAI,EAAI,EAAUuD,EAAc,GAAT4d,EAAI5d,GAASvD,EACpCA,EAAI,GAAcmhB,EAClBnhB,EAAI,EAAI,EAAUuD,GAAK4d,EAAI5d,IAAM,EAAI,EAAIvD,GAAK,EAC3CuD,GAEH4d,EACJF,WAAa,GACTA,YAAc,EAAID,YAClBC,WAAaD,WAAaC,WAAaD,WACvCzd,EAAI,EAAI0d,WAAaE,EAC3BlC,IAAMiC,QAAQ3d,EAAG4d,EAAGJ,IAAM,EAAI,GAC9B7B,MAAQgC,QAAQ3d,EAAG4d,EAAGJ,KACtB5B,KAAO+B,QAAQ3d,EAAG4d,EAAGJ,IAAM,EAAI,GAEjC,MAAO,CAAC9B,IAAKC,MAAOC,MACjBC,IAAKxf,IACJ,MAAMwhB,IAAMnc,KAAK6Q,MAAU,IAAJlW,GAAS0O,SAAS,IACzC,OAAsB,IAAf8S,IAAIngB,OAAe,IAAImgB,IAAQA,MAEvC5d,KAAK,KEIC6d,CAJKP,aAAa,GACNA,aAAa,GACbA,aAAa,IAG3B,GAAIhC,SAASlP,KAAKgR,iBAAkB,CAGzC,OAFqBA,gBAAgB1K,MAAM4I,UAEvB,GACf,GAAIC,UAAUnP,KAAKgR,iBAAkB,CAC1C,MAAME,aAAeF,gBAAgB1K,MAAM6I,WAK3C,MFZqB,EAACE,IAAKC,MAAOC,OACf,CAACF,IAAKC,MAAOC,MAAMC,IAAKxf,GAAM,GAAGA,IAAIA,KAAK4D,KAAK,IEW3D8d,CAJKR,aAAa,GACXA,aAAa,GACdA,aAAa,IAI1B,MAAO,UA2ELS,aAAgBC,WACIC,SAAS,CAC/BC,eAAgB,CAAE3hB,EAAG4e,gBAEpBgD,IAAI,KAAM,OACVC,IAAI,KAAM,MAAO,SACjBA,IAAI,KAAM,OAAQJ,WAClBnf,KAgBCwf,eAAiB,CAAChiB,KAAO,aACH4hB,SAAS,CACjCC,eAAgB,CAAE3hB,EAAG4e,gBAEpBgD,IAAI,KAAM,aACVC,IAAI,KAAM,MAAO/hB,MACjBwC,KAgBCyf,UAAY,IACKL,SAAS,CAC5BC,eAAgB,CAAE3hB,EAAG4e,gBAEpBgD,IAAI,KAAM,KACVtf,KAKC0f,aAAe,IACKN,SAAS,CAC/BC,eAAgB,CAAE3hB,EAAG4e,gBAEpBgD,IAAI,KAAM,KACVtf,KAKC2f,eAAiB,CAACniB,KAAO,WACH4hB,SAAS,CACjCC,eAAgB,CAAE3hB,EAAG4e,gBAEpBgD,IAAI,KAAM,KACVC,IAAI,KAAM,MAAO/hB,MACjBwC,KAgBC4f,YAAc,CAClBC,WAAa,MACbC,WAAa,EACbC,cAAgB,EAChBC,YAAc1B,eAAe,SAC7B2B,aAAe,WAEQb,SAAS,CAC9BC,eAAgB,CAAE3hB,EAAG4e,gBAEpBgD,IAAI,KAAMO,YACVN,IAAI,KAAM,MAAOU,cACjBV,IAAI,KAAM,KAAMO,YAChBP,IAAI,KAAM,QAASQ,eACnBR,IAAI,KAAM,QAASS,aACnBhgB,KAKCkgB,iBAAoBtgB,MACHwf,SAAS,CAC5BC,eAAgB,CAAE3hB,EAAG4e,gBAEpBgD,IAAI,KAAM,KACVC,IAAI,OAAQ,QAAS,YACrBY,IAAIvgB,MACJI,KAKCogB,mBAAsBC,aAC1B,MAAMC,sBAAwBlB,SAAS,CACrCC,eAAgB,CAAE3hB,EAAG4e,gBACpBgD,IAAI,KAAM,OAsCb,OArCIe,YAAcA,WAAWrc,cAAgBN,QAC3CA,OAAOuF,KAAKoX,YAAYhW,QAAShM,MAE/B,OAAQA,KACN,IAAK,SACH,MAAMkiB,aAAed,YACrBa,sBAAsBE,OAAOD,cAC7B,MACF,IAAK,IACH,MAAME,gBAAkBf,eACxBY,sBAAsBE,OAAOC,iBAC7B,MACF,IAAK,IACH,MAAMC,kBAAoBf,iBAC1BW,sBAAsBE,OAAOE,mBAC7B,MACF,IAAK,QACH,MAAMC,eAlKIxB,UAkKuBkB,WAAWhiB,KAjK9B+gB,SAAS,CAC7BC,eAAgB,CAAE3hB,EAAG4e,gBAEpBgD,IAAI,KAAM,SACVC,IAAI,KAAM,MAAOJ,WACjBnf,MA6JKsgB,sBAAsBE,OAAOG,eAC7B,MACF,IAAK,kBACH,MAAMC,gBAAkB1B,aAAamB,WAAWhiB,MAChDiiB,sBAAsBE,OAAOI,iBAC7B,MACF,IAAK,WACH,MAAMC,kBA/JOC,SA+J0BT,WAAWhiB,KA9JjC+gB,SAAS,CAChCC,eAAgB,CAAE3hB,EAAG4e,gBAEpBgD,IAAI,KAAM,MACVC,IAAI,KAAM,MAAOuB,UACjB9gB,MA0JKsgB,sBAAsBE,OAAOK,kBAC7B,MACF,IAAK,YACH,MAAME,uBA/Nc,EAACvjB,KAAO,cACX4hB,SAAS,CAChCC,eAAgB,CAAE3hB,EAAG4e,gBAEpBgD,IAAI,KAAM,UACVC,IAAI,KAAM,MAAO/hB,MACjBwC,KAyNoCghB,CAAsB,aACrDV,sBAAsBE,OAAOO,wBApKjB,IAACD,SAXH3B,YAoLlBmB,sBAAsBtgB,KAEfsgB,uBAIHW,oBAAuBC,QAE3B,OAAQA,MAAMhjB,SACZ,IAAK,SACL,IAAK,IAEH,OADqBuhB,YAEvB,IAAK,KACL,IAAK,IAEH,OADwBC,eAE1B,IAAK,MACL,IAAK,IAEH,OAD0BC,iBAE5B,IAAK,SACL,IAAK,MACL,IAAK,IAEH,OApJmBP,SAAS,CAC9BC,eAAgB,CAAE3hB,EAAG4e,gBAEpBgD,IAAI,KAAM,UACVC,IAAI,KAAM,OAAO,GACjBvf,KAgJD,IAAK,MAEH,OAD0Bwf,eAAe,aAE3C,IAAK,MAEH,OAD4BA,eAAe,eAE7C,IAAK,OAEH,MApLiB,EAAC2B,MAAQ,WACJ/B,SAAS,CACjCC,eAAgB,CAAE3hB,EAAG4e,gBAEpBgD,IAAI,KAAM,aACVC,IAAI,KAAM,MAAO4B,OACjBnhB,KA6K2BohB,KAQ1BC,gBAAkB,CAACC,WAAYR,YAGnC,GAAKlZ,MAAM0Z,YAWT,OAAO,IAVP,GAAIR,SAAU,CAGZ,ODxToB3C,UCsTMmD,WAAaR,SDrTpCle,KAAK6Q,MAAiB,GAAX0K,UC0Td,OAAqB,KAAbmD,WD3TW,IAACnD,UCoUpBoD,cAAiBC,iBACrB,GAAItE,WAAW3P,KAAKiU,gBAAiB,CACnC,MAAM/C,aAAe+C,eAAe3N,MAAMqJ,YAE1C,OAAOS,WAAWc,aAAa,IAC1B,GAAIzB,WAAWzP,KAAKiU,gBAAiB,CAC1C,MAAM/C,aAAe+C,eAAe3N,MAAMmJ,YAE1C,OAAOa,WAAWY,aAAa,MA2F7BgD,yBAA4BC,sBACJ,YAAxBA,sBACFA,oBAAsB,QASxB,OAPoCtC,SAAS,CAC3CC,eAAgB,CAAE3hB,EAAG4e,gBAEpBgD,IAAI,KAAM,MACVC,IAAI,KAAM,MAAOmC,qBACjB1hB,MA8CC2hB,yBAA4BtB,aAChC,MAAMuB,4BAA8BxC,SAAS,CAC3CC,eAAgB,CAAE3hB,EAAG4e,gBACpBgD,IAAI,KAAM,OACb,GAAIe,YAAcA,WAAWrc,cAAgBN,OAAQ,CACnDA,OAAOuF,KAAKoX,YAAYhW,QAAShM,MAE/B,OAAQA,KACN,IAAK,YACH,MAAMwjB,QAAEA,QAAOC,YAAEA,aAAgBzB,WAAWhiB,KACtC0jB,4BAvIiB,EAACF,QAASC,cACL1C,SAAS,CAC3CC,eAAgB,CAAE3hB,EAAG4e,gBAEpBgD,IAAI,KAAM,SACVA,IAAI,KAAM,QACVC,IAAI,KAAM,MAAO/gB,OAAOqjB,UACxB7hB,KACAsf,IAAI,KAAM,SACVC,IAAI,KAAM,MAAO/gB,OAAOsjB,cACxB9hB,KACAA,KA4HyCgiB,CAAyBH,QAASC,aACtEF,4BAA4BpB,OAAOuB,oCAG5B1B,WAAW4B,UAClB,MACF,IAAK,YACH,MAAMC,4BAA8BT,yBAAyBpB,WAAWhiB,MACxEujB,4BAA4BpB,OAAO0B,oCAG5B7B,WAAW8B,UAClB,MACF,IAAK,kBAGH,GAA2B,UAAvB9B,WAAW+B,QAAqB,CAClC,MAAMxB,gBAAkB1B,aAAamB,WAAWhiB,MAChDujB,4BAA4BpB,OAAOI,iBAEnC,MAAMyB,wBAvEW,MAC3B,MAAMA,wBAA0BjD,SAAS,CACvCC,eAAgB,CAAE3hB,EAAG4e,gBACpBgD,IAAI,KAAM,QACPgD,cAAgB,CACpBC,IAAK,CACH3S,KAAM,EACN4S,QAAS,EACTrB,MAAO,UAETsB,KAAM,CACJ7S,KAAM,EACN4S,QAAS,EACTrB,MAAO,UAETuB,OAAQ,CACN9S,KAAM,EACN4S,QAAS,EACTrB,MAAO,UAETwB,MAAO,CACL/S,KAAM,EACN4S,QAAS,EACTrB,MAAO,WAeX,OAXAzd,OAAOuF,KAAKqZ,eAAejY,QAASuY,aAClC,GAAIN,cAAcM,YAAa,CAC7B,MAAMhT,KAAEA,KAAI4S,QAAEA,QAAOrB,MAAEA,OAAUmB,cAAcM,YAEzCC,eAAiBjD,YAAYgD,WAAYhT,KAAM4S,QAASrB,OAC9DkB,wBAAwB7B,OAAOqC,mBAInCR,wBAAwBriB,KAEjBqiB,yBAiCmCS,GAChClB,4BAA4BpB,OAAO6B,gCAG5BhC,WAAW0C,gBAEpB,MACF,IAAK,iBACH,MAAMC,eAxGI,EAACC,MAAQ,WACJ7D,SAAS,CAC9BC,eAAgB,CAAE3hB,EAAG4e,gBAEpBgD,IAAI,KAAM,UACVC,IAAI,KAAM,MAAO0D,OACjBjjB,KAkG4BkjB,CAAY7C,WAAW8C,gBAC9CvB,4BAA4BpB,OAAOwC,uBAC5B3C,WAAW8C,eAClB,MACF,IAAK,cACH,MAAMC,oBAxHS,EAACX,KAAO,MACHrD,SAAS,CACnCC,eAAgB,CAAE3hB,EAAG4e,gBAEpBgD,IAAI,KAAM,OACVC,IAAI,KAAM,OAAQkD,MAClBziB,KAkHiCqjB,CAAiBhD,WAAWhiB,KAAKokB,MAC7Db,4BAA4BpB,OAAO4C,4BAG5B/C,WAAWiD,eAKxB,MAAMC,gBArJW,EAACC,YAAaC,cAAeC,gBAChD,MAAMH,gBAAkBnE,SAAS,CAC/BC,eAAgB,CAAE3hB,EAAG4e,gBACpBgD,IAAI,KAAM,WAcb,OAZIkE,aACFD,gBAAgBhE,IAAI,KAAM,OAAQiE,aAEhCC,eACFF,gBAAgBhE,IAAI,KAAM,SAAUkE,eAElCC,cACFH,gBAAgBhE,IAAI,KAAM,QAASmE,cAGrCH,gBAAgBhE,IAAI,KAAM,WAAY,SAASvf,KAExCujB,iBAoImBI,CACtBtD,WAAWiB,WACXjB,WAAWoD,cACXpD,WAAWqD,qBAINrD,WAAWiB,kBAEXjB,WAAWoD,qBAEXpD,WAAWqD,aAElB9B,4BAA4BpB,OAAO+C,iBAIrC,OAFA3B,4BAA4B5hB,KAErB4hB,6BAGHgC,uBAAyB,CAAC1C,MAAOb,cACrC,MAAMwD,aAAEA,aAAYC,cAAEA,cAAaC,eAAEA,gBAAmB1D,WAClD2D,YAAcF,cAAgBC,eAC9BE,mBDjkBkBnG,UCikBY+F,aDhkB7BjhB,KAAK6Q,MAAkB,IAAZqK,YADK,IAACA,UCkkBxB,IAMIoG,eACAC,cAPAC,mBAAqB/G,WAAWyG,eAChCO,oBAAsBhH,WAAW0G,gBAQrC,GAPIK,mBAAqBH,oBACvBG,mBAAqBH,kBACrBI,oBAAsBzhB,KAAK6Q,MAAM2Q,mBAAqBJ,cAKpD9C,MAAM/iB,YAAc+iB,MAAM/iB,WAAW8kB,MAAO,CAC9C,GAAI/B,MAAM/iB,WAAW8kB,MAAM3W,MACzB,GAAqC,SAAjC4U,MAAM/iB,WAAW8kB,MAAM3W,OACzB,GAAI0Q,WAAWzP,KAAK2T,MAAM/iB,WAAW8kB,MAAM3W,OACzC6X,cAAgB9G,WAAW6D,MAAM/iB,WAAW8kB,MAAM3W,MAAMuH,MAAMmJ,YAAY,SACrE,GAAIC,gBAAgB1P,KAAK2T,MAAM/iB,WAAW8kB,MAAM3W,OAAQ,CAC7D,MAAMgY,gBAAkBpD,MAAM/iB,WAAW8kB,MAAM3W,MAAMuH,MAAMoJ,iBAAiB,GAE5EkH,cAAgBvhB,KAAK6Q,MAAO6Q,gBAAkB,IAAOF,0BAInDlD,MAAM/iB,WAAW8kB,MAAM9W,QAA4C,SAAlC+U,MAAM/iB,WAAW8kB,MAAM9W,SAC1DgY,cAAgBC,mBAChBF,eAAiBG,qBAIvB,GAAInD,MAAM/iB,WAAW8kB,MAAM9W,OACzB,GAAsC,SAAlC+U,MAAM/iB,WAAW8kB,MAAM9W,QACzB,GAAI6Q,WAAWzP,KAAK2T,MAAM/iB,WAAW8kB,MAAM9W,QACzC+X,eAAiB7G,WAAW6D,MAAM/iB,WAAW8kB,MAAM9W,OAAO0H,MAAMmJ,YAAY,SACvE,GAAIC,gBAAgB1P,KAAK2T,MAAM/iB,WAAW8kB,MAAM9W,QAAS,CAC9D,MAAMmY,gBAAkBpD,MAAM/iB,WAAW8kB,MAAM3W,MAAMuH,MAAMoJ,iBAAiB,GAE5EiH,eAAiBthB,KAAK6Q,MAAO6Q,gBAAkB,IAAOD,qBACjDF,gBACHA,cAAgBvhB,KAAK6Q,MAAMyQ,eAAiBF,oBAK5CG,cACGD,iBACHA,eAAiBthB,KAAK6Q,MAAM0Q,cAAgBH,eAG9CE,eAAiBG,oBACjBF,cAAgBC,oBAIlBD,gBAAkBD,eACpBA,eAAiBthB,KAAK6Q,MAAM0Q,cAAgBH,aACnCE,iBAAmBC,gBAC5BA,cAAgBvhB,KAAK6Q,MAAMyQ,eAAiBF,mBAG9CG,cAAgBC,mBAChBF,eAAiBG,oBAInBhE,WAAW/T,MAAQ6X,cAEnB9D,WAAWlU,OAAS+X,gBAITK,WAAa,CAACC,qBAAsBtD,MAAO2C,aAAe,QACrE,IAAIY,SAAW,KACf,IAEEA,SAAWD,qBAAqBE,gBAAgBC,mBAAmBzD,MAAM/iB,WAAWymB,MACpF,MAAO5c,OACP,OAAO,KAET,GAAIyc,SAAU,CACZD,qBAAqBK,IAClBC,OAAO,QACPA,OAAO,SACPC,KAAKN,SAASO,sBAAuB5P,OAAOhT,KAAKqiB,SAASQ,YAAa,UAAW,CACjFC,eAAe,IAGnB,MAAMC,eAAiBX,qBAAqBY,4BAC1CZ,qBAAqBa,qBACrB,QACA,SAASZ,SAASO,sBAClB,YAEIM,YAAclQ,OAAOhT,KAAKqiB,SAASQ,YAAa,UAChDM,gBAAkBC,OAAOF,aAC/B,MAAO,CACL9nB,KAAM,UACNioB,kBAAkB,EAClBC,eAAgBP,kBACbV,SACHZ,aAAcA,cAAgBW,qBAAqBmB,uBACnD7B,cAAeyB,gBAAgBjZ,MAC/ByX,eAAgBwB,gBAAgBpZ,QAGpC,OAAO,MAGHyZ,MAAQ,CAACC,UAAWC,kBACxB,GAAI3iB,MAAM4iB,QAAQF,WAChB,IAAI,IAAIG,QAAQH,UACdD,MAAMI,KAAMF,qBAGdA,eAAetF,OAAOqF,YASpBI,sBAAwB,CAAC/E,MAAOb,cACpC,MAAM6F,mBAAqB,IAAK7F,YAmDhC,OAlDI/gB,QAAQ4hB,QAAUA,MAAM/iB,YAAc+iB,MAAM/iB,WAAW8kB,QAEvD/B,MAAM/iB,WAAW8kB,MAAM9B,QACtB,CAAC,cAAe,QAAQtO,SAASqO,MAAM/iB,WAAW8kB,MAAM9B,SAEzD+E,mBAAmB/E,MAAQ7C,eAAe4C,MAAM/iB,WAAW8kB,MAAM9B,QAGjED,MAAM/iB,WAAW8kB,MAAM,sBACtB,CAAC,cAAe,QAAQpQ,SAASqO,MAAM/iB,WAAW8kB,MAAM,uBAEzDiD,mBAAmBnD,gBAAkBzE,eACnC4C,MAAM/iB,WAAW8kB,MAAM,sBAIzB/B,MAAM/iB,WAAW8kB,MAAM,mBACvB,CAAC,MAAO,SAAU,UAAUpQ,SAASqO,MAAM/iB,WAAW8kB,MAAM,qBAE5DiD,mBAAmBC,cAAgBjF,MAAM/iB,WAAW8kB,MAAM,mBAG1D/B,MAAM/iB,WAAW8kB,MAAM,eACvB,CAAC,OAAQ,QAAS,SAAU,WAAWpQ,SAASqO,MAAM/iB,WAAW8kB,MAAM,iBAEvEiD,mBAAmB/D,UAAYjB,MAAM/iB,WAAW8kB,MAAM,eAGpD/B,MAAM/iB,WAAW8kB,MAAM,gBAA4D,SAA1C/B,MAAM/iB,WAAW8kB,MAAM,iBAClEiD,mBAAmBE,OAASlF,MAAM/iB,WAAW8kB,MAAM,gBAEjD/B,MAAM/iB,WAAW8kB,MAAM,eACzBiD,mBAAmBpF,SAAWS,cAAcL,MAAM/iB,WAAW8kB,MAAM,eAEjE/B,MAAM/iB,WAAW8kB,MAAM,iBACzBiD,mBAAmB5E,WAAaD,gBAC9BH,MAAM/iB,WAAW8kB,MAAM,eACvB/B,MAAM/iB,WAAW8kB,MAAM,aACnB1B,cAAcL,MAAM/iB,WAAW8kB,MAAM,cACrC,OAGJ/B,MAAM/iB,WAAW8kB,MAAMb,UACzB8D,mBAAmB9D,QAAUlB,MAAM/iB,WAAW8kB,MAAMb,UAGpD9iB,QAAQ4hB,QAA4B,eAAlBA,MAAMhjB,UAC1BgoB,mBAAmB5C,YAAc,CAAEb,KAAM,KACzCyD,mBAAmB/D,UAAY,WAE1B+D,oBAGHG,eAAiB,CAACnF,MAAOb,WAAYiG,YACzC,MAAMC,YAAcnH,SAAS,CAC3BC,eAAgB,CAAE3hB,EAAG4e,gBACpBgD,IAAI,KAAM,KACb,GAAGgH,SAAU,CACX,MAAMhG,sBAAwBF,mBAAmB6F,sBAAsB/E,MAAOb,aAC9EkG,YAAY/F,OAAOF,uBAErB,OAAOiG,aAKHC,yBAA2B,CAACD,YAAarF,MAAOb,WAAYoG,WAChE,GAAGvF,MAAM9iB,UAAY8iB,MAAM9iB,SAASQ,OAClC,IAAI,MAAM8nB,cAAcxF,MAAM9iB,SACzBuoB,QAAQD,YACTH,YAAY/F,OAAON,iBAAiBwG,WAAW9mB,OAE/C2mB,YAAY/F,OAAOoG,gBAAgBF,WAAYrG,WAAYoG,WAY7DG,gBAAkB,CAAC1F,MAAOb,WAAYoG,WAC1C,IAAIP,mBAAqBD,sBAAsB/E,MAAOb,YAClDkG,YAAcF,eAAenF,MAAOgF,oBAAoB,GAC5D,GAA6B,IAA1BhF,MAAM9iB,SAASQ,OAAc,CAC9B,IAAIioB,SAAW3F,MACf,MAAM4F,QAAU,GAChB,KAAMxnB,QAAQunB,WAA0C,IAA7BA,SAASzoB,SAASQ,QACxC6nB,QAAQ5T,SAASgU,SAAS3oB,UAAU4oB,QAAQ9jB,KAAKie,oBAAoB4F,WACxEA,SAAWA,SAASzoB,SAAS,GAC7B8nB,mBAAqBD,sBAAsBY,SAAUX,oBAEvD,MAAM5F,sBAAwBF,mBAAmB8F,oBAC9CS,QAAQE,WACTC,QAAQzc,QAAQ0c,QAAQzG,sBAAsBE,OAAOuG,SACrDR,YAAY/F,OAAOF,uBACnBiG,YAAY/F,OAAON,iBAAiB2G,SAASjnB,SAE1C6mB,QAAQ5T,SAASgU,SAAS3oB,UAAU4oB,QAAQ9jB,KAAKie,oBAAoB4F,WACxEC,QAAQzc,QAAQ0c,QAAQzG,sBAAsBE,OAAOuG,SACrDR,YAAY/F,OAAOF,uBACnBkG,yBAAyBD,YAAaM,SAAUX,mBAAoBO,cAEjE,CACL,GAAGA,QAAQ5T,SAASqO,MAAMhjB,SAAU,CAClC,MAAM6oB,OAAS9F,oBAAoBC,OAC7BZ,sBAAwBF,mBAAmB8F,oBACjD5F,sBAAsBE,OAAOuG,QAC7BR,YAAY/F,OAAOF,uBAErBkG,yBAAyBD,YAAarF,MAAOgF,mBAAoBO,SAGnE,OADAF,YAAYvmB,KACLumB,aAuBHS,YAAc,CAAC9F,MAAOb,WAAYmE,wBACtC,MAAMiC,QAAU,CAAC,SAAU,IAAK,KAAM,IAAK,IAAK,MAAO,SAAU,MAAO,IAAK,MAAO,MAAO,QAC3F,IAAIP,mBAAqBD,sBAAsB/E,MAAOb,YAClDkG,YAAc,KAElB,GAAGI,QAAQzF,OACTqF,YAAcF,eAAenF,MAAOgF,oBAAoB,GACxDK,YAAY/F,OAAON,iBAAiBgB,MAAMthB,WACrC,CAAA,IAAGN,QAAQ4hB,OAiChB,MAAO,GAhCP,GAAqB,MAAlBA,MAAMhjB,QACPqoB,YA9BoB,EAACrF,MAAOsD,wBAChC,MAAMkB,eAAiBlB,qBAAqBY,4BAC1CZ,qBAAqBa,qBACrB,YACAnE,MAAM/iB,YAAc+iB,MAAM/iB,WAAW8oB,KAAO/F,MAAM/iB,WAAW8oB,KAAO,IAGtE,OAAO7H,SAAS,CACdC,eAAgB,CAAE3hB,EAAG4e,aAAc4K,EAAG5K,gBAErCgD,IAAI,KAAM,aACVC,IAAI,KAAM,KAAM,MAAMmG,iBAmBPyB,CAAkBjG,MAAOsD,sBACvC0B,mBAAmBkB,WAAY,MAC1B,CAAA,GAAsB,OAAlBlG,MAAMhjB,QACf,MAtoBiB,EAACV,KAAO,iBACH4hB,SAAS,CACjCC,eAAgB,CAAE3hB,EAAG4e,gBAEpBgD,IAAI,KAAM,MACVC,IAAI,KAAM,OAAQ/hB,MAClBwC,KAgoBQqnB,GACF,GAAGZ,QAAQ5T,SAASqO,MAAMhjB,SAE/B,OAAO0oB,gBAAgB1F,MAAOgF,mBAAoBO,SAE/C,GAAsB,QAAlBvF,MAAMhjB,QAAmB,CAChC,MAAM4D,OAASyiB,WAAWC,qBAAsBtD,OAChD,GAAGpf,OAAQ,CACTokB,mBAAqB,IAAIA,sBAAuBpkB,QAChD8hB,uBAAuB1C,MAAOgF,oBAC9B,MAAM1oB,KAAEA,KAAIioB,iBAAEA,oBAAqB6B,iBAAoBpB,mBACvDK,YAAcF,eAAenF,MAAOgF,oBAAoB,GACxDK,YAAY/F,OAAO+G,aAAa9B,iBAAkBjoB,KAAM8pB,oBAI5D,IAAGf,YAII,CACL,MAAMiB,aAAe,GACrB,IAAI,MAAMd,cAAcxF,MAAM9iB,SAC5BopB,aAAaxkB,KAAKgkB,YAAYN,WAAYR,mBAAoB1B,uBAEhE,OAAOgD,aARP,IAAI,MAAMd,cAAcxF,MAAM9iB,SAC5BwnB,MAAMoB,YAAYN,WAAYR,mBAAoB1B,sBAAuB+B,aAc/E,OADAA,YAAYvmB,KACLumB,aAGHkB,eAAiB,CAACvG,MAAOb,WAAYmE,wBACzC,MAAMkD,kBAAoBtI,SAAS,CACjCC,eAAgB,CAAE3hB,EAAG4e,gBACpBgD,IAAI,KAAM,KACP4G,mBAAqBD,sBAAsB/E,MAAOb,YAClDuB,4BAA8BD,yBAAyBuE,oBAI7D,OAHAwB,kBAAkBlH,OAAOoB,6BACzBgE,MAAMoB,YAAY9F,MAAOb,WAAYmE,sBAAuBkD,mBAC5DA,kBAAkB1nB,KACX0nB,mBAiDHC,yBAA4BtH,aAChC,MAAMuH,4BAA8BxI,SAAS,CAC3CC,eAAgB,CAAE3hB,EAAG4e,gBACpBgD,IAAI,KAAM,QA6Cb,OA5CIe,YAAcA,WAAWrc,cAAgBN,QAC3CA,OAAOuF,KAAKoX,YAAYhW,QAAShM,MAE/B,OAAQA,KACN,IAAK,kBACH,MAAMuiB,gBAAkB1B,aAAamB,WAAWhiB,MAChDupB,4BAA4BpH,OAAOI,wBAG5BP,WAAW0C,gBAClB,MACF,IAAK,gBACH,MAAM8E,0BA/2Be,CAACC,oBACU,WAApCA,kBAAkBlV,gBACpBkV,kBAAoB,UAUtB,OAPkC1I,SAAS,CACzCC,eAAgB,CAAE3hB,EAAG4e,gBAEpBgD,IAAI,KAAM,UACVC,IAAI,KAAM,MAAOuI,mBACjB9nB,MAq2BuC+nB,CAAuB1H,WAAWhiB,MACpEupB,4BAA4BpH,OAAOqH,kCAG5BxH,WAAW8F,cAClB,MACF,IAAK,UACH,MAAM6B,kBAhEeC,UAgE0B5H,WAAWhiB,KA/DzC+gB,SAAS,CAChCC,eAAgB,CAAE3hB,EAAG4e,gBAEpBgD,IAAI,KAAM,YACVC,IAAI,KAAM,MAAO0I,WACjBjoB,MA2DK4nB,4BAA4BpH,OAAOwH,yBAG5B3H,WAAW6H,QAClB,MACF,IAAK,kBACH,MAAMC,wBAhDc,CAACC,kBAC7B,MAAMC,yBAA2BjJ,SAAS,CACxCC,eAAgB,CAAE3hB,EAAG4e,gBACpBgD,IAAI,KAAM,cAEP6B,MAAEA,MAAKmH,OAAEA,UAAWC,SAAYH,gBAUtC,OATA1kB,OAAOuF,KAAKsf,SAASle,QAASme,SAC5B,GAAIJ,gBAAgBI,QAAS,CAC3B,MAAM3F,eAAiBjD,YAAY4I,OAAQJ,gBAAgBI,QAAS,EAAGrH,MAAOmH,QAC9ED,yBAAyB7H,OAAOqC,mBAIpCwF,yBAAyBroB,KAElBqoB,0BAiCiCI,CAAsBpI,WAAWhiB,MACjEupB,4BAA4BpH,OAAO2H,gCAI5B9H,WAAW+H,gBAClB,MACF,IAAK,UACH,MAAMM,sBAt3BW,EAACC,cAAgB,aACZvJ,SAAS,CACrCC,eAAgB,CAAE3hB,EAAG4e,gBAEpBgD,IAAI,KAAM,UACVC,IAAI,KAAM,MAAOoJ,eACjB3oB,KAg3BmC4oB,CAAmBvI,WAAWhiB,MAC5DupB,4BAA4BpH,OAAOkI,8BAE5BrI,WAAWwI,QAlFE,IAACZ,YAuF7BL,4BAA4B5nB,KAErB4nB,6BAGHkB,qBAAuB,CAAC5H,MAAOb,cACnC,GAAI3c,OAAOhE,UAAU7B,eAAeuF,KAAK8d,MAAM/iB,WAAW8kB,MAAO,UAC/D,GAAsC,SAAlC/B,MAAM/iB,WAAW8kB,MAAMuF,QAAuD,IAAlCtH,MAAM/iB,WAAW8kB,MAAMuF,OACrEnI,WAAW+H,gBAAkB,OACxB,CAEL,MAAOtI,WAAYG,aAAcD,aAAe+I,gBAC9C7H,MAAM/iB,WAAW8kB,MAAMuF,QAGzBnI,WAAW+H,gBAAkB,CAC3B7F,IAAKzC,WACL2C,KAAM3C,WACN4C,OAAQ5C,WACR6C,MAAO7C,WACPqB,MAAOnB,YACPsI,OAAQrI,cAId,GAAIiB,MAAM/iB,WAAW8kB,MAAM,eAA0D,MAAzC/B,MAAM/iB,WAAW8kB,MAAM,cACjE5C,WAAW+H,gBAAkB,IACxB/H,WAAW+H,gBACd7F,IAAK,QAEF,GAAIrB,MAAM/iB,WAAW8kB,MAAM,eAA0D,MAAzC/B,MAAM/iB,WAAW8kB,MAAM,cAAuB,CAE/F,MAAOnD,WAAYG,aAAcD,aAAe+I,gBAC9C7H,MAAM/iB,WAAW8kB,MAAM,eAEzB5C,WAAW+H,gBAAkB,IACxB/H,WAAW+H,gBACd7F,IAAKzC,WACLqB,MAAOnB,YACPsI,OAAQrI,cAGZ,GAAIiB,MAAM/iB,WAAW8kB,MAAM,gBAA4D,MAA1C/B,MAAM/iB,WAAW8kB,MAAM,eAClE5C,WAAW+H,gBAAkB,IACxB/H,WAAW+H,gBACd3F,KAAM,QAEH,GACLvB,MAAM/iB,WAAW8kB,MAAM,gBACmB,MAA1C/B,MAAM/iB,WAAW8kB,MAAM,eACvB,CAEA,MAAOnD,WAAYG,aAAcD,aAAe+I,gBAC9C7H,MAAM/iB,WAAW8kB,MAAM,gBAEzB5C,WAAW+H,gBAAkB,IACxB/H,WAAW+H,gBACd3F,KAAM3C,WACNqB,MAAOnB,YACPsI,OAAQrI,cAGZ,GAAIiB,MAAM/iB,WAAW8kB,MAAM,kBAAgE,MAA5C/B,MAAM/iB,WAAW8kB,MAAM,iBACpE5C,WAAW+H,gBAAkB,IACxB/H,WAAW+H,gBACd1F,OAAQ,QAEL,GACLxB,MAAM/iB,WAAW8kB,MAAM,kBACqB,MAA5C/B,MAAM/iB,WAAW8kB,MAAM,iBACvB,CAEA,MAAOnD,WAAYG,aAAcD,aAAe+I,gBAC9C7H,MAAM/iB,WAAW8kB,MAAM,kBAEzB5C,WAAW+H,gBAAkB,IACxB/H,WAAW+H,gBACd1F,OAAQ5C,WACRqB,MAAOnB,YACPsI,OAAQrI,cAGZ,GAAIiB,MAAM/iB,WAAW8kB,MAAM,iBAA8D,MAA3C/B,MAAM/iB,WAAW8kB,MAAM,gBACnE5C,WAAW+H,gBAAkB,IACxB/H,WAAW+H,gBACdzF,MAAO,QAEJ,GACLzB,MAAM/iB,WAAW8kB,MAAM,iBACoB,MAA3C/B,MAAM/iB,WAAW8kB,MAAM,gBACvB,CAEA,MAAOnD,WAAYG,aAAcD,aAAe+I,gBAC9C7H,MAAM/iB,WAAW8kB,MAAM,iBAEzB5C,WAAW+H,gBAAkB,IACxB/H,WAAW+H,gBACdzF,MAAO7C,WACPqB,MAAOnB,YACPsI,OAAQrI,gBAKR+I,eAAiB,CAAC9H,MAAOb,WAAY4I,WAAYC,YAAa1E,wBAClE,MAAM2E,kBAAoB/J,SAAS,CACjCC,eAAgB,CAAE3hB,EAAG4e,gBACpBgD,IAAI,KAAM,MAEP4G,mBAAqB,IAAK7F,YAChC,GAAI/gB,QAAQ4hB,QAAUA,MAAM/iB,WAAY,CACtC,GAAI+iB,MAAM/iB,WAAW0qB,QACnBI,WAAWG,IAAIF,YAAY7lB,MAAO,CAAEwlB,QAAS3H,MAAM/iB,WAAW0qB,QAAU,EAAGX,QAAS,IACpFhC,mBAAmB2C,QAAU,cACxB,CACL,MAAMQ,mBAAqBJ,WAAW9d,IAAI+d,YAAY7lB,OACtD4lB,WAAWG,IACTF,YAAY7lB,MAEZK,OAAO4lB,OAAO,GAAID,mBAAoB,CACpCR,QAAS,EACTX,QAAUmB,oBAAsBA,mBAAmBnB,SAAY,KAIrE,GACEhH,MAAM/iB,WAAW+pB,SAChBhH,MAAM/iB,WAAW8kB,OAAS/B,MAAM/iB,WAAW8kB,MAAM,eAClD,CACAiD,mBAAmBgC,QACjBhH,MAAM/iB,WAAW+pB,SAChBhH,MAAM/iB,WAAW8kB,OAAS/B,MAAM/iB,WAAW8kB,MAAM,eACpD,MAAMoG,mBAAqBJ,WAAW9d,IAAI+d,YAAY7lB,OACtD4lB,WAAWG,IACTF,YAAY7lB,MAEZK,OAAO4lB,OAAO,GAAID,mBAAoB,CACpCnB,QAASzV,SAASyT,mBAAmBgC,UAAY,KAGrDgB,YAAY7lB,OAASoP,SAASyT,mBAAmBgC,SAAW,EAE1DhH,MAAM/iB,WAAW8kB,QAEjB/B,MAAM/iB,WAAW8kB,MAAM9B,QACtB,CAAC,cAAe,QAAQtO,SAASqO,MAAM/iB,WAAW8kB,MAAM9B,SAEzD+E,mBAAmB/E,MAAQ7C,eAAe4C,MAAM/iB,WAAW8kB,MAAM9B,QAGjED,MAAM/iB,WAAW8kB,MAAM,sBACtB,CAAC,cAAe,QAAQpQ,SAASqO,MAAM/iB,WAAW8kB,MAAM,uBAEzDiD,mBAAmBnD,gBAAkBzE,eACnC4C,MAAM/iB,WAAW8kB,MAAM,sBAIzB/B,MAAM/iB,WAAW8kB,MAAM,mBACvB,CAAC,MAAO,SAAU,UAAUpQ,SAASqO,MAAM/iB,WAAW8kB,MAAM,qBAE5DiD,mBAAmBC,cAAgBjF,MAAM/iB,WAAW8kB,MAAM,mBAE5D6F,qBAAqB5H,MAAOgF,qBAGhC,MAAM0B,4BAA8BD,yBAAyBzB,oBAE7D,GADAiD,kBAAkB3I,OAAOoH,6BACrB1G,MAAM9iB,UAAY+E,MAAM4iB,QAAQ7E,MAAM9iB,WAAa8iB,MAAM9iB,SAASQ,OACpE,IAAK,IAAIyE,MAAQ,EAAGA,MAAQ6d,MAAM9iB,SAASQ,OAAQyE,QAAS,CAC1D,MAAMqjB,WAAaxF,MAAM9iB,SAASiF,OAClC,GAAI/D,QAAQonB,aAAsC,QAAvBA,WAAWxoB,QAAmB,CACvD,MAAM4D,OAASyiB,WAAWC,qBAAsBkC,WAAYR,mBAAmBrC,cAC/E,GAAG/hB,OAAQ,CACTokB,mBAAqB,IAAIA,sBAAuBpkB,QAChD8hB,uBAAuB8C,WAAYR,oBACnC,MAAM1oB,KAAEA,KAAIioB,iBAAEA,oBAAqB6B,iBAAoBpB,mBACvDiD,kBAAkB3I,OAAO+G,aAAa9B,iBAAkBjoB,KAAM8pB,wBAE3D,GAAIhoB,QAAQonB,aAAsC,WAAvBA,WAAWxoB,SAC3C,GACEwoB,WAAWtoB,UACX+E,MAAM4iB,QAAQW,WAAWtoB,WACzBsoB,WAAWtoB,SAASQ,OAGpB,IAAK,IAAI2qB,cAAgB,EAAGA,cAAgB7C,WAAWtoB,SAASQ,OAAQ2qB,gBAAiB,CACvF,MAAMC,gBAAkB9C,WAAWtoB,SAASmrB,eAC5C,GAAgC,QAA5BC,gBAAgBtrB,QAAmB,CACrC,MAAM4D,OAASyiB,WAAWC,qBAAsBgF,gBAAiBtD,mBAAmBrC,cACpF,GAAG/hB,OAAQ,CACTokB,mBAAqB,IAAIA,sBAAuBpkB,QAChD8hB,uBAAuB4F,gBAAiBtD,oBACxC,MAAM1oB,KAAEA,KAAIioB,iBAAEA,oBAAqB6B,iBAAoBpB,mBACvDiD,kBAAkB3I,OAAO+G,aAAa9B,iBAAkBjoB,KAAM8pB,yBAMjE,CACL,MAAMI,kBAAoBD,eACxBf,WACAR,mBACA1B,sBAEF2E,kBAAkB3I,OAAOkH,wBAGxB,CAEL,MAAMA,kBAAoBtI,SAAS,CACjCC,eAAgB,CAAE3hB,EAAG4e,gBAEpBgD,IAAI,KAAM,KACVtf,KACHmpB,kBAAkB3I,OAAOkH,mBAI3B,OAFAyB,kBAAkBnpB,KAEXmpB,mBAGHM,iBAAmB,CAACR,WAAYC,YAAa7I,cACjD,MAAMqJ,qBAAuB,GAC7B,IAAIC,WAAaV,WAAW9d,IAAI+d,YAAY7lB,OAC5C,KAAOsmB,YAAcA,WAAWd,SAAS,CACvC,MAAMe,oBAAsBxK,SAAS,CACnCC,eAAgB,CAAE3hB,EAAG4e,gBACpBgD,IAAI,KAAM,MAEPsI,4BAA8BD,yBAAyB,IACxDtH,WACHwI,QAAS,WACTX,QAASyB,WAAWzB,QAAUyB,WAAWzB,QAAU,IAErD0B,oBAAoBpJ,OAAOoH,6BAE3B,MAAMF,kBAAoBtI,SAAS,CACjCC,eAAgB,CAAE3hB,EAAG4e,gBAEpBgD,IAAI,KAAM,KACVtf,KACH4pB,oBAAoBpJ,OAAOkH,mBAC3BkC,oBAAoB5pB,KAEpB0pB,qBAAqB1mB,KAAK4mB,qBAEtBD,WAAWd,QAAU,GAAM,EAC7BI,WAAWY,OAAOX,YAAY7lB,OAE9B4lB,WAAWG,IAAIF,YAAY7lB,MAAO,CAChCwlB,QAASc,WAAWd,QAAU,EAC9BX,QAASyB,WAAWzB,SAAW,IAGnCgB,YAAY7lB,OAASsmB,WAAWzB,SAAW,EAC3CyB,WAAaV,WAAW9d,IAAI+d,YAAY7lB,OAG1C,OAAOqmB,sBAGHI,wBAA2BzJ,aAC/B,MAAM0J,2BAA6B3K,SAAS,CAC1CC,eAAgB,CAAE3hB,EAAG4e,gBACpBgD,IAAI,KAAM,QA6Bb,OA5BIe,YAAcA,WAAWrc,cAAgBN,QAC3CA,OAAOuF,KAAKoX,YAAYhW,QAAShM,MAE/B,OAAQA,KACN,IAAK,iBACH,MAAM2rB,wBAzqCaC,eAyqCgC5J,WAAWhiB,KAxqCvC+gB,SAAS,CACtCC,eAAgB,CAAE3hB,EAAG4e,gBAEpBgD,IAAI,KAAM,YACVC,IAAI,KAAM,MAAO0K,gBACjB1K,IAAI,KAAM,QAAS,WACnBvf,MAmqCK+pB,2BAA2BvJ,OAAOwJ,+BAG3B3J,WAAW4J,eAClB,MACF,IAAK,eACH,GAAI5J,WAAW6J,aAAc,CAC3B,MAAMC,kBAAoB/K,SAAS,CACjCC,eAAgB,CAAE3hB,EAAG4e,gBAEpBgD,IAAI,KAAM,aACVtf,KACH+pB,2BAA2BvJ,OAAO2J,0BAG3B9J,WAAW6J,cAzrCF,IAACD,iBA+rC3BF,2BAA2B/pB,KACpB+pB,4BAGHK,cAAgB,CAAClJ,MAAOb,WAAY4I,WAAYzE,wBACpD,MAAM6F,iBAAmBjL,SAAS,CAChCC,eAAgB,CAAE3hB,EAAG4e,gBACpBgD,IAAI,KAAM,MACP4G,mBAAqB,IAAK7F,YAC5B/gB,QAAQ4hB,QAAUA,MAAM/iB,cAGvB+iB,MAAM/iB,WAAW8kB,OAAS/B,MAAM/iB,WAAW8kB,MAAM9W,QACjD+U,MAAM9iB,SAAS,IACdkB,QAAQ4hB,MAAM9iB,SAAS,KACvB8iB,MAAM9iB,SAAS,GAAGD,WAAW8kB,OAC7B/B,MAAM9iB,SAAS,GAAGD,WAAW8kB,MAAM9W,UAErC+Z,mBAAmB+D,eA96BF,CAACK,kBACtB,GAAIpN,WAAW3P,KAAK+c,iBAAkB,CACpC,MAAM7L,aAAe6L,gBAAgBzW,MAAMqJ,YAE3C,OAAOO,YAAYgB,aAAa,IAC3B,GAAIzB,WAAWzP,KAAK+c,iBAAkB,CAC3C,MAAM7L,aAAe6L,gBAAgBzW,MAAMmJ,YAE3C,OAAOY,YAAYa,aAAa,MAs6BM8L,CACjCrJ,MAAM/iB,WAAW8kB,OAAS/B,MAAM/iB,WAAW8kB,MAAM9W,SAC/C+U,MAAM9iB,SAAS,IAChBkB,QAAQ4hB,MAAM9iB,SAAS,KACvB8iB,MAAM9iB,SAAS,GAAGD,WAAW8kB,OAC7B/B,MAAM9iB,SAAS,GAAGD,WAAW8kB,MAAM9W,OAC/B+U,MAAM9iB,SAAS,GAAGD,WAAW8kB,MAAM9W,YACnC1N,KAGNyiB,MAAM/iB,WAAW8kB,OACnB6F,qBAAqB5H,MAAOgF,qBAGhC,MAAM6D,2BAA6BD,wBAAwB5D,oBAC3DmE,iBAAiB7J,OAAOuJ,4BAExB,MAAMb,YAAc,CAAE7lB,MAAO,GAE7B,GAAI6d,MAAM9iB,UAAY+E,MAAM4iB,QAAQ7E,MAAM9iB,WAAa8iB,MAAM9iB,SAASQ,OAAQ,CAC5E,MAAM4rB,aAAetJ,MAAM9iB,SAAS4C,OAAQ0lB,YAC1C,CAAC,KAAM,MAAM7T,SAAS6T,WAAWxoB,UAE7BusB,YAAcjG,qBAAqBmB,uBAAyB6E,aAAa5rB,OAE/E,IAAK,IAAIyE,MAAQ,EAAGA,MAAQ6d,MAAM9iB,SAASQ,OAAQyE,QAAS,CAC1D,MAAMqjB,WAAaxF,MAAM9iB,SAASiF,OAClC,GAAI,CAAC,KAAM,MAAMwP,SAAS6T,WAAWxoB,SAAU,CAC7C,MAAMwrB,qBAAuBD,iBAAiBR,WAAYC,YAAahD,oBACvE,GAAI/iB,MAAM4iB,QAAQ2D,sBAChB,IACE,IAAIH,cAAgB,EACpBA,cAAgBG,qBAAqB9qB,OACrC2qB,gBACA,CACA,MAAMK,oBAAsBF,qBAAqBH,eAEjDc,iBAAiB7J,OAAOoJ,qBAG5B,MAAMT,kBAAoBH,eACxBtC,WACA,IAAKR,mBAAoBrC,aAAc4G,aACvCxB,WACAC,YACA1E,sBAEF0E,YAAY7lB,QAEZgnB,iBAAiB7J,OAAO2I,qBAI9B,GAAID,YAAY7lB,MAAQ4lB,WAAWrZ,KAAM,CACvC,MAAM8Z,qBAAuBD,iBAAiBR,WAAYC,YAAahD,oBACvE,GAAI/iB,MAAM4iB,QAAQ2D,sBAChB,IAAK,IAAIH,cAAgB,EAAGA,cAAgBG,qBAAqB9qB,OAAQ2qB,gBAAiB,CACxF,MAAMK,oBAAsBF,qBAAqBH,eAEjDc,iBAAiB7J,OAAOoJ,sBAM9B,OAFAS,iBAAiBrqB,KAEVqqB,kBAGHK,kBAAqBC,WACIvL,SAAS,CACpCC,eAAgB,CAAE3hB,EAAG4e,gBAEpBgD,IAAI,KAAM,WACVC,IAAI,KAAM,IAAK/gB,OAAOmsB,YAKrBC,eAAiB,CAAC1J,MAAOb,cAC7B,MAAMwK,kBAAoBzL,SAAS,CACjCC,eAAgB,CAAE3hB,EAAG4e,gBACpBgD,IAAI,KAAM,WACb,GAAI4B,MAAM9iB,UAAY+E,MAAM4iB,QAAQ7E,MAAM9iB,WAAa8iB,MAAM9iB,SAASQ,OAAQ,CAC5E,MAAMksB,YAAc5J,MAAM9iB,SAAS4C,OAAQ0lB,YAAsC,QAAvBA,WAAWxoB,SAC/DysB,UAAYtK,WAAWwD,aAAeiH,YAAYlsB,OAExD,IAAK,IAAIyE,MAAQ,EAAGA,MAAQynB,YAAYlsB,OAAQyE,QAAS,CACvD,MAAM0nB,qBAAuBL,kBAAkBC,WAC/CE,kBAAkBrK,OAAOuK,uBAK7B,OAFAF,kBAAkB7qB,KAEX6qB,mBAGHG,2BAA6B,CAAC9J,MAAOb,cACzC,MAAMwK,kBAAoBzL,SAAS,CACjCC,eAAgB,CAAE3hB,EAAG4e,gBACpBgD,IAAI,KAAM,WACb,GAAI4B,MAAM9iB,UAAY+E,MAAM4iB,QAAQ7E,MAAM9iB,WAAa8iB,MAAM9iB,SAASQ,OAAQ,CAC5E,MAAMqsB,oBAAsB/J,MAAM9iB,SAAS8sB,OAAO,CAACC,YAAazE,cAC9D,MAAMwB,QACJxB,WAAWvoB,WAAW+pB,SACrBxB,WAAWvoB,WAAW8kB,OAASyD,WAAWvoB,WAAW8kB,MAAM,eAE9D,OAAOkI,aAAejD,QAAUzV,SAASyV,SAAW,IACnD,GACGyC,UAAYtK,WAAWwD,aAAeoH,oBAE5C,IAAK,IAAI5nB,MAAQ,EAAGA,MAAQ4nB,oBAAqB5nB,QAAS,CACxD,MAAM0nB,qBAAuBL,kBAAkBC,WAC/CE,kBAAkBrK,OAAOuK,uBAK7B,OAFAF,kBAAkB7qB,KAEX6qB,mBAkCHO,gBAAkB,CAACC,KAAMC,SACNlM,SAAS,CAC9BC,eAAgB,CAAE3hB,EAAG4e,gBAEpBgD,IAAI,KAAM+L,MACV9L,IAAI,KAAM,OAAQ,OAClBA,IAAI,KAAM,IAAK/gB,OAAO8sB,SACtBtrB,KAsBCurB,qBAAwBlL,aAC5B,MAAMmL,wBAA0BpM,SAAS,CACvCC,eAAgB,CAAE3hB,EAAG4e,gBACpBgD,IAAI,KAAM,SAETe,YAAcA,WAAWrc,cAAgBN,QAC3CA,OAAOuF,KAAKoX,YAAYhW,QAAShM,MAE/B,OAAQA,KACN,IAAK,cACH,MAAMotB,qBAtEU,CAACC,cACzB,MAAMD,qBAAuBrM,SAAS,CACpCC,eAAgB,CAAE3hB,EAAG4e,gBACpBgD,IAAI,KAAM,eAEP6B,MAAEA,MAAKmH,OAAEA,UAAWC,SAAYmD,YAWtC,OATAhoB,OAAOuF,KAAKsf,SAASle,QAASme,SAC5B,GAAID,QAAQC,QAAS,CACnB,MAAM3F,eAAiBjD,YAAY4I,OAAQD,QAAQC,QAAS,EAAGrH,MAAOmH,QACtEmD,qBAAqBjL,OAAOqC,mBAIhC4I,qBAAqBzrB,KAEdyrB,sBAsD8BE,CAAkBtL,WAAWhiB,MAC1DmtB,wBAAwBhL,OAAOiL,6BAGxBpL,WAAWqL,YAClB,MACF,IAAK,mBACH,MAAME,yBAzkBc,EAACC,YAAc,IACVzM,SAAS,CACxCC,eAAgB,CAAE3hB,EAAG4e,gBAEpBgD,IAAI,KAAM,kBACVC,IAAI,KAAM,IAAKsM,aACftM,IAAI,KAAM,OAAQ,OAClBvf,KAkkBsC8rB,CAAsBzL,WAAWhiB,MAClEmtB,wBAAwBhL,OAAOoL,iCAGxBvL,WAAW0L,iBAClB,MACF,IAAK,QACH,GAAI1L,WAAWhiB,KAAM,CACnB,MAAM2tB,oBAlEOC,WAkE8B5L,WAAWhiB,KAjErC+gB,SAAS,CAClCC,eAAgB,CAAE3hB,EAAG4e,gBAEpBgD,IAAI,KAAM,QACVC,IAAI,KAAM,OAAQ,OAClBA,IAAI,KAAM,IAAK/gB,OAAOytB,aACtBjsB,MA4DOwrB,wBAAwBhL,OAAOwL,2BAI1B3L,WAAW/T,MAvEJ,IAAC2f,aA4EvB,MAAMC,wBApDsB,CAACZ,SAC7B,MAAMa,qBAAuB/M,SAAS,CACpCC,eAAgB,CAAE3hB,EAAG4e,gBACpBgD,IAAI,KAAM,cAWb,MATA,CAAC,MAAO,UAAUjV,QAASghB,OACzB,MAAMe,eAAiBhB,gBAAgBC,KAAMC,OAAS,GACtDa,qBAAqB3L,OAAO4L,kBAE9B,CAAC,OAAQ,SAAS/hB,QAASghB,OACzB,MAAMe,eAAiBhB,gBAAgBC,KAAMC,QAC7Ca,qBAAqB3L,OAAO4L,kBAGvBD,sBAsCyBE,CAAsB,KACtDb,wBAAwBhL,OAAO0L,yBAG/B,MAAMI,kBAAoB7K,yBAAyB,UAKnD,OAJA+J,wBAAwBhL,OAAO8L,mBAE/Bd,wBAAwBxrB,KAEjBwrB,yBAGHzC,gBAAmBwD,eACvB,IAAK3c,KAAM0Y,OAAQnH,OAASoL,aAAatrB,MAAM,KAE/C,GAAIic,WAAW3P,KAAKqC,MAAO,CACzB,MAAM6O,aAAe7O,KAAKiE,MAAMqJ,YAEhCtN,KAAOwO,WAAWK,aAAa,SAC1B,GAAIzB,WAAWzP,KAAKqC,MAAO,CAChC,MAAM6O,aAAe7O,KAAKiE,MAAMmJ,YDl7CTM,WCo7CLmB,aAAa,GAA/B7O,KDn7CKwO,WAAWF,aAAaZ,aADP,IAACA,WC07CzB,OAJAgL,OAASA,QAAU,CAAC,SAAU,SAAU,UAAUzV,SAASyV,QAAUA,OAAS,SAE9EnH,MAAQA,OAAS7C,eAAe6C,OAAOqL,cAEhC,CAAC5c,KAAM0Y,OAAQnH,QAGlBsL,WAAa,CAACvL,MAAOb,WAAYmE,wBACrC,MAAMkI,cAAgBtN,SAAS,CAC7BC,eAAgB,CAAE3hB,EAAG4e,gBACpBgD,IAAI,KAAM,OACP4G,mBAAqB,IAAK7F,YAChC,GAAI/gB,QAAQ4hB,QAAUA,MAAM/iB,WAAY,CACtC,MAAMwuB,gBAAkBzL,MAAM/iB,WAAWkiB,YAAc,GACjDuM,YAAc1L,MAAM/iB,WAAW8kB,OAAS,GACxC4J,aAAe,GACfC,iBAAmB,GACzB,IAyCIC,aACAlJ,aACAvX,OA3CCwT,WAAYkN,aAAchN,aAAe,CAAC,EAAG,SAAU,UAQ5D,GALKpY,MAAM+kB,gBAAgBnE,UACzB1I,WAAarN,SAASka,gBAAgBnE,OAAQ,KAI5CoE,YAAYpE,OAAQ,CACtB,MAAOyE,QAASC,UAAWC,UAAYpE,gBAAgB6D,YAAYpE,QACnE1I,WAAamN,SAAWnN,WACxBE,YAAcmN,UAAYnN,YAC1BgN,aAAeE,WAAaF,aAiC9B,GA9BAH,aAAatK,IAAMzC,WACnB+M,aAAanK,OAAS5C,WACtB+M,aAAapK,KAAO3C,WACpB+M,aAAalK,MAAQ7C,WACrB+M,aAAavE,OAAS0E,aACtBH,aAAa1L,MAAQnB,YAEkB,aAAnC4M,YAAY,oBACdC,aAAaO,QAAUtN,WACvB+M,aAAaQ,QAAUvN,aAEvB+M,aAAaO,QAAU,EACvBP,aAAaQ,QAAU,EACvBP,iBAAiBvK,IAAM,EACvBuK,iBAAiBpK,OAAS,EAC1BoK,iBAAiBrK,KAAO,EACxBqK,iBAAiBnK,MAAQ,GAG3BuD,mBAAmBwF,YAAcmB,aACjC3G,mBAAmB6F,iBAAmB,EAElCroB,OAAOuF,KAAK6jB,kBAAkBluB,SAChCsnB,mBAAmBkC,gBAAkB0E,kBAOnC9P,WAAWzP,KAAKqf,YAAY,cAC9BG,aAAenP,YAAYgP,YAAY,aAAa/Y,MAAMmJ,YAAY,SACjE,GAAIC,gBAAgB1P,KAAKqf,YAAY,cAAe,CACzD,MAAMtI,gBAAkBsI,YAAY,aAAa/Y,MAAMoJ,iBAAiB,GACxE8P,aAAenqB,KAAK6Q,MAAO6Q,gBAAkB,IAAOjE,WAAWwD,cAIjE,GAAI7G,WAAWzP,KAAKqf,YAAY,cAC9B5P,WAAWsQ,UAAY,EACvBzJ,aAAejG,YAAYgP,YAAY,aAAa/Y,MAAMmJ,YAAY,SACjE,GAAIC,gBAAgB1P,KAAKqf,YAAY,cAAe,CACzD3P,gBAAgBqQ,UAAY,EAC5B,MAAMhJ,gBAAkBsI,YAAY,aAAa/Y,MAAMoJ,iBAAiB,GACxE4G,aAAejhB,KAAK6Q,MAAO6Q,gBAAkB,IAAOjE,WAAWwD,cAIjE,GAAI7G,WAAWzP,KAAKqf,YAAYtgB,OAC9B0Q,WAAWsQ,UAAY,EACvBhhB,MAAQsR,YAAYgP,YAAYtgB,MAAMuH,MAAMmJ,YAAY,SACnD,GAAIC,gBAAgB1P,KAAKqf,YAAYtgB,OAAQ,CAClD2Q,gBAAgBqQ,UAAY,EAC5B,MAAMhJ,gBAAkBsI,YAAYtgB,MAAMuH,MAAMoJ,iBAAiB,GACjE3Q,MAAQ1J,KAAK6Q,MAAO6Q,gBAAkB,IAAOjE,WAAWwD,cAItDvX,OACF4Z,mBAAmB5Z,MAAQA,MACvBuX,eACFqC,mBAAmB5Z,MAAQ1J,KAAKC,IAAIqjB,mBAAmB5Z,MAAOuX,eAE5DkJ,eACF7G,mBAAmB5Z,MAAQ1J,KAAK2qB,IAAIrH,mBAAmB5Z,MAAOygB,gBAEvDA,eACT7G,mBAAmB5Z,MAAQygB,cAEzB7G,mBAAmB5Z,QACrB4Z,mBAAmB5Z,MAAQ1J,KAAKC,IAAIqjB,mBAAmB5Z,MAAO+T,WAAWwD,eAG7E,MAAM2H,wBAA0BD,qBAAqBrF,oBACrDwG,cAAclM,OAAOgL,yBAErB,MAAMvC,WAAa,IAAIuE,IAEvB,GAAItM,MAAM9iB,UAAY+E,MAAM4iB,QAAQ7E,MAAM9iB,WAAa8iB,MAAM9iB,SAASQ,OACpE,IAAK,IAAIyE,MAAQ,EAAGA,MAAQ6d,MAAM9iB,SAASQ,OAAQyE,QAAS,CAC1D,MAAMqjB,WAAaxF,MAAM9iB,SAASiF,OAClC,GAA2B,aAAvBqjB,WAAWxoB,QAAwB,CACrC,MAAM2sB,kBAAoBD,eAAelE,WAAYR,oBACrDwG,cAAclM,OAAOqK,wBAChB,GAA2B,UAAvBnE,WAAWxoB,QACpB,IAAK,IAAIqrB,cAAgB,EAAGA,cAAgB7C,WAAWtoB,SAASQ,OAAQ2qB,gBAAiB,CACvF,MAAMC,gBAAkB9C,WAAWtoB,SAASmrB,eAC5C,GAAgC,OAA5BC,gBAAgBtrB,QAAkB,CACpC,GAAsB,IAAlBqrB,cAAqB,CACvB,MAAMsB,kBAAoBG,2BACxBxB,gBACAtD,oBAEFwG,cAAclM,OAAOqK,mBAEvB,MAAMR,iBAAmBD,cACvBZ,gBACAtD,mBACA+C,WACAzE,sBAEFkI,cAAclM,OAAO6J,wBAGpB,GAA2B,UAAvB3D,WAAWxoB,QACpB,IAAK,IAAIqrB,cAAgB,EAAGA,cAAgB7C,WAAWtoB,SAASQ,OAAQ2qB,gBAAiB,CACvF,MAAMC,gBAAkB9C,WAAWtoB,SAASmrB,eAC5C,GAAgC,OAA5BC,gBAAgBtrB,QAAkB,CACpC,GAAsB,IAAlBqrB,cAAqB,CACvB,MAAMsB,kBAAoBG,2BACxBxB,gBACAtD,oBAEFwG,cAAclM,OAAOqK,mBAEvB,MAAMR,iBAAmBD,cACvBZ,gBACAtD,mBACA+C,WACAzE,sBAEFkI,cAAclM,OAAO6J,wBAGpB,GAA2B,OAAvB3D,WAAWxoB,QAAkB,CACtC,GAAc,IAAVmF,MAAa,CACf,MAAMwnB,kBAAoBG,2BAA2BtE,WAAYR,oBACjEwG,cAAclM,OAAOqK,mBAEvB,MAAMR,iBAAmBD,cACvB1D,WACAR,mBACA+C,WACAzE,sBAEFkI,cAAclM,OAAO6J,mBAM3B,OAFAqC,cAAc1sB,KAEP0sB,eAsCHe,2BAA8BpN,aAClC,MAAMqN,8BAAgCtO,SAAS,CAC7CC,eAAgB,CAAEsO,EAAGrR,gBACpBgD,IAAI,KAAM,QAEPsO,eAhBiBxO,SAAS,CAC9BC,eAAgB,CAAEsO,EAAGrR,gBAEpBgD,IAAI,KAAM,OACVC,IAAI,IAAK,KACTA,IAAI,IAAK,KACTvf,KAWH0tB,8BAA8BlN,OAAOoN,gBACrC,MAAMC,gBA/Ba,GAAGvhB,MAAAA,MAAOH,OAAAA,UACLiT,SAAS,CAC/BC,eAAgB,CAAEsO,EAAGrR,gBAEpBgD,IAAI,KAAM,OACVC,IAAI,KAAMjT,OACViT,IAAI,KAAMpT,QACVnM,KAwBqB8tB,CAAazN,YAKrC,OAJAqN,8BAA8BlN,OAAOqN,iBAErCH,8BAA8B1tB,KAEvB0tB,+BAGHK,qBAAwB1N,aAC5B,MAAM2N,gBAAkB5O,SAAS,CAC/BC,eAAgB,CAAE4O,IAAK3R,kBACtBgD,IAAI,OAAQ,QAEToO,8BAAgCD,2BAA2BpN,YACjE2N,gBAAgBxN,OAAOkN,+BACvB,MAAMQ,uBAxDyB9O,SAAS,CACtCC,eAAgB,CAAEsO,EAAGrR,gBAEpBgD,IAAI,KAAM,YACVC,IAAI,OAAQ,QACZvf,KAwDH,OAJAguB,gBAAgBxN,OAAO0N,wBAEvBF,gBAAgBhuB,KAETguB,iBAaHG,aAAe,KACnB,MAAMC,gBAAkBhP,SAAS,CAC/BC,eAAgB,CAAEsO,EAAGrR,gBACpBgD,IAAI,KAAM,WAEP+O,iBAdmBjP,SAAS,CAChCC,eAAgB,CAAEsO,EAAGrR,gBAEpBgD,IAAI,KAAM,YACVtf,KAeH,OAJAouB,gBAAgB5N,OAAO6N,kBAEvBD,gBAAgBpuB,KAETouB,iBA+BHE,mCAAsC5I,iBAC1C,MAAM6I,sCAAwCnP,SAAS,CACrDC,eAAgB,CAAE4O,IAAK3R,kBACtBgD,IAAI,OAAQ,YACTkP,kCAlB+B,CAAC9I,iBACtC,MAAM8I,kCAAoCpP,SAAS,CACjDC,eAAgB,CAAEsO,EAAGrR,aAAc4K,EAAG5K,gBAErCgD,IAAI,KAAM,QACVC,IAAI,KAAM,QAAS,MAAMmG,gBAEzBnG,IAAI,SAAU,SAIjB,OAFAiP,kCAAkCxuB,KAE3BwuB,mCAOmCC,CAA+B/I,gBACzE6I,sCAAsC/N,OAAOgO,mCAC7C,MAAME,gBAjCkBtP,SAAS,CAC/BC,eAAgB,CAAEsO,EAAGrR,gBAEpBgD,IAAI,KAAM,WACVC,IAAI,IAAK,KACTA,IAAI,IAAK,KACTA,IAAI,IAAK,KACTA,IAAI,IAAK,KACTvf,KA0BHuuB,sCAAsC/N,OAAOkO,iBAC7C,MAAMN,gBAAkBD,eAKxB,OAJAI,sCAAsC/N,OAAO4N,iBAE7CG,sCAAsCvuB,KAE/BuuB,uCA+BHI,gCAAkC,CACtCC,UACAC,yBACAC,sBAEA,MAAMC,mCAAqC3P,SAAS,CAClDC,eAAgB,CAAE4O,IAAK3R,kBACtBgD,IAAI,OAAQ,WAET0P,mCA3BgC,EACtCJ,UACAC,yBACAC,mBAAqB,MAErB,MAAME,mCAAqC5P,SAAS,CAClDC,eAAgB,CAAE4O,IAAK3R,kBAEtBgD,IAAI,OAAQ,SACZC,IAAI,KAAMqP,WACVrP,IAAI,OAAQsP,0BACZtP,IAAI,QAASuP,oBAIhB,OAFAE,mCAAmChvB,KAE5BgvB,oCAYoCC,CACzCL,UACAC,yBACAC,oBAEFC,mCAAmCvO,OAAOwO,oCAC1C,MAAME,0CA3CuC,MAC7C,MAAMA,0CAA4C9P,SAAS,CACzDC,eAAgB,CAAE4O,IAAK3R,kBACtBgD,IAAI,OAAQ,YAIf,OAFA4P,0CAA0ClvB,KAEnCkvB,2CAoC2CC,GAIlD,OAHAJ,mCAAmCvO,OAAO0O,2CAC1CH,mCAAmC/uB,KAE5B+uB,oCA6BHK,iBAAmB,CAACC,YAAahP,cACrC,MAAMiP,oBAAsBlQ,SAAS,CACnCC,eAAgB,CAAEsO,EAAGrR,gBAEpBgD,IAAI,KAAM,eACVC,IAAI,MAAO,4DACd,GAAoB,YAAhB8P,YAA2B,CAC7B,MAAME,gBAjCW,GACnBC,GAAAA,GACAxK,sBAAAA,sBACAyK,YAAAA,YACA/J,eAAAA,eACApZ,MAAAA,MACAH,OAAAA,WAEA,MAAMojB,gBAAkBnQ,SAAS,CAC/BC,eAAgB,CAAE4O,IAAK3R,kBACtBgD,IAAI,OAAQ,OACTyP,mCAAqCJ,gCACzCa,GACAxK,sBACAyK,aAEFF,gBAAgB/O,OAAOuO,oCACvB,MAAMW,8BAAgCpB,mCAAmC5I,gBACzE6J,gBAAgB/O,OAAOkP,+BACvB,MAAM1B,gBAAkBD,qBAAqB,CAAEzhB,MAAAA,MAAOH,OAAAA,SAItD,OAHAojB,gBAAgB/O,OAAOwN,iBACvBuB,gBAAgBvvB,KAETuvB,iBAUmBI,CAAatP,YACrCiP,oBAAoB9O,OAAO+O,iBAI7B,OAFAD,oBAAoBtvB,KAEbsvB,qBAGHM,aAAe,CAACP,YAAahP,cACjC,MAAMwP,gBAAkBzQ,SAAS,CAC/BC,eAAgB,CAAEsO,EAAGrR,gBACpBgD,IAAI,KAAM,WAEPgQ,oBAAsBF,iBAAiBC,YAAahP,YAI1D,OAHAwP,gBAAgBrP,OAAO8O,qBACvBO,gBAAgB7vB,KAET6vB,iBAGHC,sCAAwC,CAAClB,UAAWmB,cACP3Q,SAAS,CACxDC,eAAgB,CAAE2Q,GAAI1T,iBAErBgD,IAAI,MAAO,SACXC,IAAI,KAAMqP,WACVrP,IAAI,OAAQwQ,aACZ/vB,KA+BCiwB,0BAA4B,IACH7Q,SAAS,CACpCC,eAAgB,CAAE2Q,GAAI1T,iBAErBgD,IAAI,MAAO,gBACXC,IAAI,IAAK,KACTA,IAAI,IAAK,KACTA,IAAI,IAAK,KACTA,IAAI,IAAK,KACTvf,KAKCkwB,YAAc,EAAG5jB,MAAAA,MAAOH,OAAAA,UACLiT,SAAS,CAC9BC,eAAgB,CAAE2Q,GAAI1T,iBAErBgD,IAAI,MAAO,UACXC,IAAI,KAAMjT,OACViT,IAAI,KAAMpT,QACVnM,KA6CCmwB,qBAAuB,CAACd,YAAahP,cACzC,MAAM+P,wBAA0BhR,SAAS,CACvCC,eAAgB,CAAE2Q,GAAI1T,iBAErBgD,IAAI,MAAO,UACXC,IAAI,QAAS,KACbA,IAAI,QAAS,KACbA,IAAI,QAAS,KACbA,IAAI,QAAS,KACbA,IAAI,iBAAkB,KACtBA,IAAI,YAAa,SACjBA,IAAI,SAAU,QACdA,IAAI,eAAgB,QACpBA,IAAI,eAAgB,SACpBA,IAAI,YAAa,SAEd8Q,kBA3BoBjR,SAAS,CACjCC,eAAgB,CAAE2Q,GAAI1T,iBAErBgD,IAAI,MAAO,aACXC,IAAI,IAAK,KACTA,IAAI,IAAK,KACTvf,KAsBHowB,wBAAwB5P,OAAO6P,mBAC/B,MAAMC,kBA3CoBlR,SAAS,CACjCC,eAAgB,CAAE2Q,GAAI1T,iBAErBgD,IAAI,MAAO,aACXC,IAAI,eAAgB,UACpBD,IAAI,MAAO,aACXa,IAAI,SACJngB,KACAA,KAoCHowB,wBAAwB5P,OAAO8P,mBAC/B,MAAMC,kBA3DoBnR,SAAS,CACjCC,eAAgB,CAAE2Q,GAAI1T,iBAErBgD,IAAI,MAAO,aACXC,IAAI,eAAgB,aACpBD,IAAI,MAAO,aACXa,IAAI,SACJngB,KACAA,KAoDHowB,wBAAwB5P,OAAO+P,mBAC/B,MAAMC,eAAiBN,YAAY,CAAE5jB,MAAO+T,WAAW/T,MAAOH,OAAQkU,WAAWlU,SACjFikB,wBAAwB5P,OAAOgQ,gBAC/B,MAAMC,qBAAuBR,4BAC7BG,wBAAwB5P,OAAOiQ,sBAC/B,MAAMC,mBArHqBtR,SAAS,CAClCC,eAAgB,CAAE2Q,GAAI1T,iBAErBgD,IAAI,MAAO,cACXC,IAAI,WAAY,aAChBA,IAAI,QAAS,UACbA,IAAI,QAAS,UACbA,IAAI,QAAS,UACbA,IAAI,QAAS,UACbvf,KA6GHowB,wBAAwB5P,OAAOkQ,oBAC/B,MAAMC,yCAA2Cb,sCAC/CzP,WAAWmP,GACXnP,WAAW2E,uBAEboL,wBAAwB5P,OAAOmQ,0CAC/B,MAAMd,gBAAkBD,aAAaP,YAAahP,YAKlD,OAJA+P,wBAAwB5P,OAAOqP,iBAE/BO,wBAAwBpwB,KAEjBowB,yBA8BH7I,aAAe,CAAC9B,kBAAmB,EAAO4J,YAAahP,cAC3D,MAAMuQ,gBAAkBxR,SAAS,CAC/BC,eAAgB,CAAE3hB,EAAG4e,gBACpBgD,IAAI,KAAM,WACPuR,gCAAkCpL,iBA/Bf,EAAC4J,YAAahP,cACvC,MAAMyQ,sBAAwB1R,SAAS,CACrCC,eAAgB,CAAE2Q,GAAI1T,iBAErBgD,IAAI,MAAO,UACXC,IAAI,QAAS,KACbA,IAAI,QAAS,KACbA,IAAI,QAAS,KACbA,IAAI,QAAS,KAEViR,eAAiBN,YAAY,CAAE5jB,MAAO+T,WAAW/T,MAAOH,OAAQkU,WAAWlU,SACjF2kB,sBAAsBtQ,OAAOgQ,gBAC7B,MAAMC,qBAAuBR,4BAC7Ba,sBAAsBtQ,OAAOiQ,sBAC7B,MAAME,yCAA2Cb,sCAC/CzP,WAAWmP,GACXnP,WAAW2E,uBAEb8L,sBAAsBtQ,OAAOmQ,0CAC7B,MAAMd,gBAAkBD,aAAaP,YAAahP,YAKlD,OAJAyQ,sBAAsBtQ,OAAOqP,iBAE7BiB,sBAAsB9wB,KAEf8wB,uBAQHC,CAAmB1B,YAAahP,YAChC8P,qBAAqBd,YAAahP,YAItC,OAHAuQ,gBAAgBpQ,OAAOqQ,iCACvBD,gBAAgB5wB,KAET4wB,iBCtlEHI,YAAcC,WAAW,OAC7BC,YACAC,QAIW5M,aAAa,CAACC,qBAAsBtD,MAAO2C,aAAe,QACrE,IAAIY,SAAW,KACf,IAEEA,SAAWD,qBAAqBE,gBAAgBC,mBAAmBzD,MAAM/iB,WAAWymB,MACpF,MAAO5c,QAGT,GAAIyc,SAAU,CACZD,qBAAqBK,IAClBC,OAAO,QACPA,OAAO,SACPC,KAAKN,SAASO,sBAAuB5P,OAAOhT,KAAKqiB,SAASQ,YAAa,UAAW,CACjFC,eAAe,IAGnB,MAAMC,eAAiBX,qBAAqBY,4BAC1CZ,qBAAqBa,qBACrB,QACA,SAASZ,SAASO,sBAClB,YAGIM,YAAclQ,OAAOhT,KAAKqiB,SAASQ,YAAa,UAChDM,gBAAkBC,OAAOF,aAgB/B,OAdsB8L,eACpBlQ,MACA,CACE1jB,KAAM,UACNioB,kBAAkB,EAClBC,eAAgBP,kBACbV,SACHZ,aAAcA,cAAgBW,qBAAqBmB,uBACnD7B,cAAeyB,gBAAgBjZ,MAC/ByX,eAAgBwB,gBAAgBpZ,QAElCqY,wBAoFN,SAAS6M,kBAAkB7M,qBAAsBtD,MAAOoQ,aACtD,GACoB,QAAlBpQ,MAAMhjB,UACiC,eAAtCgjB,MAAM/iB,WAAWkiB,WAAWkR,OAC1BrQ,MAAM/iB,WAAW8kB,OAAS/B,MAAM/iB,WAAW8kB,MAAM,qBAHtD,CAKE,MAAMyE,kBAAoBtI,SAAS,CACjCC,eAAgB,CAAE3hB,EAAG4e,gBAEpBgD,IAAI,KAAM,KACVA,IAAI,KAAM,KACVA,IAAI,KAAM,MACVC,IAAI,KAAM,OAAQ,QAClBvf,KACAA,KACAA,KAEHsxB,YAAY9Q,OAAOkH,uBAhBrB,CAoBA,OAAQxG,MAAMhjB,SACZ,IAAK,KACL,IAAK,KACL,IAAK,KACL,IAAK,KACL,IAAK,KACL,IAAK,KACH,MAAMszB,gBAAkBJ,eACtBlQ,MACA,CACEiC,eAAgB,UAAUjC,MAAMhjB,QAAQ,IAE1CsmB,sBAGF,YADA8M,YAAY9Q,OAAOgR,iBAErB,IAAK,OACL,IAAK,SACL,IAAK,IACL,IAAK,KACL,IAAK,IACL,IAAK,IACL,IAAK,MACL,IAAK,SACL,IAAK,MACL,IAAK,IACL,IAAK,MACL,IAAK,MACL,IAAK,OACL,IAAK,IACL,IAAK,IACL,IAAK,aACL,IAAK,MACH,MAAM9J,kBAAoB0J,eAA0BlQ,MAAO,GAAIsD,sBAE/D,YADA8M,YAAY9Q,OAAOkH,mBAErB,IAAK,SACH,GAAIxG,MAAM9iB,UAAY+E,MAAM4iB,QAAQ7E,MAAM9iB,WAAa8iB,MAAM9iB,SAASQ,OAEpE,IAAK,IAAIyE,MAAQ,EAAGA,MAAQ6d,MAAM9iB,SAASQ,OAAQyE,QAAS,CAC1D,MAAMqjB,WAAaxF,MAAM9iB,SAASiF,OAClC,GAA2B,UAAvBqjB,WAAWxoB,QAAqB,CAClC,MAAMwuB,cAAgB+E,WACpB/K,WACA,CACE7C,aAAcW,qBAAqBmB,uBACnCuE,aAAc1F,qBAAqBkN,mBAErClN,sBAEF8M,YAAY9Q,OAAOkM,eAEnB,MAAMiF,uBAAyBP,eAA0B,KAAM,IAC/DE,YAAY9Q,OAAOmR,6BACd,GAA2B,QAAvBjL,WAAWxoB,QAAmB,CACvC,MAAM0zB,cAAgBrN,aAAWC,qBAAsBkC,YACnDkL,eACFN,YAAY9Q,OAAOoR,gBAK3B,OACF,IAAK,QACH,MAAMlF,cAAgB+E,WACpBvQ,MACA,CACE2C,aAAcW,qBAAqBmB,uBACnCuE,aAAc1F,qBAAqBkN,mBAErClN,sBAEF8M,YAAY9Q,OAAOkM,eAEnB,MAAMiF,uBAAyBP,eAA0B,KAAM,IAE/D,YADAE,YAAY9Q,OAAOmR,wBAErB,IAAK,KACL,IAAK,KACH,MAAME,aAjLa,CAAC3Q,QACxB,MAAM2Q,aAAe,GAErB,IAAIC,aAAe,CAAC,CAAEC,KAAM7Q,MAAO8Q,MAAO,EAAGx0B,KAAM0jB,MAAMhjB,UACzD,KAAO4zB,aAAalzB,QAAQ,CAC1B,MAAMqzB,gBAAkBH,aAAazmB,QAYrC,IAVEsb,QAAQsL,gBAAgBF,OACvBzyB,QAAQ2yB,gBAAgBF,QAAU,CAAC,KAAM,KAAM,MAAMlf,SAASof,gBAAgBF,KAAK7zB,WAEpF2zB,aAAa7uB,KAAK,CAChB+uB,KAAME,gBAAgBF,KACtBC,MAAOC,gBAAgBD,MACvBx0B,KAAMy0B,gBAAgBz0B,OAKxBy0B,gBAAgBF,KAAK3zB,UACrB6zB,gBAAgBF,KAAK3zB,SAASQ,QAC9B,CAAC,KAAM,KAAM,MAAMiU,SAASof,gBAAgBF,KAAK7zB,SACjD,CAiDA4zB,aAhDyBG,gBAAgBF,KAAK3zB,SAAS8sB,OAAO,CAACC,YAAazE,cAC1E,GAAI,CAAC,KAAM,MAAM7T,SAAS6T,WAAWxoB,SACnCitB,YAAYnoB,KAAK,CACf+uB,KAAMrL,WACNsL,MAAOC,gBAAgBD,MAAQ,EAC/Bx0B,KAAMkpB,WAAWxoB,eAInB,GACEitB,YAAYvsB,OAAS,GACrBU,QAAQ6rB,YAAYA,YAAYvsB,OAAS,GAAGmzB,OACuB,MAAnE5G,YAAYA,YAAYvsB,OAAS,GAAGmzB,KAAK7zB,QAAQ0U,cAEjDuY,YAAYA,YAAYvsB,OAAS,GAAGmzB,KAAK3zB,SAAS4E,KAAK0jB,gBAClD,CACL,MAAMwL,eAAiB,IAAIhB,MACzB,IACA,KAEAvK,QAAQD,YACJ,CAACA,YAEHpnB,QAAQonB,YAC+B,OAArCA,WAAWxoB,QAAQ0U,cACjB,IAAI8T,WAAWtoB,UACf,CAACsoB,YACH,IAENyE,YAAYnoB,KAAK,CAEf+uB,KAAMzyB,QAAQonB,YAE2B,OAArCA,WAAWxoB,QAAQ0U,cACjB8T,WACqC,MAArCA,WAAWxoB,QAAQ0U,cACnBsf,eACAxL,WAEFwL,eACJF,MAAOC,gBAAgBD,MACvBx0B,KAAMy0B,gBAAgBz0B,OAK5B,OAAO2tB,aACN,IAC6BloB,OAAO6uB,eAI3C,OAAOD,cAuGkBM,CAAUjR,OACzBY,YAAc0C,qBAAqB4N,gBAAgBP,cAEzD,IAAK,IAAIxuB,MAAQ,EAAGA,MAAQwuB,aAAajzB,OAAQyE,QAAS,CACxD,MAAMgvB,YAAcR,aAAaxuB,OAE3BqkB,kBAAoB0J,eACxBiB,YAAYN,KACZ,CACE9P,UAAW,CAAEJ,QAASwQ,YAAYL,MAAOlQ,YAAAA,cAE3C0C,sBAEF8M,YAAY9Q,OAAOkH,mBAErB,OACF,IAAK,KACH,MAAM4K,kBAAoBlB,eAA0B,KAAM,IAE1D,YADAE,YAAY9Q,OAAO8R,mBAKvB,GAAIpR,MAAM9iB,UAAY+E,MAAM4iB,QAAQ7E,MAAM9iB,WAAa8iB,MAAM9iB,SAASQ,OAEpE,IAAK,IAAIyE,MAAQ,EAAGA,MAAQ6d,MAAM9iB,SAASQ,OAAQyE,QAAS,CAG1DkvB,kBAAkB/N,qBAFCtD,MAAM9iB,SAASiF,OAEkBiuB,eAMnD,SAASiB,kBAAkB/N,qBAAsBgO,MAAOlB,aAC7D,IAAKkB,MAEH,MAAO,GAET,GAAIrvB,MAAM4iB,QAAQyM,QAAUA,MAAM5zB,OAEhC,IAAK,IAAIyE,MAAQ,EAAGA,MAAQmvB,MAAM5zB,OAAQyE,QAAS,CAEjDkvB,kBAAkB/N,qBADJgO,MAAMnvB,OAC2BiuB,kBAExChyB,QAAQkzB,OACjBnB,kBAAkB7M,qBAAsBgO,MAAOlB,aACtC3K,QAAQ6L,QACjBC,iBAA4BnB,YAAaoB,OAAOl0B,OAAOg0B,MAAM5yB,QAE/D,OAAO0xB,YClST,MCAMqB,gBAAkB,4LAIYrW,qFACAA,+EACAA,2FACAA,mFCP9BsW,QAAU,oMAIwBtW,0GACAA,0FCLlCuW,aAAe,iGAIJvW,iCACAA,qmCCLXwW,YAAc,6FAGOxW,0BAA0BA,0BAA0BA,0BAA0BA,4BAA4BA,6BAA6BA,+LCH5JyW,eAAiB,gGAGOzW,0BAA0BA,yCCAxD,IAAI0W,KAAO,EAgBX,IChBIC,SACAC,aAEAC,wBDaa,CACbC,UAVJ,WAEI,OADAJ,MAAe,KAAPA,KAAc,OAAS,gBAU/BA,KANJ,SAAiBK,QACbL,KAAOK,SCdPC,SAAW,mEAMf,SAASC,QACLJ,UAAW,EAGf,SAASK,cAAcC,YACnB,GAAKA,YAQL,GAAIA,aAAeR,SAAnB,CAIA,GAAIQ,WAAW70B,SAAW00B,SAAS10B,OAC/B,MAAM,IAAI6H,MAAM,uCAAyC6sB,SAAS10B,OAAS,qCAAuC60B,WAAW70B,OAAS,gBAAkB60B,YAG5J,IAAIC,OAASD,WAAWxyB,MAAM,IAAID,QAAO,SAASglB,KAAM2N,IAAKpxB,KAC1D,OAAOoxB,MAAQpxB,IAAIqxB,YAAY5N,SAGlC,GAAI0N,OAAO90B,OACP,MAAM,IAAI6H,MAAM,uCAAyC6sB,SAAS10B,OAAS,yDAA2D80B,OAAOvyB,KAAK,OAGtJ8xB,SAAWQ,WACXF,cAxBQN,WAAaK,WACbL,SAAWK,SACXC,SAwDZ,SAASM,cACL,OAAIV,WAGJA,SAtBJ,WACSF,UACDO,cAAcF,UAQlB,IALA,IAGIQ,eAHAC,YAAcd,SAAShyB,MAAM,IAC7B+yB,YAAc,GACd9M,EAAI+M,eAAeb,YAGhBW,YAAYn1B,OAAS,GACxBsoB,EAAI+M,eAAeb,YACnBU,eAAiBlxB,KAAKsR,MAAMgT,EAAI6M,YAAYn1B,QAC5Co1B,YAAYhxB,KAAK+wB,YAAY7zB,OAAO4zB,eAAgB,GAAG,IAE3D,OAAOE,YAAY7yB,KAAK,IAOb+yB,IAkBf,eAAiB,CACb/oB,IALJ,WACE,OAAO8nB,UAAYK,UAKjBa,WAvDJ,SAAoBV,YAEhB,OADAD,cAAcC,YACPR,UAsDPD,KAnDJ,SAAiBA,MACbiB,eAAejB,KAAKA,MAChBE,eAAiBF,OACjBO,QACAL,aAAeF,OAgDnB1X,OAbJ,SAAgBjY,OAEZ,OADuBwwB,cACCxwB,QAYxB8vB,SAAUU,aCnGVO,OAA2B,iBAAXC,SAAwBA,OAAOD,QAAUC,OAAOC,4BAI/DF,QAAWA,OAAOG,gBASN,SAAS3kB,MAClB,OAAOwkB,OAAOG,gBAAgB,IAAIC,WAAW5kB,QATpC,SAASA,MAElB,IADA,IAAI6kB,MAAQ,GACHr1B,EAAI,EAAGA,EAAIwQ,KAAMxQ,IACtBq1B,MAAMzxB,KAAKJ,KAAKsR,MAAsB,IAAhBtR,KAAK8xB,WAE/B,OAAOD,sBCTE,SAAUC,OAAQzB,SAAUrjB,MAwB3C,IAlBA,IAAI+kB,MAAQ,GAAK/xB,KAAKkE,IAAImsB,SAASr0B,OAAS,GAAKgE,KAAKgyB,KAAO,EAezD1Z,QAAU,IAAMyZ,KAAO/kB,KAAOqjB,SAASr0B,QACvC4wB,GAAK,KAMP,IAHA,IAAIiF,MAAQC,OAAOxZ,MAEf9b,EAAI8b,KACD9b,KAKL,IAFAowB,IAAMyD,SAASwB,MAAMr1B,GAAKu1B,OAAS,IAE5B/1B,UAAYgR,KAAM,OAAO4f,IChBtC,ICLIqF,QAGAC,2BDZJ,SAAkBC,QAMd,IALA,IACI/pB,KADAgqB,YAAc,EAGdxxB,IAAM,IAEFwH,MACJxH,KAAYujB,eAAO2N,kBAAQzB,WAAS9nB,MAAO,GAC3CH,KAAO+pB,OAAUnyB,KAAKqyB,IAAI,GAAID,YAAc,GAC5CA,cAEJ,OAAOxxB,KC4BX,YArBA,SAAe0xB,iBACX,IAAI1xB,IAAM,GAEN2xB,QAAUvyB,KAAKsR,MAAmC,MAA5BkhB,KAAKC,MAnBjB,gBAkCd,OAbIF,UAAYL,gBACZD,WAEAA,QAAU,EACVC,gBAAkBK,SAGtB3xB,KAAY8xB,WAxBF,GAyBV9xB,KAAY8xB,WAASJ,iBACjBL,QAAU,IACVrxB,KAAY8xB,WAAST,UAEzBrxB,KAAY8xB,WAASH,UC3BzB,YAXA,SAAmB3F,IACf,SAAKA,IAAoB,iBAAPA,IAAmBA,GAAG5wB,OAAS,KAI7B,IAAI22B,OAAO,KAC7BtC,WAAS9nB,MAAMqqB,QAAQ,uBAAwB,QACjD,KACsBjoB,KAAKiiB,gDCD/B,IAAI0F,gBAAyD,EAyC7D,SAASI,WACP,OAAOG,QAAMP,iBAIftxB,eAAiB0xB,SACjB1xB,wBAA0B0xB,SAC1B1xB,oBAxCA,SAAc8xB,WAEV,OADAzC,WAASD,KAAK0C,WACP9xB,OAAOkI,SAuClBlI,sBA9BA,SAAgB+xB,UAEZ,OADAT,gBAAkBS,SACX/xB,OAAOkI,SA6BlBlI,0BArBA,SAAoBgyB,eAKhB,YAJsBn3B,IAAlBm3B,eACA3C,WAASkB,WAAWyB,eAGjB3C,WAASE,YAiBpBvvB,uBAAyBiyB,gFC5DRtsB,KCCjB,MCgBMusB,iBAAmB,CACvBvT,IAAK,KACLI,MAAO,KACPD,OAAQ,KACRD,KAAM,KACNsT,OAAQ,IACRC,OAAQ,IACRC,OAAQ,GAGJC,gBAAkB,CACtB3T,IAAK,KACLI,MAAO,KACPD,OAAQ,KACRD,KAAM,KACNsT,OAAQ,IACRC,OAAQ,IACRC,OAAQ,GAGV,MAAME,aACJrpB,aAAY+X,IACVA,IAAGuR,WACHA,WAAU5kB,YACVA,YAAW6kB,QACXA,QAAOC,MACPA,MAAKC,QACLA,QAAOC,QACPA,QAAOC,SACPA,SAAQhH,YACRA,YAAWiH,eACXA,eAAcC,SACdA,SAAQC,UACRA,UAASC,WACTA,WAAUC,WACVA,WAAUf,OACVA,OAAMgB,WACNA,WAAUf,OACVA,OAAMgB,KACNA,KAAIlW,SACJA,SAAQmW,sBACRA,sBAAqBC,MACrBA,MAAKC,WACLA,WAAUC,sBACVA,sBAAqBC,WACrBA,WAAUC,kBACVA,oBAEA/4B,KAAKsmB,IAAMA,IACXtmB,KAAK63B,WAAaA,WAClB73B,KAAKiT,YAAcA,YACnBjT,KAAK+N,MAAwB,cAAhBkF,YAA8B,MAAQ,MACnDjT,KAAK4N,OAAyB,cAAhBqF,YAA8B,MAAQ,MACpDjT,KAAK83B,QAEHA,SAAW3yB,OAAOuF,KAAKotB,SAASz3B,OAC5By3B,QACgB,cAAhB7kB,YACAskB,iBACAI,gBACN33B,KAAKonB,uBAAyBpnB,KAAK+N,MAAQ/N,KAAK83B,QAAQ5T,KAAOlkB,KAAK83B,QAAQ1T,MAC5EpkB,KAAK+3B,MAAQA,OAAS,GACtB/3B,KAAKg4B,QAAUA,SAAW,GAC1Bh4B,KAAKi4B,QAAUA,SAAW,eAC1Bj4B,KAAKk4B,SAAWA,UAAY,CAAC,gBAC7Bl4B,KAAKkxB,YAAcA,aAAe,GAClClxB,KAAKm4B,eAAiBA,gBAAkB,eACxCn4B,KAAKo4B,SAAWA,UAAY,EAC5Bp4B,KAAKq4B,UAAYA,WAAa,IAAIxB,KAClC72B,KAAKs4B,WAAaA,YAAc,IAAIzB,KACpC72B,KAAKu4B,WAAaA,YAAc,UAChCv4B,KAAKw3B,OAASA,SAAU,EACxBx3B,KAAKw4B,WAAaA,YAAc,UAChCx4B,KAAKy3B,OAASA,SAAU,EACxBz3B,KAAKy4B,KAAOA,MAAQ,kBACpBz4B,KAAKuiB,SAAWA,UAAY,GAC5BviB,KAAK04B,sBAAwBA,uBAAyB,GACtD14B,KAAKmzB,kBAAqBwF,OAASA,MAAMK,KAAOL,MAAMK,IAAIC,YAAc,EACxEj5B,KAAK44B,WAAaA,aAAc,EAChC54B,KAAK64B,sBAAwBA,wBAAyB,EACtD74B,KAAK84B,WAAaA,WAAaC,kBAAoB,KAEnD/4B,KAAKk5B,gBAAkB,EACvBl5B,KAAKm5B,YAAc,EACnBn5B,KAAKo5B,aAAe,EACpBp5B,KAAKq5B,aAAe,EACpBr5B,KAAKs5B,cAAgB,GACrBt5B,KAAKu5B,iBAAmB,GACxBv5B,KAAK8mB,qBAAuB,WAC5B9mB,KAAKw5B,cAAgB,CAAC,CAAEC,SAAU,WAAYC,WAAY,EAAGC,KAAM,KACnE35B,KAAK45B,WAAa,GAClB55B,KAAK65B,cAAgB,GACrB75B,KAAK85B,cAAgB,GACrB95B,KAAK+5B,YAAc,KAEnB/5B,KAAKg6B,wBAA0Bh6B,KAAKg6B,wBAAwBC,KAAKj6B,MACjEA,KAAKk6B,gBAAkBl6B,KAAKk6B,gBAAgBD,KAAKj6B,MACjDA,KAAKm6B,oBAAsBn6B,KAAKm6B,oBAAoBF,KAAKj6B,MACzDA,KAAKo6B,oBAAsBp6B,KAAKo6B,oBAAoBH,KAAKj6B,MACzDA,KAAKq6B,uBAAyBr6B,KAAKq6B,uBAAuBJ,KAAKj6B,MAC/DA,KAAKs6B,kBAAoBt6B,KAAKs6B,kBAAkBL,KAAKj6B,MACrDA,KAAKu6B,qBAAuBv6B,KAAKu6B,qBAAqBN,KAAKj6B,MAC3DA,KAAKw6B,iBAAmBx6B,KAAKw6B,iBAAiBP,KAAKj6B,MACnDA,KAAKy6B,qBAAuBz6B,KAAKy6B,qBAAqBR,KAAKj6B,MAC3DA,KAAK06B,gBAAkB16B,KAAK06B,gBAAgBT,KAAKj6B,MACjDA,KAAKmmB,gBAAkBnmB,KAAKmmB,gBAAgB8T,KAAKj6B,MACjDA,KAAK6mB,4BAA8B7mB,KAAK6mB,4BAA4BoT,KAAKj6B,MACzEA,KAAK26B,kBAAoB36B,KAAK26B,kBAAkBV,KAAKj6B,MACrDA,KAAK46B,kBAAoB56B,KAAK46B,kBAAkBX,KAAKj6B,MAGvDuO,0BACE,MAAMssB,kBAAkBz1B,OAAO,CAAE01B,SAAU,QAASC,YAAY,GClI5C,yxDD6KpB,OAzCI/6B,KAAK65B,eAAiBj1B,MAAM4iB,QAAQxnB,KAAK65B,gBAAkB75B,KAAK65B,cAAcx5B,QAChFL,KAAK65B,cAAc/tB,QAEjB,EAAGkvB,SAAAA,aACD,MAAMC,qBAAuBpa,SAAS,CACpCqa,iBAAkB,CAChBna,IAAK,kEAGNA,IAAI,YACJC,IAAI,WAAY,eAAega,gBAC/Bha,IACC,cACA,6EAEDvf,KACHo5B,kBAAgBr3B,OAAOye,OAAOgZ,wBAIhCj7B,KAAK85B,eAAiBl1B,MAAM4iB,QAAQxnB,KAAK85B,gBAAkB95B,KAAK85B,cAAcz5B,QAChFL,KAAK85B,cAAchuB,QAEjB,EAAGqvB,SAAAA,aACD,MAAMF,qBAAuBpa,SAAS,CACpCqa,iBAAkB,CAChBna,IAAK,kEAGNA,IAAI,YACJC,IAAI,WAAY,eAAema,gBAC/Bna,IACC,cACA,6EAEDvf,KACHo5B,kBAAgBr3B,OAAOye,OAAOgZ,wBAK7BJ,kBAAgBntB,SAAS,CAAE0tB,aAAa,IAGjD7sB,kBAgBE,OAfgBnJ,OACd,CAAE01B,SAAU,QAASC,YAAY,GhBhLf,EACtBhD,MAAQ,GACRC,QAAU,GACVC,QAAU,eACVC,SAAW,CAAC,gBACZhH,YAAc,GACdiH,eAAiB,eACjBC,SAAW,EACXC,UAAY,IAAIxB,KAChByB,WAAa,IAAIzB,OAEV,wHAIa9Y,mDACAA,4CACKA,kDACCA,8CACLA,uDAECga,6CACEC,iDACAC,qCAEZC,UAAYtzB,MAAM4iB,QAAQ0Q,UACtB,gBAAgBA,SAASt1B,KAAK,sBAC9B,mCAEYsuB,gEACGiH,gEACNC,kFAEbC,qBAAqBxB,KAAOwB,UAAUgD,eAAgB,IAAIxE,MAAOwE,4FAGjE/C,sBAAsBzB,KAAOyB,WAAW+C,eAAgB,IAAIxE,MAAOwE,uEgB6I3EnB,CACEl6B,KAAK+3B,MACL/3B,KAAKg4B,QACLh4B,KAAKi4B,QACLj4B,KAAKk4B,SACLl4B,KAAKkxB,YACLlxB,KAAKm4B,eACLn4B,KAAKo4B,SACLp4B,KAAKq4B,UACLr4B,KAAKs4B,aAIM5qB,SAAS,CAAE0tB,aAAa,IAGzC7sB,sBACE,MAAMwrB,YAAc30B,OAClB,CAAE01B,SAAU,QAASC,YAAY,IDnMLhtB,MCoMH/N,KAAK+N,MDpMKH,OCoME5N,KAAK4N,ODpMCqF,YCoMOjT,KAAKiT,YDpMC6kB,QCoMY93B,KAAK83B,QDnMtE,oGAIU/Z,qCACEA,qCACFA,qCACEA,qCACFA,mCACAA,oCACCA,qCACAA,oCACDA,qCACEA,sCACDA,sCACCA,sGAIUhQ,eAAeH,qBAAqBqF,oDACjC6kB,QAAQ9T,0CACP8T,QAAQ1T,6CACP0T,QAAQ3T,4CACV2T,QAAQ5T,4CACN4T,QAAQN,8CACRM,QAAQL,8CACRK,QAAQJ,iFA3BX,IAAC3pB,MAAOH,OAAQqF,YAAa6kB,QCwM1D,GAFAiC,YAAYv2B,OAAO83B,QAAQrZ,OAAOjiB,KAAK+5B,aAGrC/5B,KAAKw3B,QACLx3B,KAAK65B,eACLj1B,MAAM4iB,QAAQxnB,KAAK65B,gBACnB75B,KAAK65B,cAAcx5B,OACnB,CACA,MAAMk7B,kBAAoB1a,WAE1B7gB,KAAK65B,cAAc/tB,QAEjB,EAAGqb,eAAAA,eAAgBloB,KAAAA,SACjB,MAAMu8B,eAAiB3a,SAAS,CAC9BC,eAAgB,CACd3hB,EAAG4e,aACH4K,EAAG5K,gBAGJgD,IAAI,KAAM,mBACVC,IAAI,KAAM,KAAM,MAAMmG,gBACtBnG,IAAI,KAAM,OAAQ/hB,MAClBwC,KACH85B,kBAAkBtZ,OAAOuZ,kBAI7BzB,YAAYv2B,OAAO83B,QAAQA,QAAQrZ,OAAOsZ,mBAE5C,GACEv7B,KAAKy3B,QACLz3B,KAAK85B,eACLl1B,MAAM4iB,QAAQxnB,KAAK85B,gBACnB95B,KAAK85B,cAAcz5B,OACnB,CACA,MAAMo7B,kBAAoB5a,WAE1B7gB,KAAK85B,cAAchuB,QAEjB,EAAGqb,eAAAA,eAAgBloB,KAAAA,SACjB,MAAMy8B,eAAiB7a,SAAS,CAC9BC,eAAgB,CACd3hB,EAAG4e,aACH4K,EAAG5K,gBAGJgD,IAAI,KAAM,mBACVC,IAAI,KAAM,KAAM,MAAMmG,gBACtBnG,IAAI,KAAM,OAAQ/hB,MAClBwC,KACHg6B,kBAAkBxZ,OAAOyZ,kBAI7B3B,YAAYv2B,OAAO83B,QAAQA,QAAQrZ,OAAOwZ,mBAE5C,IAAKz7B,KAAKw3B,QAAUx3B,KAAKy3B,SAAWz3B,KAAK64B,sBAAuB,CAC9D,MAAM8C,kBAAoB9a,SAAS,CACjCC,eAAgB,CACd3hB,EAAG4e,gBAEJgD,IAAI,KAAM,WAEbgZ,YAAYv2B,OAAO83B,QAAQA,QAAQrZ,OAAO0Z,mBAE5C,GAAI37B,KAAK84B,WAAY,CACnB,MAAM8C,QAAEA,QAAO33B,MAAEA,MAAK43B,QAAEA,SAAY77B,KAAK84B,WACnCgD,mBAAqBjb,SAAS,CAClCC,eAAgB,CACd3hB,EAAG4e,gBAGJgD,IAAI,KAAM,aACVC,IAAI,KAAM,UAAW4a,SACrB5a,IAAI,KAAM,QAAS/c,OACnB+c,IAAI,KAAM,UAAW6a,SACxB9B,YAAYv2B,OAAO83B,QAAQA,QAAQrZ,OAAO6Z,oBAG5C,OAAO/B,YAAYrsB,SAAS,CAAE0tB,aAAa,IAI7C7sB,sBAGE,OAFoBnJ,OAAO,CAAE01B,SAAU,QAASC,YAAY,GAAQgB,aAEjDruB,SAAS,CAAE0tB,aAAa,IAI7C7sB,yBAGE,OAFuBnJ,OAAO,CAAE01B,SAAU,QAASC,YAAY,GAAQiB,gBAEjDtuB,SAAS,CAAE0tB,aAAa,IAIhD7sB,oBAME,OALkBnJ,OAChB,CAAE01B,SAAU,QAASC,YAAY,GEzSb,EAACtC,KAAO,kBAAmBlW,SAAW,GAAImW,sBAAwB,KACnF,uFAGc3a,0BAA0BA,gGAIxB0a,6GACNlW,sCACEmW,uzGFgSf4B,CAAkBt6B,KAAKy4B,KAAMz4B,KAAKuiB,SAAUviB,KAAK04B,wBAGlChrB,SAAS,CAAE0tB,aAAa,IAI3C7sB,uBAGE,OAFqBnJ,OAAO,CAAE01B,SAAU,QAASC,YAAY,GAAQkB,cAEjDvuB,SAAS,CAAE0tB,aAAa,IAI9C7sB,mBAGE,OAFiBnJ,OAAO,CAAE01B,SAAU,QAASC,YAAY,GG3TpC,EAACtC,KAAO,oBAAsB,ixCA6CxBA,sCACHA,uHAIGA,sCACHA,uzJHwQyC+B,CAAiBx6B,KAAKy4B,OAEvE/qB,SAAS,CAAE0tB,aAAa,IAG1C7sB,uBACE,MAAM2tB,aAAe92B,OACnB,CAAE01B,SAAU,QAASC,YAAY,GI/T9B,+GAIUhd,oCACCA,oCACDA,mCACAA,mCACAA,oCACCA,sCACCA,uCACAA,kDJwTXoe,2BAA6Btb,WAC7Bub,mBAAqBvb,WAwF3B,OAtFA7gB,KAAKu5B,iBAAiBztB,QAEpB,EAAGyX,YAAAA,YAAa+P,aAAAA,iBACd,MAAM+I,0BAA4Bxb,SAAS,CACzCC,eAAgB,CAAE3hB,EAAG4e,gBAEpBgD,IAAI,KAAM,eACVC,IAAI,KAAM,gBAAiB/gB,OAAOsjB,cAClCxC,IAAI,KAAM,kBACVC,IAAI,KAAM,MAAO,oBACjBvf,KAEH6xB,aACG7wB,OAAO,CAACiD,MAAOZ,MAAO2B,OACdA,KAAK61B,UAAWC,GAAMA,EAAE9I,QAAU/tB,MAAM+tB,SAAW3uB,OAE3DgH,QAAQ,EAAG2nB,MAAAA,MAAOx0B,KAAAA,SACjB,MAAMu9B,cAAgB3b,SAAS,CAC7BC,eAAgB,CAAE3hB,EAAG4e,gBAEpBgD,IAAI,KAAM,OACVC,IAAI,KAAM,OAAQyS,OAClB1S,IAAI,KAAM,SACVC,IAAI,KAAM,MAAO,KACjBvf,KACAsf,IAAI,KAAM,UACVC,IAAI,KAAM,MAAgB,OAAT/hB,KAAgB,UAAY,UAC7CwC,KACAsf,IAAI,KAAM,WACVC,IAAI,KAAM,MAAgB,OAAT/hB,KAAgB,KAAIw0B,MAAQ,GAAM,KACnDhyB,KACAsf,IAAI,KAAM,SACVC,IAAI,KAAM,MAAO,QACjBvf,KACAsf,IAAI,KAAM,OACVA,IAAI,KAAM,QACVA,IAAI,KAAM,OACVC,IAAI,KAAM,MAAO,OACjBA,IAAI,KAAM,MAAqB,KAAbyS,MAAQ,IAC1BhyB,KACAA,KACAsf,IAAI,KAAM,OACVC,IAAI,KAAM,OAAsB,KAAbyS,MAAQ,IAC3BzS,IAAI,KAAM,UAAW,KACrBvf,KACAA,KACAA,KAEH,GAAa,OAATxC,KAAe,CACjB,MAAM8iB,sBAAwBlB,SAAS,CACrCC,eAAgB,CAAE3hB,EAAG4e,gBAEpBgD,IAAI,KAAM,OACVA,IAAI,KAAM,UACVC,IAAI,KAAM,QAAS,aACnBA,IAAI,KAAM,QAAS,aACnBA,IAAI,KAAM,OAAQ,WAClBvf,KACAA,KAEH+6B,cAAc96B,OAAOugB,OAAOF,uBAG9Bsa,0BAA0Bpa,OAAOua,iBAGrCH,0BAA0B56B,KAE1B,MAAMg7B,kBAAoB5b,SAAS,CACjCC,eAAgB,CAAE3hB,EAAG4e,gBAEpBgD,IAAI,KAAM,OACVC,IAAI,KAAM,QAAS/gB,OAAOsjB,cAC1BxC,IAAI,KAAM,iBACVC,IAAI,KAAM,MAAO/gB,OAAOsjB,cACxB9hB,KACAA,KAEH06B,2BAA2Bla,OAAOoa,2BAClCD,mBAAmBna,OAAOwa,qBAI9BP,aAAa14B,OAAOye,OAAOka,4BAC3BD,aAAa14B,OAAOye,OAAOma,oBAEpBF,aAAaxuB,SAAS,CAAE0tB,aAAa,IAI9C7sB,oBAAoBwkB,YAAayG,eAC/BA,cAAc1tB,QAEZ,EAAGqb,eAAAA,eAAgBloB,KAAAA,KAAMqI,OAAAA,OAAQo1B,WAAAA,eAC/B,MAAMC,qBAAuB9b,SAAS,CACpCqa,iBAAkB,CAAEna,IAAK,kEAExBA,IAAI,gBACJC,IAAI,KAAM,MAAMmG,gBAChBnG,IAAI,OAAQ/hB,MACZ+hB,IAAI,SAAU1Z,QACd0Z,IAAI,aAAc0b,YAClBj7B,KAEHsxB,YAAY9Q,OAAO0a,wBAKzBpuB,kBAgBE,OAf+BvO,KAAKw5B,cAAchb,IAAI,EAAGib,SAAAA,SAAUE,KAAAA,SACjE,IAAI5G,YAQJ,OANEA,YAAc3tB,OAAO,CAAE01B,SAAU,QAASC,YAAY,GADvC,aAAbtB,SAC4DmD,gBK1b/C,qLL8bjB58B,KAAK68B,oBAAoB9J,YAAYvvB,OAAQm2B,MAEtC,CACLF,SAAAA,SACAqD,UAAW/J,YAAYrlB,SAAS,CAAE0tB,aAAa,OAOrD7sB,gBAAgB+kB,cAId,OAHAtzB,KAAKk5B,iBAAmB,EACxBl5B,KAAKu5B,iBAAiB90B,KAAK,CAAE8e,YAAavjB,KAAKk5B,gBAAiB5F,aAAAA,eAEzDtzB,KAAKk5B,gBAGd3qB,gBAAgBwuB,cAEd,MAAMC,QAAUD,aAAaznB,MAAM,sCACnC,GAAuB,IAAnB0nB,QAAQ38B,OACV,MAAM,IAAI6H,MAAM,yBAGlB,MAAM+0B,kBAAoBD,QAAQ,GAE5BE,cACgC,iBAApCF,QAAQ,GAAG1nB,MAAM,YAAY,GAAwB,MAAQ0nB,QAAQ,GAAG1nB,MAAM,YAAY,GAEtFmR,sBAAwB,SAAS0W,sBAAsBD,gBAI7D,OAFAl9B,KAAKm5B,aAAe,EAEb,CAAElI,GAAIjxB,KAAKm5B,YAAazS,YAAauW,kBAAmBxW,sBAAAA,uBAGjElY,4BAA4BkrB,SAAW,WAAYx6B,KAAMqI,OAAQo1B,WAAa,YAC5E,IAWIU,iBAXAC,mBAAqBr9B,KAAKw5B,cAAc9d,KACzC4hB,cAAiBA,aAAa7D,WAAaA,UAE1CC,WAAa,EASjB,OARI2D,oBACF3D,WAAa2D,mBAAmB3D,WAAa,EAC7C2D,mBAAmB3D,WAAaA,aAEhC2D,mBAAqB,CAAE5D,SAAAA,SAAUC,WAAAA,WAAYC,KAAM,IACnD35B,KAAKw5B,cAAc/0B,KAAK44B,qBAGlBp+B,MACN,IAAK,YACHm+B,iBAAmBrf,sBACnB,MACF,IAAK,QACHqf,iBAAmBrf,kBACnB,MACF,IAAK,SACHqf,iBAAmBrf,mBACnB,MACF,IAAK,SACHqf,iBAAmBrf,mBACnB,MACF,IAAK,QACHqf,iBAAmBrf,kBAavB,OAPAsf,mBAAmB1D,KAAKl1B,KAAK,CAC3B0iB,eAAgBuS,WAChBz6B,KAAMm+B,iBACN91B,OAAAA,OACAo1B,WAAAA,aAGKhD,WAGTnrB,kBAAkB0lB,OAChB,MAAMsJ,UAAYn4B,OAAO,CACvB01B,SAAU,QACVC,YAAY,EACZja,eAAgB,CACd3hB,EAAG4e,aACHyf,GAAIzf,cACJ0f,EAAG1f,aACH4K,EAAG5K,aACHwe,EAAGxe,aACH0T,GAAI1T,cACJ2f,IAAK3f,kBAENgD,IAAI,KAAM,OAEP4c,YAAc9c,WAMpB,OALAmT,kBAAkBh0B,KAAMi0B,MAAO0J,aAC/BJ,UAAU/5B,OAAOye,OAAO0b,aAExB39B,KAAKo5B,cAAgB,EAEd,CAAE4B,SAAUh7B,KAAKo5B,aAAcmE,UAAAA,WAGxChvB,kBAAkB0lB,OAChB,MAAM2J,UAAYx4B,OAAO,CACvB01B,SAAU,QACVC,YAAY,EACZja,eAAgB,CACd3hB,EAAG4e,aACHyf,GAAIzf,cACJ0f,EAAG1f,aACH4K,EAAG5K,aACHwe,EAAGxe,aACH0T,GAAI1T,cACJ2f,IAAK3f,kBAENgD,IAAI,KAAM,OAEP4c,YAAc9c,WAEpB,GADAmT,kBAAkBh0B,KAAMi0B,MAAO0J,aACU,MAArCA,YAAYrC,QAAQ9H,KAAK7zB,SAAmBK,KAAK44B,WAAY,CAC/D,MAAMiF,oBAAsBhd,SAAS,CACnCC,eAAgB,CACd3hB,EAAG4e,gBAGJgD,IAAI,KAAM,aACVC,IAAI,KAAM,QAAS,QACnBD,IAAI,KAAM,KACVtf,KACAA,KACHk8B,YAAYrC,QAAQrZ,OAAO4b,qBAM7B,OAJAD,UAAUp6B,OAAOye,OAAO0b,aAExB39B,KAAKq5B,cAAgB,EAEd,CAAE8B,SAAUn7B,KAAKq5B,aAAcuE,UAAAA,YMrjB1C,MAAMnL,cAAcC,WAAW,OAC7BC,YACAC,QAGIkL,uBAAyB,CAC7B7qB,YAAa,WACb6kB,QAAS,CACP9T,IAAK,KACLI,MAAO,KACPD,OAAQ,KACRD,KAAM,KACNsT,OAAQ,IACRC,OAAQ,IACRC,OAAQ,GAEVK,MAAO,GACPC,QAAS,GACTC,QAAS,eACTC,SAAU,CAAC,gBACXhH,YAAa,GACbiH,eAAgB,eAChBC,SAAU,EACVC,UAAW,IAAIxB,KACfyB,WAAY,IAAIzB,KAChB0B,WAAY,UACZf,QAAQ,EACRgB,WAAY,UACZf,QAAQ,EACRgB,KAAM,kBACNlW,SAAU,GACVmW,sBAAuB,GACvBC,MAAO,CACLK,IAAK,CACHC,WAAW,IAGfL,YAAY,EACZC,uBAAuB,EACvBC,YAAY,EACZC,kBAAmB,CACjB6C,QAAS,EACT33B,MAAO,EACP43B,QAAS,eAsBPkC,aAAgBjG,UACpB,IAAIkG,kBAAoB,GAwBxB,MAvBuB,iBAAZlG,SAAoC,OAAZA,QACjC3yB,OAAOuF,KAAKotB,SAAShsB,QAAShM,MAC5B,GAAI2e,WAAWzP,KAAK8oB,QAAQh4B,MAAO,CACjC,MAAMogB,aAAe4X,QAAQh4B,KAAKwV,MAAMmJ,YACxCuf,kBAAkBl+B,KAAOuf,YAAYa,aAAa,SAC7C,GAAItB,QAAQ5P,KAAK8oB,QAAQh4B,MAAO,CACrC,MAAMogB,aAAe4X,QAAQh4B,KAAKwV,MAAMsJ,SACxCof,kBAAkBl+B,MzBnBDm+B,QyBmBiB/d,aAAa,GzBlB9CV,WALe,CAACye,SACN,SAAVA,QAIWC,CAASD,gByBmBhB,GAAIpf,UAAU7P,KAAK8oB,QAAQh4B,MAAO,CACvC,MAAMogB,aAAe4X,QAAQh4B,KAAKwV,MAAMuJ,WACxCmf,kBAAkBl+B,KAAO0f,WAAWU,aAAa,SACxC4X,QAAQh4B,KACjBk+B,kBAAkBl+B,KAAOg4B,QAAQh4B,KAGjCk+B,kBAAkBl+B,KAAOg+B,uBAAuBhG,QAAQh4B,KzB3BxC,IAACm+B,UyBgCrBD,kBAAoB,KAGfA,mBAGHG,yBAA4BC,kBAChC,MAAMC,0BAA4B,IAAKD,iBAcvC,OAbAj5B,OAAOuF,KAAK0zB,iBAAiBtyB,QAAShM,MAEpC,OAAQA,KACN,IAAK,UACHu+B,0BAA0BvG,QAAUiG,aAAaK,gBAAgBt+B,MACjE,MACF,IAAK,WACL,IAAK,wBACHu+B,0BAA0Bv+B,KAtDZ,CAACyiB,WACrB,IAAI+b,mBACJ,GAAI3f,WAAW3P,KAAKuT,UAAW,CAC7B,MAAMrC,aAAeqC,SAASjN,MAAMqJ,YAEpC2f,mBAAqBlf,WAAWc,aAAa,SAG7Coe,mBAFS/b,UAIY,KAGvB,OAAO+b,oBAyCgCtb,CAAcob,gBAAgBt+B,SAK9Du+B,2BAMF,SAASE,oBACdjY,IACAuR,WACA2G,wBACAC,iBACAC,kBAEA,MAAML,0BAA4BF,yBAAyBK,yBACrDJ,iBA3EclzB,QA2EiB4yB,uBA3ERa,MA2EgCN,8BA3EhBnzB,WAAYyzB,QAAtC,IAACzzB,QAASyzB,MA6EzBP,gBAAgB5G,SAAWiH,mBAE7BA,iBAAmB,WAEjBL,gBAAgB3G,SAAWiH,mBAE7BA,iBAAmB,WAGrB,MAAME,aAAe,IAAIhH,aAAa,CAAEtR,IAAAA,IAAKuR,WAAAA,cAAeuG,kBvB+I9D,IAA4BnY,qBuB/H1B,GAdA2Y,aAAa7E,YvBoJgB/F,kBAPH/N,qBuB7IoB2Y,avB8IhCnM,YAAYxM,qBAAqB4R,YAE3BhX,SAAS,CAC3BC,eAAgB,CAAE3hB,EAAG4e,iBuB/IvBuI,IACGC,OAAO,SACPC,KACC,QACAphB,OAAO,CAAE01B,SAAU,QAASC,YAAY,GAAQ1G,SAAS3mB,SAAS,CAAE0tB,aAAa,IACjF,CAAEzU,eAAe,IAGrBL,IAAIC,OAAO,YAAYC,KAAK,WAAYoY,aAAa1E,kBAAmB,CACtEvT,eAAe,IAGbiY,aAAapH,QAAUiH,iBAAkB,CAC3C,MAAMxK,MAAQxB,cAAYgM,kBAE1BG,aAAa9X,qBAAuB,UACpC,MAAMkU,SAAEA,SAAQuC,UAAEA,WAAcqB,aAAajE,kBAAkB1G,OAC/D2K,aAAa9X,qBAAuB,WAEpC,MAAMK,eAAiByX,aAAa/X,4BAClC+X,aAAa9X,qBACb,SACA,SAASkU,eACT,YAGF1U,IAAIC,OAAO,QAAQC,KAAK,SAASwU,eAAgBuC,UAAU7vB,SAAS,CAAE0tB,aAAa,IAAS,CAC1FzU,eAAe,IAGjBiY,aAAa/E,cAAcp1B,KAAK,CAAEu2B,SAAAA,SAAU7T,eAAAA,eAAgBloB,KAAM2/B,aAAarG,aAEjF,GAAIqG,aAAanH,QAAUiH,iBAAkB,CAC3C,MAAMzK,MAAQxB,cAAYiM,kBAE1BE,aAAa9X,qBAAuB,UACpC,MAAMqU,SAAEA,SAAQyC,UAAEA,WAAcgB,aAAahE,kBAAkB3G,OAC/D2K,aAAa9X,qBAAuB,WAEpC,MAAMK,eAAiByX,aAAa/X,4BAClC+X,aAAa9X,qBACb,SACA,SAASqU,eACT,YAGF7U,IAAIC,OAAO,QAAQC,KAAK,SAAS2U,eAAgByC,UAAUlwB,SAAS,CAAE0tB,aAAa,IAAS,CAC1FzU,eAAe,IAGjBiY,aAAa9E,cAAcr1B,KAAK,CAAE02B,SAAAA,SAAUhU,eAAAA,eAAgBloB,KAAM2/B,aAAapG,aAGjFoG,aAAa/X,4BACX+X,aAAa9X,qBACb,QACA,mBACA,YAEFR,IAAIC,OAAO,QAAQA,OAAO,SAASC,KAAK,aAAcoY,aAAapE,mBAAoB,CACrF7T,eAAe,IAGjBL,IACGC,OAAO,QACPC,KAAK,eAAgBoY,aAAazE,sBAAuB,CACxDxT,eAAe,IAEhBH,KAAK,gBAAiBoY,aAAarE,uBAAwB,CAC1D5T,eAAe,IAEhBH,KAAK,aAAcoY,aAAatE,oBAAqB,CACpD3T,eAAe,IAEhBH,KAAK,gBAAiBoY,aAAanE,uBAAwB,CAC1D9T,eAAe,IAEhBH,KAAK,eAAgBoY,aAAaxE,sBAAuB,CACxDzT,eAAe,IAEhBH,KAAK,kBAAmBoY,aAAavE,yBAA0B,CAC9D1T,eAAe,IAGnB,MAAMkY,iBAAmBD,aAAalE,kBAWtC,OAVImE,kBAAoBj6B,MAAM4iB,QAAQqX,mBACpCA,iBAAiB/yB,QAAQ,EAAG2tB,SAAAA,SAAUqD,UAAAA,cACpCxW,IAAIC,OAAO,QAAQA,OAAO,SAASC,KAAQiT,SAAH,YAAwBqD,UAAW,CACzEnW,eAAe,MAKrBL,IAAIE,KAAK,sBAAuBoY,aAAa5E,0BAA2B,CAAErT,eAAe,IAElFL,ICtPT,MAAMwY,iBAAoBjH,aACxB,KAA0B,iBAAfA,YAA2BA,sBAAsB53B,QAa1D,OAAO,KAZP,IAOE,OAN2B43B,WACxBZ,QAAQ,MAAO,IACfA,QAAQ,WAAY,KACpBA,QAAQ,cAAe,MACvBA,QAAQ,aAAc,KAGzB,MAAOxtB,OACP,OAAO,sBAObs1B,eACElH,WACA4G,iBACAL,gBAAkB,GAClBM,kBAEA,MAAMpY,IAAM,IAAI0Y,MAEhB,IAAIC,YAAcpH,WACdqH,WAAaT,iBACbU,WAAaT,iBACb7G,aACFoH,YAAcH,iBAAiBG,cAE7BR,mBACFS,WAAaJ,iBAAiBI,aAE5BR,mBACFS,WAAaL,iBAAiBK,aAGhCZ,oBAAoBjY,IAAK2Y,YAAab,gBAAiBc,WAAYC,YAEnE,MAAM1xB,aAAe6Y,IAAI8Y,cAAc,CAAEngC,KAAM,gBAC/C,GAAIkG,OAAOhE,UAAU7B,eAAeuF,KAAKw6B,OAAQ,QAE/C,OAAO,IAAIC,KAAK,CAAC7xB,QAAS,CACxBxO,KAAM,4EAGV,GAAIkG,OAAOhE,UAAU7B,eAAeuF,KAAKw6B,OAAQ,UAC/C,OAAOxoB,OAAOhT,KAAK,IAAIoyB,WAAWxoB,SAEpC,MAAM,IAAIvF,MACR"}